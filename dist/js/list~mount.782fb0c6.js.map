{"version":3,"sources":["webpack:///./node_modules/cos-js-sdk-v5/src/util.js","webpack:///./node_modules/cos-js-sdk-v5/src/event.js","webpack:///./node_modules/cos-js-sdk-v5/src/session.js","webpack:///./node_modules/cos-js-sdk-v5/lib/xml2json.js","webpack:///./node_modules/cos-js-sdk-v5/src/cos.js","webpack:///./node_modules/cos-js-sdk-v5/src/advance.js","webpack:///./node_modules/xmldom/dom-parser.js","webpack:///./node_modules/cos-js-sdk-v5/index.js","webpack:///(webpack)/buildin/amd-options.js","webpack:///./node_modules/node-libs-browser/mock/process.js","webpack:///./node_modules/xmldom/dom.js","webpack:///./node_modules/cos-js-sdk-v5/lib/md5.js","webpack:///./node_modules/cos-js-sdk-v5/src/base.js","webpack:///./node_modules/cos-js-sdk-v5/lib/json2xml.js","webpack:///./node_modules/cos-js-sdk-v5/src/async.js","webpack:///./node_modules/cos-js-sdk-v5/lib/request.js","webpack:///./node_modules/xmldom/sax.js","webpack:///./node_modules/cos-js-sdk-v5/lib/crypto.js","webpack:///./node_modules/path-browserify/index.js","webpack:///./node_modules/cos-js-sdk-v5/src/task.js"],"names":["md5","CryptoJS","xml2json","json2xml","camSafeUrlEncode","str","encodeURIComponent","replace","getAuth","opt","pathname","SecretId","SecretKey","KeyTime","method","Method","toLowerCase","queryParams","clone","Query","params","headers","Headers","Key","UseRawKey","Pathname","indexOf","console","error","getObjectKeys","obj","forKey","list","key","hasOwnProperty","push","sort","a","b","obj2str","i","val","keyList","length","undefined","join","now","Math","round","getSkewTime","SystemClockOffset","exp","Expires","expires","qSignAlgorithm","qAk","qSignTime","qKeyTime","qHeaderList","qUrlParamList","signKey","HmacSHA1","toString","formatString","stringToSign","SHA1","qSignature","authorization","noop","clearKey","retObj","readAsBinaryString","blob","callback","readFun","fr","FileReader","prototype","onload","this","result","readAsArrayBuffer","fileData","binary","reader","e","bytes","Uint8Array","byteLength","String","fromCharCode","call","fileSliceNeedCopy","compareVersion","split","parseInt","check","ua","ChromeVersion","match","QBCoreVersion","QQBrowserVersion","need","navigator","userAgent","fileSlice","file","start","end","isUseToUpload","slice","mozSlice","webkitSlice","Blob","getBodyMd5","UploadCheckContentMd5","Body","onProgress","util","getFileMd5","err","md5ChunkSize","size","loaded","md5ctx","getCtx","next","hash","digest","min","chunk","content","update","total","percent","map","v","attr","name","defaultValue","extend","target","source","each","isArray","arr","Array","isInArray","item","flag","makeArray","fn","o","filter","iaArr","binaryBase64","len","char","res","btoa","uuid","S4","random","substring","hasMissingParams","apiName","Bucket","Region","formatParams","headerMap","paramKey","headerKey","apiWrapper","apiFn","self","formatResult","VersionId","DeleteMarker","_callback","data","checkParams","missingResult","test","options","CompatibilityMode","warn","AppId","substr","errMsg","isSync","Promise","global","resolve","reject","throttleOnProgress","time1","timer","size0","size1","time0","Date","speed","max","floor","info","immediately","clearTimeout","setTimeout","ProgressInterval","getFileSize","api","type","ArrayBuffer","ContentLength","offset","isBrowser","module","exports","initEvent","cos","listeners","getList","action","on","off","splice","emit","cb","EventProxy","init","cache","cacheKey","getCache","JSON","parse","localStorage","getItem","setCache","setItem","stringify","changed","mtime","save","mod","using","setUsing","removeUsing","getFileId","ChunkSize","lastModifiedDate","getUploadIdList","saveUploadId","UploadId","limit","unshift","removeUploadId","DOMParser","xmlToJSON","version","mergeCDATA","normalize","stripElemPrefix","prefixMatch","RegExp","grokType","sValue","isFinite","parseFloat","parseString","xmlString","xml","stringToXML","getElementsByTagName","parseXML","oXMLParent","vResult","nLength","sCollectedTxt","childNum","childNodes","oNode","sProp","vContent","nItem","nodeType","nodeValue","nodeName","constructor","Object","keys","xmlToString","xmlDoc","XMLSerializer","serializeToString","window","parser","parseFromString","ActiveXObject","async","loadXML","event","task","base","advance","defaultOptions","XCosSecurityToken","ChunkRetryTimes","FileParallelLimit","ChunkParallelLimit","SliceSize","CopyChunkParallelLimit","CopyChunkSize","CopySliceSize","MaxPartNumber","UploadQueueSize","Domain","ServiceDomain","Protocol","ForcePathStyle","Timeout","CorrectClockSkew","UploadAddMetaMd5","UploadIdCacheLimit","COS","getAuthorization","session","Async","sliceUploadFile","FileSize","ep","TaskId","AsyncLimit","StorageClass","ServerSideEncryption","onHashProgress","_isRunningTask","UploadCompleteData","UploadData","metaHeaders","k","shortKey","uploadSliceComplete","SliceList","uploadSliceList","_params","getUploadIdAndPartList","PartList","SIZE","AutoChunkSize","SkipTask","putObject","ETagMap","SliceCount","ceil","FinishSize","getChunkETag","PartNumber","ETag","Size","chunkItem","isAvailableUploadList","PartCount","PartSliceSize","index","Part","errData","Uploaded","multipartInit","Message","UploadIdList","reverse","eachLimit","asyncCallback","wholeMultipartListPart","PartListData","forEach","isAvailable","AvailableUploadData","RemoteUploadIdList","LocalUploadIdList","wholeMultipartList","UploadList","toUpperCase","UploadID","sendParams","Prefix","multipartList","apply","Upload","IsTruncated","KeyMarker","NextKeyMarker","UploadIdMarker","NextUploadIdMarker","multipartListPart","PartNumberMarker","NextPartNumberMarker","ChunkParallel","needUploadSlices","SliceItem","currentSize","preAddSize","uploadSliceItem","FileBody","PartItem","retry","tryCallback","multipartUpload","Parts","multipartComplete","abortUploadTask","Level","AbortArray","abortUploadTaskArray","resultList","AbortItem","eachIndex","KeyNotMatch","multipartAbort","successList","errorList","uploadFiles","TotalSize","TotalFinish","onTotalProgress","unFinishCount","files","_onTotalFileFinish","onFileFinish","onTotalFileFinish","Index","taskList","fileParams","fileInfo","_onTaskReady","onTaskReady","tid","PreAddSize","_onProgress","_onFileFinish","_addTasks","sliceCopyFile","CopySource","m","SourceBucket","SourceRegion","SourceKey","decodeURIComponent","CopySourceRange","copySliceItem","SourceHeaders","TargetHeader","ChunkCount","partNumber","restoreHeader","headObject","statusCode","ErrorStatus","putObjectCopy","resHeaders","metaPrefix","uploadPartCopy","API_MAP","transferToTaskMethod","locator","buildErrorHandler","errorImpl","domBuilder","DOMHandler","errorHandler","isCallback","Function","build","msg","_locator","cdata","position","node","lineNumber","columnNumber","l","systemId","_toString","chars","java","lang","appendElement","hander","currentElement","appendChild","doc","mimeType","sax","XMLReader","defaultNSMap","xmlns","entityMap","setDocumentLocator","nbsp","copy","startDocument","DOMImplementation","createDocument","documentURI","startElement","namespaceURI","localName","qName","attrs","el","createElementNS","getURI","value","getValue","getQName","createAttributeNS","getLocator","setAttributeNode","endElement","current","tagName","parentNode","startPrefixMapping","prefix","uri","endPrefixMapping","processingInstruction","ins","createProcessingInstruction","ignorableWhitespace","ch","characters","arguments","charNode","createCDATASection","createTextNode","skippedEntity","endDocument","comment","comm","createComment","startCDATA","endCDATA","startDTD","publicId","impl","implementation","createDocumentType","dt","warning","fatalError","__webpack_amd_options__","nextTick","args","shift","platform","arch","execPath","title","pid","browser","env","argv","binding","Error","path","cwd","chdir","dir","exit","kill","umask","dlopen","uptime","memoryUsage","uvCounters","features","src","dest","p","_extends","Class","Super","pt","create","ppt","__proto__","t","htmlns","NodeType","ELEMENT_NODE","ATTRIBUTE_NODE","TEXT_NODE","CDATA_SECTION_NODE","ENTITY_REFERENCE_NODE","ENTITY_NODE","PROCESSING_INSTRUCTION_NODE","COMMENT_NODE","DOCUMENT_NODE","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT_NODE","NOTATION_NODE","ExceptionCode","ExceptionMessage","HIERARCHY_REQUEST_ERR","INDEX_SIZE_ERR","DOMSTRING_SIZE_ERR","NOT_FOUND_ERR","WRONG_DOCUMENT_ERR","INVALID_CHARACTER_ERR","NO_DATA_ALLOWED_ERR","NO_MODIFICATION_ALLOWED_ERR","INUSE_ATTRIBUTE_ERR","NOT_SUPPORTED_ERR","INVALID_STATE_ERR","SYNTAX_ERR","INVALID_MODIFICATION_ERR","NAMESPACE_ERR","INVALID_ACCESS_ERR","DOMException","code","message","captureStackTrace","NodeList","LiveNodeList","refresh","_node","_refresh","_updateLiveList","inc","_inc","ownerDocument","ls","__set__","NamedNodeMap","_findNodeIndex","_addNamedNode","newAttr","oldAttr","ownerElement","_onRemoveAttribute","_onAddAttribute","_removeNamedNode","lastIndex","_features","feature","Node","_xmlEncoder","c","charCodeAt","_visitNode","firstChild","nextSibling","Document","ns","_nsMap","remove","_onUpdateChild","newChild","cs","child","_removeChild","previous","previousSibling","lastChild","_insertBefore","nextChild","cp","removeChild","newFirst","newLast","pre","_appendSingleChild","Element","Attr","CharacterData","Text","Comment","CDATASection","DocumentType","Notation","Entity","EntityReference","DocumentFragment","ProcessingInstruction","nodeSerializeToString","isHtml","nodeFilter","buf","refNode","documentElement","lookupPrefix","visibleNamespaces","namespace","needNamespaceDefine","isHTML","attributes","pubid","sysid","sub","internalSubset","importNode","deep","node2","cloneNode","n","attrs2","_ownerElement","object","getNamedItem","setNamedItem","setNamedItemNS","getNamedItemNS","removeNamedItem","removeNamedItemNS","hasFeature","versions","qualifiedName","doctype","root","insertBefore","refChild","replaceChild","oldChild","hasChildNodes","appendData","isSupported","hasAttributes","lookupNamespaceURI","isDefaultNamespace","importedNode","getElementById","id","rtv","getAttribute","createElement","createDocumentFragment","createAttribute","specified","createEntityReference","pl","hasAttribute","getAttributeNode","setAttribute","removeAttribute","removeAttributeNode","setAttributeNodeNS","removeAttributeNS","old","getAttributeNodeNS","hasAttributeNS","getAttributeNS","setAttributeNS","getElementsByTagNameNS","substringData","count","text","insertData","replaceData","deleteData","splitText","newText","newNode","defineProperty","getTextContent","get","$$length","set","ERROR","WINDOW","JS_MD5_NO_WINDOW","WEB_WORKER","NODE_JS","JS_MD5_NO_NODE_JS","process","COMMON_JS","JS_MD5_NO_COMMON_JS","AMD","ARRAY_BUFFER","JS_MD5_NO_ARRAY_BUFFER","HEX_CHARS","EXTRA","SHIFT","OUTPUT_TYPES","BASE64_ENCODE_CHAR","blocks","buffer8","buffer","Uint32Array","JS_MD5_NO_ARRAY_BUFFER_IS_VIEW","isView","createOutputMethod","outputType","isBinStr","Md5","createMethod","nodeWrap","crypto","eval","Buffer","nodeMethod","createHash","sharedMemory","h0","h1","h2","h3","hBytes","finalized","hashed","first","escape","notString","lastByteIndex","finalize","d","bc","da","hex","format","array","arrayBuffer","base64","v1","v2","v3","base64Str","REQUEST","getService","protocol","location","domain","appId","region","submitRequest","Action","url","buckets","ListAllMyBucketsResult","Buckets","owner","Owner","putBucket","CreateBucketConfiguration","BucketAZConfig","body","getUrl","bucket","isLocation","Location","headBucket","getBucket","reqParams","ResourceKey","qs","ListBucketResult","Contents","CommonPrefixes","deleteBucket","putBucketAcl","AccessControlPolicy","Grants","Grant","AccessControlList","uniqGrant","getBucketAcl","decodeAcl","ACL","putBucketCors","CORSConfiguration","CORSRules","rule","sKey","CORSRule","getBucketCors","Code","deleteBucketCors","getBucketLocation","putBucketPolicy","PolicyStr","getBucketPolicy","rawBody","Policy","deleteBucketPolicy","putBucketTagging","Tagging","Tags","TagSet","Tag","getBucketTagging","deleteBucketTagging","putBucketLifecycle","LifecycleConfiguration","Rules","Rule","getBucketLifecycle","deleteBucketLifecycle","putBucketVersioning","VersioningConfiguration","getBucketVersioning","putBucketReplication","ReplicationConfiguration","getBucketReplication","deleteBucketReplication","putBucketWebsite","WebsiteConfiguration","RoutingRules","RoutingRule","getBucketWebsite","deleteBucketWebsite","putBucketReferer","RefererConfiguration","DomainList","Domains","getBucketReferer","putBucketDomain","DomainConfiguration","DomainRule","getBucketDomain","deleteBucketDomain","putBucketOrigin","OriginConfiguration","OriginRule","getBucketOrigin","deleteBucketOrigin","putBucketLogging","BucketLoggingStatus","getBucketLogging","putBucketInventory","InventoryConfiguration","OptionalFields","Field","Destination","COSBucketDestination","Encryption","getBucketInventory","listBucketInventory","ListInventoryConfigurationResult","InventoryConfigurations","deleteBucketInventory","putBucketAccelerate","configuration","AccelerateConfiguration","getBucketAccelerate","NotModified","listObjectVersions","ListVersionsResult","DeleteMarkers","Versions","Version","getObject","DataType","needCalcMd5","deleteObject","BucketNotFound","getObjectAcl","putObjectAcl","optionsObject","OptionsForbidden","AccessControlAllowOrigin","AccessControlAllowMethods","AccessControlAllowHeaders","AccessControlExposeHeaders","AccessControlMaxAge","Interface","Scope","CopyObjectResult","uploadId","CopyPartResult","deleteMultipleObject","Objects","Quiet","Delete","DeleteResult","Deleted","Errors","restoreObject","RestoreRequest","putObjectTagging","getObjectTagging","deleteObjectTagging","selectObjectContent","SelectType","SelectRequest","InitiateMultipartUploadResult","CompleteMultipartUpload","CompleteMultipartUploadResult","ProcessResults","UploadResult","OriginalInfo","ImageInfo","ListMultipartUploadsResult","ListPartsResult","getObjectUrl","Sign","Url","AuthData","getAuthorizationAsync","signUrl","Authorization","ClientIP","ClientUA","Token","GrantFullControl","GrantWrite","GrantRead","GrantReadAcp","GrantWriteAcp","GrantMap","PublicAcl","READ","WRITE","FULL_CONTROL","Grantee","ID","URI","Permission","exist","trim","longBucket","shortBucket","lastIndexOf","formatAllow","auth","atob","KeyName","StsData","ScopeKey","_StsCache","compareTime","StartTime","ExpiredTime","ScopeLimit","calcAuthByTmpKey","TmpSecretId","TmpSecretKey","getSTS","allowRetry","isTimeError","serverDate","date","ServerTime","errorCode","errorMessage","serverTime","abs","versionId","tryTimes","oldClockOffset","_submitRequest","contentLength","dataType","timeout","cosInterface","pathStyle","sender","Request","r","hasReturned","response","statusMessage","killTask","jsonRes","statusSuccess","abort","warnOldApi","proto","suffix","oldName","warned","element_start_char","element_non_start_char","element_replace","not_safe_in_xml","objKeys","process_to_xml","node_data","makeNode","level","hasSubNodes","indent_value","indent","prettyPrint","removeIllegalNameCharacters","node_descriptor","ret","toJSON","nodes","j","esc","xml_header","standalone","xmlHeader","xmlheader","docType","iterator","completed","started","running","replenish","times","stringifyPrimitive","queryStringify","sep","eq","ks","Boolean","xhrRes","xhr","getAllResponseHeaders","status","statusText","xhrBody","responseText","request","qsStr","XMLHttpRequest","open","responseType","setRequestHeader","upload","onprogress","onerror","send","nameStartChar","nameChar","tagNamePattern","S_TAG","S_ATTR","S_ATTR_SPACE","S_EQ","S_ATTR_NOQUOT_VALUE","S_ATTR_END","S_TAG_SPACE","S_TAG_CLOSE","defaultNSMapCopy","fixedFromCharCode","surrogate1","surrogate2","entityReplacer","charAt","appendText","xt","lineEnd","linePattern","exec","lineStart","parseStack","currentNSMap","closeMap","tagStart","config","pop","localNSMap","endMatch","endIgnoreCaseMach","parseInstruction","parseDCC","ElementAttributes","parseElementStartPart","closed","fixSelfClosed","locator2","copyLocator","parseHtmlSpecialContent","f","attrName","s","add","setTagName","nsp","nsPrefix","_copy","elStartEnd","elEndStart","pos","matchs","lastMatch","endDTD","_set_proto_","thiz","parent","reg","getLocalName","g","lib","Base","mixIn","$super","WordArray","words","sigBytes","concat","q","clamp","enc","Hex","Latin1","h","Utf8","unescape","BufferedBlockAlgorithm","reset","_data","_nDataBytes","_append","_process","blockSize","_minBufferSize","_doProcessBlock","Hasher","cfg","_doReset","_doFinalize","_createHelper","_createHmacHelper","HMAC","algo","_hash","_hasher","_oKey","_iKey","C","C_lib","C_enc","Base64","wordArray","_map","base64Chars","byte1","byte2","byte3","triplet","paddingChar","base64StrLength","paddingIndex","nBytes","bits1","bits2","normalizeArray","parts","allowAboveRoot","up","last","basename","matchedSlash","xs","resolvedPath","resolvedAbsolute","TypeError","isAbsolute","trailingSlash","paths","relative","from","to","fromParts","toParts","samePartsLength","outputParts","delimiter","dirname","hasRoot","ext","extname","startDot","startPart","preDotState","originApiMap","apiMap","_addTask","initTask","queue","tasks","uploadingFileCount","nextUploadIndex","formatTask","FilePath","state","hashPercent","_custom","emitListUpdate","clearQueue","isActive","startNextTask","onTaskStart","apiParams","switchToState","waiting","pipe","toState","isTaskReadyWarning","ignoreAddEvent","TaskReady","getTaskList","cancelTask","pauseTask","restartTask","isUploadRunning"],"mappings":"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","file":"js/list~mount.782fb0c6.js","sourcesContent":["'use strict';\r\n\r\nvar md5 = require('../lib/md5');\r\nvar CryptoJS = require('../lib/crypto');\r\nvar xml2json = require('../lib/xml2json');\r\nvar json2xml = require('../lib/json2xml');\r\n\r\nfunction camSafeUrlEncode(str) {\r\n    return encodeURIComponent(str)\r\n        .replace(/!/g, '%21')\r\n        .replace(/'/g, '%27')\r\n        .replace(/\\(/g, '%28')\r\n        .replace(/\\)/g, '%29')\r\n        .replace(/\\*/g, '%2A');\r\n}\r\n\r\n//key\r\nvar getAuth = function (opt) {\r\n    opt = opt || {};\r\n\r\n    var SecretId = opt.SecretId;\r\n    var SecretKey = opt.SecretKey;\r\n    var KeyTime = opt.KeyTime;\r\n    var method = (opt.method || opt.Method || 'get').toLowerCase();\r\n    var queryParams = clone(opt.Query || opt.params || {});\r\n    var headers = clone(opt.Headers || opt.headers || {});\r\n\r\n    var Key = opt.Key || '';\r\n    var pathname;\r\n    if (opt.UseRawKey) {\r\n        pathname = opt.Pathname || opt.pathname || '/' + Key;\r\n    } else {\r\n        pathname = opt.Pathname || opt.pathname || Key;\r\n        pathname.indexOf('/') !== 0 && (pathname = '/' + pathname);\r\n    }\r\n\r\n    if (!SecretId) return console.error('missing param SecretId');\r\n    if (!SecretKey) return console.error('missing param SecretKey');\r\n\r\n    var getObjectKeys = function (obj, forKey) {\r\n        var list = [];\r\n        for (var key in obj) {\r\n            if (obj.hasOwnProperty(key)) {\r\n                list.push(forKey ? camSafeUrlEncode(key).toLowerCase() : key);\r\n            }\r\n        }\r\n        return list.sort(function (a, b) {\r\n            a = a.toLowerCase();\r\n            b = b.toLowerCase();\r\n            return a === b ? 0 : (a > b ? 1 : -1);\r\n        });\r\n    };\r\n\r\n    var obj2str = function (obj) {\r\n        var i, key, val;\r\n        var list = [];\r\n        var keyList = getObjectKeys(obj);\r\n        for (i = 0; i < keyList.length; i++) {\r\n            key = keyList[i];\r\n            val = (obj[key] === undefined || obj[key] === null) ? '' : ('' + obj[key]);\r\n            key = camSafeUrlEncode(key).toLowerCase();\r\n            val = camSafeUrlEncode(val) || '';\r\n            list.push(key + '=' + val)\r\n        }\r\n        return list.join('&');\r\n    };\r\n\r\n    // \r\n    var now = Math.round(getSkewTime(opt.SystemClockOffset) / 1000) - 1;\r\n    var exp = now;\r\n\r\n    var Expires = opt.Expires || opt.expires;\r\n    if (Expires === undefined) {\r\n        exp += 900; //  + 900s\r\n    } else {\r\n        exp += (Expires * 1) || 0;\r\n    }\r\n\r\n    //  Authorization \r\n    var qSignAlgorithm = 'sha1';\r\n    var qAk = SecretId;\r\n    var qSignTime = KeyTime || now + ';' + exp;\r\n    var qKeyTime = KeyTime || now + ';' + exp;\r\n    var qHeaderList = getObjectKeys(headers).join(';').toLowerCase();\r\n    var qUrlParamList = getObjectKeys(queryParams).join(';').toLowerCase();\r\n\r\n    // https://www.qcloud.com/document/product/436/7778\r\n    //  SignKey\r\n    var signKey = CryptoJS.HmacSHA1(qKeyTime, SecretKey).toString();\r\n\r\n    //  FormatString\r\n    var formatString = [method, pathname, obj2str(queryParams), obj2str(headers), ''].join('\\n');\r\n\r\n    //  StringToSign\r\n    var stringToSign = ['sha1', qSignTime, CryptoJS.SHA1(formatString).toString(), ''].join('\\n');\r\n\r\n    //  Signature\r\n    var qSignature = CryptoJS.HmacSHA1(stringToSign, signKey).toString();\r\n\r\n    //  Authorization\r\n    var authorization = [\r\n        'q-sign-algorithm=' + qSignAlgorithm,\r\n        'q-ak=' + qAk,\r\n        'q-sign-time=' + qSignTime,\r\n        'q-key-time=' + qKeyTime,\r\n        'q-header-list=' + qHeaderList,\r\n        'q-url-param-list=' + qUrlParamList,\r\n        'q-signature=' + qSignature\r\n    ].join('&');\r\n\r\n    return authorization;\r\n\r\n};\r\n\r\nvar noop = function () {\r\n\r\n};\r\n\r\n//  undefined  null \r\nvar clearKey = function (obj) {\r\n    var retObj = {};\r\n    for (var key in obj) {\r\n        if (obj.hasOwnProperty(key) && obj[key] !== undefined && obj[key] !== null) {\r\n            retObj[key] = obj[key];\r\n        }\r\n    }\r\n    return retObj;\r\n};\r\n\r\nvar readAsBinaryString = function (blob, callback) {\r\n    var readFun;\r\n    var fr = new FileReader();\r\n    if (FileReader.prototype.readAsBinaryString) {\r\n        readFun = FileReader.prototype.readAsBinaryString;\r\n        fr.onload = function () {\r\n            callback(this.result);\r\n        };\r\n    } else if (FileReader.prototype.readAsArrayBuffer) { //  ie11  readAsBinaryString \r\n        readFun = function (fileData) {\r\n            var binary = \"\";\r\n            var pt = this;\r\n            var reader = new FileReader();\r\n            reader.onload = function (e) {\r\n                var bytes = new Uint8Array(reader.result);\r\n                var length = bytes.byteLength;\r\n                for (var i = 0; i < length; i++) {\r\n                    binary += String.fromCharCode(bytes[i]);\r\n                }\r\n                callback(binary);\r\n            };\r\n            reader.readAsArrayBuffer(fileData);\r\n        };\r\n    } else {\r\n        console.error('FileReader not support readAsBinaryString');\r\n    }\r\n    readFun.call(fr, blob);\r\n};\r\n\r\nvar fileSliceNeedCopy = (function () {\r\n    var compareVersion = function(a, b) {\r\n        a = a.split('.');\r\n        b = b.split('.');\r\n        for (var i = 0; i < b.length; i++) {\r\n            if (a[i] !== b[i]) {\r\n                return parseInt(a[i]) > parseInt(b[i]) ? 1 : -1;\r\n            }\r\n        }\r\n        return 0;\r\n    };\r\n    var check = function (ua) {\r\n        var ChromeVersion = (ua.match(/Chrome\\/([.\\d]+)/) || [])[1];\r\n        var QBCoreVersion = (ua.match(/QBCore\\/([.\\d]+)/) || [])[1];\r\n        var QQBrowserVersion = (ua.match(/QQBrowser\\/([.\\d]+)/) || [])[1];\r\n        var need = ChromeVersion && compareVersion(ChromeVersion, '53.0.2785.116') < 0\r\n            && QBCoreVersion && compareVersion(QBCoreVersion, '3.53.991.400') < 0\r\n            && QQBrowserVersion && compareVersion(QQBrowserVersion, '9.0.2524.400') <= 0 || false;\r\n        return need;\r\n    };\r\n    return check(navigator && navigator.userAgent);\r\n})();\r\n\r\n// \r\nvar fileSlice = function (file, start, end, isUseToUpload, callback) {\r\n    var blob;\r\n    if (file.slice) {\r\n        blob = file.slice(start, end);\r\n    } else if (file.mozSlice) {\r\n        blob = file.mozSlice(start, end);\r\n    } else if (file.webkitSlice) {\r\n        blob = file.webkitSlice(start, end);\r\n    }\r\n    if (isUseToUpload && fileSliceNeedCopy) {\r\n        var reader = new FileReader();\r\n        reader.onload = function (e) {\r\n            blob = null;\r\n            callback(new Blob([reader.result]));\r\n        };\r\n        reader.readAsArrayBuffer(blob);\r\n    } else {\r\n        callback(blob);\r\n    }\r\n};\r\n\r\n//  MD5\r\nvar getBodyMd5 = function (UploadCheckContentMd5, Body, callback, onProgress) {\r\n    callback = callback || noop;\r\n    if (UploadCheckContentMd5) {\r\n        if (typeof Body === 'string') {\r\n            callback(util.md5(Body, true));\r\n        } else if (Blob && Body instanceof Blob) {\r\n            util.getFileMd5(Body, function (err, md5) {\r\n                callback(md5);\r\n            }, onProgress);\r\n        } else {\r\n            callback();\r\n        }\r\n    } else {\r\n        callback();\r\n    }\r\n};\r\n\r\n//  md5 \r\nvar md5ChunkSize = 1024 * 1024;\r\nvar getFileMd5 = function (blob, callback, onProgress) {\r\n    var size = blob.size;\r\n    var loaded = 0;\r\n    var md5ctx = md5.getCtx();\r\n    var next = function (start) {\r\n        if (start >= size) {\r\n            var hash = md5ctx.digest('hex');\r\n            callback(null, hash);\r\n            return;\r\n        }\r\n        var end = Math.min(size, start + md5ChunkSize);\r\n        util.fileSlice(blob, start, end, false, function (chunk) {\r\n            readAsBinaryString(chunk, function (content) {\r\n                chunk = null;\r\n                md5ctx = md5ctx.update(content, true);\r\n                loaded += content.length;\r\n                content = null;\r\n                if (onProgress) onProgress({loaded: loaded, total: size, percent: Math.round(loaded / size * 10000) / 10000});\r\n                next(start + md5ChunkSize);\r\n            });\r\n        });\r\n    };\r\n    next(0);\r\n};\r\n\r\nfunction clone(obj) {\r\n    return map(obj, function (v) {\r\n        return typeof v === 'object' && v !== null ? clone(v) : v;\r\n    });\r\n}\r\n\r\nfunction attr(obj, name, defaultValue) {\r\n    return obj && name in obj ? obj[name] : defaultValue;\r\n}\r\n\r\nfunction extend(target, source) {\r\n    each(source, function (val, key) {\r\n        target[key] = source[key];\r\n    });\r\n    return target;\r\n}\r\n\r\nfunction isArray(arr) {\r\n    return arr instanceof Array;\r\n}\r\n\r\nfunction isInArray(arr, item) {\r\n    var flag = false;\r\n    for (var i = 0; i < arr.length; i++) {\r\n        if (item === arr[i]) {\r\n            flag = true;\r\n            break;\r\n        }\r\n    }\r\n    return flag;\r\n}\r\n\r\nfunction makeArray(arr) {\r\n    return isArray(arr) ? arr : [arr];\r\n}\r\n\r\nfunction each(obj, fn) {\r\n    for (var i in obj) {\r\n        if (obj.hasOwnProperty(i)) {\r\n            fn(obj[i], i);\r\n        }\r\n    }\r\n}\r\n\r\nfunction map(obj, fn) {\r\n    var o = isArray(obj) ? [] : {};\r\n    for (var i in obj) {\r\n        if (obj.hasOwnProperty(i)) {\r\n            o[i] = fn(obj[i], i);\r\n        }\r\n    }\r\n    return o;\r\n}\r\n\r\nfunction filter(obj, fn) {\r\n    var iaArr = isArray(obj);\r\n    var o = iaArr ? [] : {};\r\n    for (var i in obj) {\r\n        if (obj.hasOwnProperty(i)) {\r\n            if (fn(obj[i], i)) {\r\n                if (iaArr) {\r\n                    o.push(obj[i]);\r\n                } else {\r\n                    o[i] = obj[i];\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return o;\r\n}\r\n\r\nvar binaryBase64 = function (str) {\r\n    var i, len, char, res = '';\r\n    for (i = 0, len = str.length / 2; i < len; i++) {\r\n        char = parseInt(str[i * 2] + str[i * 2 + 1], 16);\r\n        res += String.fromCharCode(char);\r\n    }\r\n    return btoa(res);\r\n};\r\nvar uuid = function () {\r\n    var S4 = function () {\r\n        return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\r\n    };\r\n    return (S4() + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + S4() + S4());\r\n};\r\n\r\nvar hasMissingParams = function (apiName, params) {\r\n    var Bucket = params.Bucket;\r\n    var Region = params.Region;\r\n    var Key = params.Key;\r\n    if (apiName.indexOf('Bucket') > -1 || apiName === 'deleteMultipleObject' || apiName === 'multipartList' || apiName === 'listObjectVersions') {\r\n        if (!Bucket) return 'Bucket';\r\n        if (!Region) return 'Region';\r\n    } else if (apiName.indexOf('Object') > -1 || apiName.indexOf('multipart') > -1 || apiName === 'sliceUploadFile' || apiName === 'abortUploadTask') {\r\n        if (!Bucket) return 'Bucket';\r\n        if (!Region) return 'Region';\r\n        if (!Key) return 'Key';\r\n    }\r\n    return false;\r\n};\r\n\r\nvar formatParams = function (apiName, params) {\r\n\r\n    // \r\n    params = extend({}, params);\r\n\r\n    //  Headers\r\n    if (apiName !== 'getAuth' && apiName !== 'getV4Auth' && apiName !== 'getObjectUrl') {\r\n        var Headers = params.Headers || {};\r\n        if (params && typeof params === 'object') {\r\n            (function () {\r\n                for (var key in params) {\r\n                    if (params.hasOwnProperty(key) && key.indexOf('x-cos-') > -1) {\r\n                        Headers[key] = params[key];\r\n                    }\r\n                }\r\n            })();\r\n\r\n            var headerMap = {\r\n                // params headers\r\n                'x-cos-mfa': 'MFA',\r\n                'Content-MD5': 'ContentMD5',\r\n                'Content-Length': 'ContentLength',\r\n                'Content-Type': 'ContentType',\r\n                'Expect': 'Expect',\r\n                'Expires': 'Expires',\r\n                'Cache-Control': 'CacheControl',\r\n                'Content-Disposition': 'ContentDisposition',\r\n                'Content-Encoding': 'ContentEncoding',\r\n                'Range': 'Range',\r\n                'If-Modified-Since': 'IfModifiedSince',\r\n                'If-Unmodified-Since': 'IfUnmodifiedSince',\r\n                'If-Match': 'IfMatch',\r\n                'If-None-Match': 'IfNoneMatch',\r\n                'x-cos-copy-source': 'CopySource',\r\n                'x-cos-copy-source-Range': 'CopySourceRange',\r\n                'x-cos-metadata-directive': 'MetadataDirective',\r\n                'x-cos-copy-source-If-Modified-Since': 'CopySourceIfModifiedSince',\r\n                'x-cos-copy-source-If-Unmodified-Since': 'CopySourceIfUnmodifiedSince',\r\n                'x-cos-copy-source-If-Match': 'CopySourceIfMatch',\r\n                'x-cos-copy-source-If-None-Match': 'CopySourceIfNoneMatch',\r\n                'x-cos-acl': 'ACL',\r\n                'x-cos-grant-read': 'GrantRead',\r\n                'x-cos-grant-write': 'GrantWrite',\r\n                'x-cos-grant-full-control': 'GrantFullControl',\r\n                'x-cos-grant-read-acp': 'GrantReadAcp',\r\n                'x-cos-grant-write-acp': 'GrantWriteAcp',\r\n                'x-cos-storage-class': 'StorageClass',\r\n                // SSE-C\r\n                'x-cos-server-side-encryption-customer-algorithm': 'SSECustomerAlgorithm',\r\n                'x-cos-server-side-encryption-customer-key': 'SSECustomerKey',\r\n                'x-cos-server-side-encryption-customer-key-MD5': 'SSECustomerKeyMD5',\r\n                // SSE-COSSSE-KMS\r\n                'x-cos-server-side-encryption': 'ServerSideEncryption',\r\n                'x-cos-server-side-encryption-cos-kms-key-id': 'SSEKMSKeyId',\r\n                'x-cos-server-side-encryption-context': 'SSEContext',\r\n            };\r\n            util.each(headerMap, function (paramKey, headerKey) {\r\n                if (params[paramKey] !== undefined) {\r\n                    Headers[headerKey] = params[paramKey];\r\n                }\r\n            });\r\n\r\n            params.Headers = clearKey(Headers);\r\n        }\r\n    }\r\n\r\n    return params;\r\n};\r\n\r\nvar apiWrapper = function (apiName, apiFn) {\r\n    return function (params, callback) {\r\n\r\n        var self = this;\r\n\r\n        // \r\n        if (typeof params === 'function') {\r\n            callback = params;\r\n            params = {};\r\n        }\r\n\r\n        // \r\n        params = formatParams(apiName, params);\r\n\r\n        // \r\n        var formatResult = function (result) {\r\n            if (result && result.headers) {\r\n                result.headers['x-cos-version-id'] && (result.VersionId = result.headers['x-cos-version-id']);\r\n                result.headers['x-cos-delete-marker'] && (result.DeleteMarker = result.headers['x-cos-delete-marker']);\r\n            }\r\n            return result;\r\n        };\r\n        var _callback = function (err, data) {\r\n            callback && callback(formatResult(err), formatResult(data));\r\n        };\r\n\r\n        var checkParams = function () {\r\n            if (apiName !== 'getService' && apiName !== 'abortUploadTask') {\r\n                // \r\n                var missingResult = hasMissingParams(apiName, params)\r\n                if (missingResult) {\r\n                    return 'missing param ' + missingResult;\r\n                }\r\n                //  region \r\n                if (params.Region) {\r\n                    if (params.Region.indexOf('cos.') > -1) {\r\n                        return 'param Region should not be start with \"cos.\"';\r\n                    } else if (!/^([a-z\\d-]+)$/.test(params.Region)) {\r\n                        return 'Region format error.';\r\n                    }\r\n                    //  region \r\n                    if (!self.options.CompatibilityMode && params.Region.indexOf('-') === -1 && params.Region !== 'yfb' && params.Region !== 'default') {\r\n                        console.warn('warning: param Region format error, find help here: https://cloud.tencent.com/document/product/436/6224');\r\n                    }\r\n                }\r\n                //  AppId  Bucket\r\n                if (params.Bucket) {\r\n                    if (!/^([a-z\\d-]+)-(\\d+)$/.test(params.Bucket)) {\r\n                        if (params.AppId) {\r\n                            params.Bucket = params.Bucket + '-' + params.AppId;\r\n                        } else if (self.options.AppId) {\r\n                            params.Bucket = params.Bucket + '-' + self.options.AppId;\r\n                        } else {\r\n                            return 'Bucket should format as \"test-1250000000\".';\r\n                        }\r\n                    }\r\n                    if (params.AppId) {\r\n                        console.warn('warning: AppId has been deprecated, Please put it at the end of parameter Bucket(E.g Bucket:\"test-1250000000\" ).');\r\n                        delete params.AppId;\r\n                    }\r\n                }\r\n                //  Key  /  /\r\n                if (!self.options.UseRawKey && params.Key && params.Key.substr(0, 1) === '/') {\r\n                    params.Key = params.Key.substr(1);\r\n                }\r\n            }\r\n        };\r\n\r\n        var errMsg = checkParams();\r\n        var isSync = apiName === 'getAuth' || apiName === 'getObjectUrl';\r\n        var Promise = global.Promise;\r\n        if (!isSync && Promise && !callback) {\r\n            return new Promise(function (resolve, reject) {\r\n                callback = function (err, data) {\r\n                    err ? reject(err) : resolve(data);\r\n                };\r\n                if (errMsg) return _callback({error: errMsg});\r\n                apiFn.call(self, params, _callback);\r\n            });\r\n        } else {\r\n            if (errMsg) return _callback({error: errMsg});\r\n            var res = apiFn.call(self, params, _callback);\r\n            if (isSync) return res;\r\n        }\r\n    }\r\n};\r\n\r\nvar throttleOnProgress = function (total, onProgress) {\r\n    var self = this;\r\n    var size0 = 0;\r\n    var size1 = 0;\r\n    var time0 = Date.now();\r\n    var time1;\r\n    var timer;\r\n\r\n    function update() {\r\n        timer = 0;\r\n        if (onProgress && (typeof onProgress === 'function')) {\r\n            time1 = Date.now();\r\n            var speed = Math.max(0, Math.round((size1 - size0) / ((time1 - time0) / 1000) * 100) / 100) || 0;\r\n            var percent;\r\n            if (size1 === 0 && total === 0) {\r\n                percent = 1;\r\n            } else {\r\n                percent = Math.floor(size1 / total * 100) / 100 || 0;\r\n            }\r\n            time0 = time1;\r\n            size0 = size1;\r\n            try {\r\n                onProgress({loaded: size1, total: total, speed: speed, percent: percent});\r\n            } catch (e) {\r\n            }\r\n        }\r\n    }\r\n\r\n    return function (info, immediately) {\r\n        if (info) {\r\n            size1 = info.loaded;\r\n            total = info.total;\r\n        }\r\n        if (immediately) {\r\n            clearTimeout(timer);\r\n            update();\r\n        } else {\r\n            if (timer) return;\r\n            timer = setTimeout(update, self.options.ProgressInterval);\r\n        }\r\n    };\r\n};\r\n\r\nvar getFileSize = function (api, params, callback) {\r\n    var size;\r\n    if (typeof params.Body === 'string') {\r\n        params.Body = new Blob([params.Body], {type: 'text/plain'});\r\n    } else if (params.Body instanceof ArrayBuffer) {\r\n        params.Body = new Blob([params.Body]);\r\n    }\r\n    if ((params.Body && (params.Body instanceof Blob || params.Body.toString() === '[object File]' || params.Body.toString() === '[object Blob]'))) {\r\n        size = params.Body.size;\r\n    } else {\r\n        callback({error: 'params body format error, Only allow File|Blob|String.'});\r\n        return;\r\n    }\r\n    params.ContentLength = size;\r\n    callback(null, size);\r\n};\r\n\r\n// \r\nvar getSkewTime = function (offset) {\r\n    return Date.now() + (offset || 0);\r\n};\r\n\r\nvar util = {\r\n    noop: noop,\r\n    formatParams: formatParams,\r\n    apiWrapper: apiWrapper,\r\n    xml2json: xml2json,\r\n    json2xml: json2xml,\r\n    md5: md5,\r\n    clearKey: clearKey,\r\n    fileSlice: fileSlice,\r\n    getBodyMd5: getBodyMd5,\r\n    getFileMd5: getFileMd5,\r\n    binaryBase64: binaryBase64,\r\n    extend: extend,\r\n    isArray: isArray,\r\n    isInArray: isInArray,\r\n    makeArray: makeArray,\r\n    each: each,\r\n    map: map,\r\n    filter: filter,\r\n    clone: clone,\r\n    attr: attr,\r\n    uuid: uuid,\r\n    camSafeUrlEncode: camSafeUrlEncode,\r\n    throttleOnProgress: throttleOnProgress,\r\n    getFileSize: getFileSize,\r\n    getSkewTime: getSkewTime,\r\n    getAuth: getAuth,\r\n    isBrowser: true,\r\n};\r\n\r\nmodule.exports = util;\r\n","var initEvent = function (cos) {\r\n    var listeners = {};\r\n    var getList = function (action) {\r\n        !listeners[action] && (listeners[action] = []);\r\n        return listeners[action];\r\n    };\r\n    cos.on = function (action, callback) {\r\n        if (action === 'task-list-update') {\r\n            console.warn('warning: Event \"' + action + '\" has been deprecated. Please use \"list-update\" instead.');\r\n        }\r\n        getList(action).push(callback);\r\n    };\r\n    cos.off = function (action, callback) {\r\n        var list = getList(action);\r\n        for (var i = list.length - 1; i >= 0; i--) {\r\n            callback === list[i] && list.splice(i, 1);\r\n        }\r\n    };\r\n    cos.emit = function (action, data) {\r\n        var list = getList(action).map(function (cb) {\r\n            return cb;\r\n        });\r\n        for (var i = 0; i < list.length; i++) {\r\n            list[i](data);\r\n        }\r\n    };\r\n};\r\n\r\nvar EventProxy = function () {\r\n    initEvent(this);\r\n};\r\n\r\nmodule.exports.init = initEvent;\r\nmodule.exports.EventProxy = EventProxy;","var util = require('./util');\r\n\r\n//  UploadId\r\nvar cacheKey = 'cos_sdk_upload_cache';\r\nvar expires = 30 * 24 * 3600;\r\nvar cache;\r\nvar timer;\r\n\r\nvar getCache = function () {\r\n    try {\r\n        var val = JSON.parse(localStorage.getItem(cacheKey));\r\n    } catch (e) {\r\n    }\r\n    if (!val) val = [];\r\n    return val;\r\n};\r\nvar setCache = function () {\r\n    try {\r\n        localStorage.setItem(cacheKey, JSON.stringify(cache))\r\n    } catch (e) {\r\n    }\r\n};\r\n\r\nvar init = function () {\r\n    if (cache) return;\r\n    cache = getCache();\r\n    // \r\n    var changed = false;\r\n    var now = Math.round(Date.now() / 1000);\r\n    for (var i = cache.length - 1; i >= 0; i--) {\r\n        var mtime = cache[i][2];\r\n        if (!mtime || mtime + expires < now) {\r\n            cache.splice(i, 1);\r\n            changed = true;\r\n        }\r\n    }\r\n    changed && setCache();\r\n};\r\n\r\n// \r\nvar save = function () {\r\n    if (timer) return;\r\n    timer = setTimeout(function () {\r\n        setCache();\r\n        timer = null;\r\n    }, 400);\r\n};\r\n\r\nvar mod = {\r\n    using: {},\r\n    //  UploadId \r\n    setUsing: function (uuid) {\r\n        mod.using[uuid] = true;\r\n    },\r\n    //  UploadId \r\n    removeUsing: function (uuid) {\r\n        delete mod.using[uuid];\r\n    },\r\n    // \r\n    getFileId: function (file, ChunkSize, Bucket, Key) {\r\n        if (file.name && file.size && file.lastModifiedDate && ChunkSize) {\r\n            return util.md5([file.name, file.size, file.lastModifiedDate, ChunkSize, Bucket, Key].join('::'));\r\n        } else {\r\n            return null;\r\n        }\r\n    },\r\n    //  UploadId \r\n    getUploadIdList: function (uuid) {\r\n        if (!uuid) return null;\r\n        init();\r\n        var list = [];\r\n        for (var i = 0; i < cache.length; i++) {\r\n            if (cache[i][0] === uuid)\r\n                list.push(cache[i][1]);\r\n        }\r\n        return list.length ? list : null;\r\n    },\r\n    //  UploadId\r\n    saveUploadId: function (uuid, UploadId, limit) {\r\n        init();\r\n        if (!uuid) return;\r\n        //  UploadIdjs  FilePath \r\n        for (var i = cache.length - 1; i >= 0; i--) {\r\n            var item = cache[i];\r\n            if (item[0] === uuid && item[1] === UploadId) {\r\n                cache.splice(i, 1);\r\n            }\r\n        }\r\n        cache.unshift([uuid, UploadId, Math.round(Date.now() / 1000)]);\r\n        if (cache.length > limit) cache.splice(limit);\r\n        save();\r\n    },\r\n    // UploadId \r\n    removeUploadId: function (UploadId) {\r\n        init();\r\n        delete mod.using[UploadId];\r\n        for (var i = cache.length - 1; i >= 0; i--) {\r\n            if (cache[i][1] === UploadId) cache.splice(i, 1)\r\n        }\r\n        save();\r\n    },\r\n};\r\n\r\nmodule.exports = mod;\r\n","/* Copyright 2015 William Summers, MetaTribal LLC\r\n * adapted from https://developer.mozilla.org/en-US/docs/JXON\r\n *\r\n * Licensed under the MIT License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     https://opensource.org/licenses/MIT\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @author William Summers\r\n * https://github.com/metatribal/xmlToJSON\r\n */\r\nvar DOMParser = require('xmldom').DOMParser;\r\n\r\nvar xmlToJSON = (function () {\r\n\r\n    this.version = \"1.3.5\";\r\n\r\n    var options = { // set up the default options\r\n        mergeCDATA: true, // extract cdata and merge with text\r\n        normalize: true, // collapse multiple spaces to single space\r\n        stripElemPrefix: true, // for elements of same name in diff namespaces, you can enable namespaces and access the nskey property\r\n    };\r\n\r\n    var prefixMatch = new RegExp(/(?!xmlns)^.*:/);\r\n    var trimMatch = new RegExp(/^\\s+|\\s+$/g);\r\n\r\n    this.grokType = function (sValue) {\r\n        if (/^\\s*$/.test(sValue)) {\r\n            return null;\r\n        }\r\n        if (/^(?:true|false)$/i.test(sValue)) {\r\n            return sValue.toLowerCase() === \"true\";\r\n        }\r\n        if (isFinite(sValue)) {\r\n            return parseFloat(sValue);\r\n        }\r\n        return sValue;\r\n    };\r\n\r\n    this.parseString = function (xmlString, opt) {\r\n        if (xmlString) {\r\n            var xml = this.stringToXML(xmlString);\r\n            if (xml.getElementsByTagName('parsererror').length) {\r\n                return null;\r\n            } else {\r\n                return this.parseXML(xml, opt);\r\n            }\r\n        } else {\r\n            return null;\r\n        }\r\n    };\r\n\r\n    this.parseXML = function (oXMLParent, opt) {\r\n\r\n        // initialize options\r\n        for (var key in opt) {\r\n            options[key] = opt[key];\r\n        }\r\n\r\n        var vResult = {},\r\n            nLength = 0,\r\n            sCollectedTxt = \"\";\r\n\r\n        // iterate over the children\r\n        var childNum = oXMLParent.childNodes.length;\r\n        if (childNum) {\r\n            for (var oNode, sProp, vContent, nItem = 0; nItem < oXMLParent.childNodes.length; nItem++) {\r\n                oNode = oXMLParent.childNodes.item(nItem);\r\n\r\n                if (oNode.nodeType === 4) {\r\n                    if (options.mergeCDATA) {\r\n                        sCollectedTxt += oNode.nodeValue;\r\n                    }\r\n                } /* nodeType is \"CDATASection\" (4) */\r\n                else if (oNode.nodeType === 3) {\r\n                    sCollectedTxt += oNode.nodeValue;\r\n                } /* nodeType is \"Text\" (3) */\r\n                else if (oNode.nodeType === 1) { /* nodeType is \"Element\" (1) */\r\n\r\n                    if (nLength === 0) {\r\n                        vResult = {};\r\n                    }\r\n\r\n                    // using nodeName to support browser (IE) implementation with no 'localName' property\r\n                    if (options.stripElemPrefix) {\r\n                        sProp = oNode.nodeName.replace(prefixMatch, '');\r\n                    } else {\r\n                        sProp = oNode.nodeName;\r\n                    }\r\n\r\n                    vContent = xmlToJSON.parseXML(oNode);\r\n\r\n                    if (vResult.hasOwnProperty(sProp)) {\r\n                        if (vResult[sProp].constructor !== Array) {\r\n                            vResult[sProp] = [vResult[sProp]];\r\n                        }\r\n                        vResult[sProp].push(vContent);\r\n\r\n                    } else {\r\n                        vResult[sProp] = vContent;\r\n                        nLength++;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!Object.keys(vResult).length) {\r\n            // vResult = sCollectedTxt.replace(trimMatch, '') || ''; // by carsonxu  getBucket Key  \" /\" \r\n            vResult = sCollectedTxt || '';\r\n        }\r\n\r\n        return vResult;\r\n    };\r\n\r\n    // Convert xmlDocument to a string\r\n    // Returns null on failure\r\n    this.xmlToString = function (xmlDoc) {\r\n        try {\r\n            var xmlString = xmlDoc.xml ? xmlDoc.xml : (new XMLSerializer()).serializeToString(xmlDoc);\r\n            return xmlString;\r\n        } catch (err) {\r\n            return null;\r\n        }\r\n    };\r\n\r\n    // Convert a string to XML Node Structure\r\n    // Returns null on failure\r\n    this.stringToXML = function (xmlString) {\r\n        try {\r\n            var xmlDoc = null;\r\n\r\n            if (window.DOMParser) {\r\n\r\n                var parser = new DOMParser();\r\n                xmlDoc = parser.parseFromString(xmlString, \"text/xml\");\r\n\r\n                return xmlDoc;\r\n            } else {\r\n                xmlDoc = new ActiveXObject(\"Microsoft.XMLDOM\");\r\n                xmlDoc.async = false;\r\n                xmlDoc.loadXML(xmlString);\r\n\r\n                return xmlDoc;\r\n            }\r\n        } catch (e) {\r\n            return null;\r\n        }\r\n    };\r\n\r\n    return this;\r\n\r\n}).call({});\r\n\r\nvar xml2json = function (xmlString) {\r\n    return xmlToJSON.parseString(xmlString);\r\n};\r\n\r\nmodule.exports = xml2json;\r\n","'use strict';\r\n\r\nvar util = require('./util');\r\nvar event = require('./event');\r\nvar task = require('./task');\r\nvar base = require('./base');\r\nvar advance = require('./advance');\r\n\r\nvar defaultOptions = {\r\n    AppId: '', // AppId  Bucket test-1250000000\r\n    SecretId: '',\r\n    SecretKey: '',\r\n    XCosSecurityToken: '', //  Token\r\n    ChunkRetryTimes: 2,\r\n    FileParallelLimit: 3,\r\n    ChunkParallelLimit: 3,\r\n    ChunkSize: 1024 * 1024,\r\n    SliceSize: 1024 * 1024,\r\n    CopyChunkParallelLimit: 20,\r\n    CopyChunkSize: 1024 * 1024 * 10,\r\n    CopySliceSize: 1024 * 1024 * 10,\r\n    MaxPartNumber: 10000,\r\n    ProgressInterval: 1000,\r\n    UploadQueueSize: 10000,\r\n    Domain: '',\r\n    ServiceDomain: '',\r\n    Protocol: '',\r\n    CompatibilityMode: false,\r\n    ForcePathStyle: false,\r\n    UseRawKey: false,\r\n    Timeout: 0, // 0 \r\n    CorrectClockSkew: true,\r\n    SystemClockOffset: 0, // ms\r\n    UploadCheckContentMd5: false,\r\n    UploadAddMetaMd5: false,\r\n    UploadIdCacheLimit: 50,\r\n};\r\n\r\n// \r\nvar COS = function (options) {\r\n    this.options = util.extend(util.clone(defaultOptions), options || {});\r\n    this.options.FileParallelLimit = Math.max(1, this.options.FileParallelLimit);\r\n    this.options.ChunkParallelLimit = Math.max(1, this.options.ChunkParallelLimit);\r\n    this.options.ChunkRetryTimes = Math.max(0, this.options.ChunkRetryTimes);\r\n    this.options.ChunkSize = Math.max(1024 * 1024, this.options.ChunkSize);\r\n    this.options.CopyChunkParallelLimit = Math.max(1, this.options.CopyChunkParallelLimit);\r\n    this.options.CopyChunkSize = Math.max(1024 * 1024, this.options.CopyChunkSize);\r\n    this.options.CopySliceSize = Math.max(0, this.options.CopySliceSize);\r\n    this.options.MaxPartNumber = Math.max(1024, Math.min(10000, this.options.MaxPartNumber));\r\n    this.options.Timeout = Math.max(0, this.options.Timeout);\r\n    if (this.options.AppId) {\r\n        console.warn('warning: AppId has been deprecated, Please put it at the end of parameter Bucket(E.g: \"test-1250000000\").');\r\n    }\r\n    event.init(this);\r\n    task.init(this);\r\n};\r\n\r\nbase.init(COS, task);\r\nadvance.init(COS, task);\r\n\r\nCOS.getAuthorization = util.getAuth;\r\nCOS.version = '1.1.5';\r\n\r\nmodule.exports = COS;\r\n","var session = require('./session');\r\nvar Async = require('./async');\r\nvar EventProxy = require('./event').EventProxy;\r\nvar util = require('./util');\r\n\r\n// \r\nfunction sliceUploadFile(params, callback) {\r\n    var self = this;\r\n    var ep = new EventProxy();\r\n    var TaskId = params.TaskId;\r\n    var Bucket = params.Bucket;\r\n    var Region = params.Region;\r\n    var Key = params.Key;\r\n    var Body = params.Body;\r\n    var ChunkSize = params.ChunkSize || params.SliceSize || self.options.ChunkSize;\r\n    var AsyncLimit = params.AsyncLimit;\r\n    var StorageClass = params.StorageClass;\r\n    var ServerSideEncryption = params.ServerSideEncryption;\r\n    var FileSize;\r\n\r\n    var onProgress;\r\n    var onHashProgress = params.onHashProgress;\r\n\r\n    // \r\n    ep.on('error', function (err) {\r\n        if (!self._isRunningTask(TaskId)) return;\r\n        return callback(err);\r\n    });\r\n\r\n    //  uploadSliceComplete \r\n    ep.on('upload_complete', function (UploadCompleteData) {\r\n        callback(null, UploadCompleteData);\r\n    });\r\n\r\n    //  uploadSliceComplete \r\n    ep.on('upload_slice_complete', function (UploadData) {\r\n        var metaHeaders = {};\r\n        util.each(params.Headers, function (val, k) {\r\n            var shortKey = k.toLowerCase();\r\n            if (shortKey.indexOf('x-cos-meta-') === 0 || shortKey === 'pic-operations') metaHeaders[k] = val;\r\n        });\r\n        uploadSliceComplete.call(self, {\r\n            Bucket: Bucket,\r\n            Region: Region,\r\n            Key: Key,\r\n            UploadId: UploadData.UploadId,\r\n            SliceList: UploadData.SliceList,\r\n            Headers: metaHeaders,\r\n        }, function (err, data) {\r\n            if (!self._isRunningTask(TaskId)) return;\r\n            session.removeUsing(UploadData.UploadId);\r\n            if (err) {\r\n                onProgress(null, true);\r\n                return ep.emit('error', err);\r\n            }\r\n            session.removeUploadId(UploadData.UploadId);\r\n            onProgress({loaded: FileSize, total: FileSize}, true);\r\n            ep.emit('upload_complete', data);\r\n        });\r\n    });\r\n\r\n    //  UploadId \r\n    ep.on('get_upload_data_finish', function (UploadData) {\r\n\r\n        //  UploadId \r\n        var uuid = session.getFileId(Body, params.ChunkSize, Bucket, Key);\r\n        uuid && session.saveUploadId(uuid, UploadData.UploadId, self.options.UploadIdCacheLimit); //  UploadId\r\n        session.setUsing(UploadData.UploadId); //  UploadId \r\n\r\n        //  UploadId\r\n        onProgress(null, true); //  uploading\r\n        uploadSliceList.call(self, {\r\n            TaskId: TaskId,\r\n            Bucket: Bucket,\r\n            Region: Region,\r\n            Key: Key,\r\n            Body: Body,\r\n            FileSize: FileSize,\r\n            SliceSize: ChunkSize,\r\n            AsyncLimit: AsyncLimit,\r\n            ServerSideEncryption: ServerSideEncryption,\r\n            UploadData: UploadData,\r\n            onProgress: onProgress\r\n        }, function (err, data) {\r\n            if (!self._isRunningTask(TaskId)) return;\r\n            if (err) {\r\n                onProgress(null, true);\r\n                return ep.emit('error', err);\r\n            }\r\n            ep.emit('upload_slice_complete', data);\r\n        });\r\n    });\r\n\r\n    //  UploadId ETag\r\n    ep.on('get_file_size_finish', function () {\r\n\r\n        onProgress = util.throttleOnProgress.call(self, FileSize, params.onProgress);\r\n\r\n        if (params.UploadData.UploadId) {\r\n            ep.emit('get_upload_data_finish', params.UploadData);\r\n        } else {\r\n            var _params = util.extend({\r\n                TaskId: TaskId,\r\n                Bucket: Bucket,\r\n                Region: Region,\r\n                Key: Key,\r\n                Headers: params.Headers,\r\n                StorageClass: StorageClass,\r\n                Body: Body,\r\n                FileSize: FileSize,\r\n                SliceSize: ChunkSize,\r\n                onHashProgress: onHashProgress,\r\n            }, params);\r\n            getUploadIdAndPartList.call(self, _params, function (err, UploadData) {\r\n                if (!self._isRunningTask(TaskId)) return;\r\n                if (err) return ep.emit('error', err);\r\n                params.UploadData.UploadId = UploadData.UploadId;\r\n                params.UploadData.PartList = UploadData.PartList;\r\n                ep.emit('get_upload_data_finish', params.UploadData);\r\n            });\r\n        }\r\n    });\r\n\r\n    // \r\n    FileSize = params.ContentLength;\r\n    delete params.ContentLength;\r\n    !params.Headers && (params.Headers = {});\r\n    util.each(params.Headers, function (item, key) {\r\n        if (key.toLowerCase() === 'content-length') {\r\n            delete params.Headers[key];\r\n        }\r\n    });\r\n\r\n    // \r\n    (function () {\r\n        var SIZE = [1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 1024 * 2, 1024 * 4, 1024 * 5];\r\n        var AutoChunkSize = 1024 * 1024;\r\n        for (var i = 0; i < SIZE.length; i++) {\r\n            AutoChunkSize = SIZE[i] * 1024 * 1024;\r\n            if (FileSize / AutoChunkSize <= self.options.MaxPartNumber) break;\r\n        }\r\n        params.ChunkSize = params.SliceSize = ChunkSize = Math.max(ChunkSize, AutoChunkSize);\r\n    })();\r\n\r\n    // \r\n    if (FileSize === 0) {\r\n        params.Body = '';\r\n        params.ContentLength = 0;\r\n        params.SkipTask = true;\r\n        self.putObject(params, function (err, data) {\r\n            if (err) {\r\n                return callback(err);\r\n            }\r\n            callback(null, data);\r\n        });\r\n    } else {\r\n        ep.emit('get_file_size_finish');\r\n    }\r\n\r\n}\r\n\r\n//  UploadId\r\nfunction getUploadIdAndPartList(params, callback) {\r\n    var TaskId = params.TaskId;\r\n    var Bucket = params.Bucket;\r\n    var Region = params.Region;\r\n    var Key = params.Key;\r\n    var StorageClass = params.StorageClass;\r\n    var self = this;\r\n\r\n    //  ETag\r\n    var ETagMap = {};\r\n    var FileSize = params.FileSize;\r\n    var SliceSize = params.SliceSize;\r\n    var SliceCount = Math.ceil(FileSize / SliceSize);\r\n    var FinishSliceCount = 0;\r\n    var FinishSize = 0;\r\n    var onHashProgress = util.throttleOnProgress.call(self, FileSize, params.onHashProgress);\r\n    var getChunkETag = function (PartNumber, callback) {\r\n        var start = SliceSize * (PartNumber - 1);\r\n        var end = Math.min(start + SliceSize, FileSize);\r\n        var ChunkSize = end - start;\r\n\r\n        if (ETagMap[PartNumber]) {\r\n            callback(null, {\r\n                PartNumber: PartNumber,\r\n                ETag: ETagMap[PartNumber],\r\n                Size: ChunkSize\r\n            });\r\n        } else {\r\n            util.fileSlice(params.Body, start, end, false, function (chunkItem) {\r\n                util.getFileMd5(chunkItem, function (err, md5) {\r\n                    if (err) return callback(err);\r\n                    var ETag = '\"' + md5 + '\"';\r\n                    ETagMap[PartNumber] = ETag;\r\n                    FinishSliceCount += 1;\r\n                    FinishSize += ChunkSize;\r\n                    callback(err, {\r\n                        PartNumber: PartNumber,\r\n                        ETag: ETag,\r\n                        Size: ChunkSize\r\n                    });\r\n                    onHashProgress({loaded: FinishSize, total: FileSize});\r\n                });\r\n            });\r\n        }\r\n    };\r\n\r\n    //  md5  UploadId \r\n    var isAvailableUploadList = function (PartList, callback) {\r\n        var PartCount = PartList.length;\r\n        // \r\n        if (PartCount === 0) {\r\n            return callback(null, true);\r\n        }\r\n        // \r\n        if (PartCount > SliceCount) {\r\n            return callback(null, false);\r\n        }\r\n        // \r\n        if (PartCount > 1) {\r\n            var PartSliceSize = Math.max(PartList[0].Size, PartList[1].Size);\r\n            if (PartSliceSize !== SliceSize) {\r\n                return callback(null, false);\r\n            }\r\n        }\r\n        //  ETag \r\n        var next = function (index) {\r\n            if (index < PartCount) {\r\n                var Part = PartList[index];\r\n                getChunkETag(Part.PartNumber, function (err, chunk) {\r\n                    if (chunk && chunk.ETag === Part.ETag && chunk.Size === Part.Size) {\r\n                        next(index + 1);\r\n                    } else {\r\n                        callback(null, false);\r\n                    }\r\n                });\r\n            } else {\r\n                callback(null, true);\r\n            }\r\n        };\r\n        next(0);\r\n    };\r\n\r\n    var ep = new EventProxy();\r\n    ep.on('error', function (errData) {\r\n        if (!self._isRunningTask(TaskId)) return;\r\n        return callback(errData);\r\n    });\r\n\r\n    //  UploadId\r\n    ep.on('upload_id_available', function (UploadData) {\r\n        //  map\r\n        var map = {};\r\n        var list = [];\r\n        util.each(UploadData.PartList, function (item) {\r\n            map[item.PartNumber] = item;\r\n        });\r\n        for (var PartNumber = 1; PartNumber <= SliceCount; PartNumber++) {\r\n            var item = map[PartNumber];\r\n            if (item) {\r\n                item.PartNumber = PartNumber;\r\n                item.Uploaded = true;\r\n            } else {\r\n                item = {\r\n                    PartNumber: PartNumber,\r\n                    ETag: null,\r\n                    Uploaded: false\r\n                };\r\n            }\r\n            list.push(item);\r\n        }\r\n        UploadData.PartList = list;\r\n        callback(null, UploadData);\r\n    });\r\n\r\n    //  UploadId,  UploadId\r\n    ep.on('no_available_upload_id', function () {\r\n        if (!self._isRunningTask(TaskId)) return;\r\n        var _params = util.extend({\r\n            Bucket: Bucket,\r\n            Region: Region,\r\n            Key: Key,\r\n            Headers: util.clone(params.Headers),\r\n            Query: util.clone(params.Query),\r\n            StorageClass: StorageClass,\r\n            Body: params.Body,\r\n        }, params);\r\n        self.multipartInit(_params, function (err, data) {\r\n            if (!self._isRunningTask(TaskId)) return;\r\n            if (err) return ep.emit('error', err);\r\n            var UploadId = data.UploadId;\r\n            if (!UploadId) {\r\n                return callback({Message: 'no upload id'});\r\n            }\r\n            ep.emit('upload_id_available', {UploadId: UploadId, PartList: []});\r\n        });\r\n    });\r\n\r\n    //  UploadId UploadId\r\n    ep.on('has_and_check_upload_id', function (UploadIdList) {\r\n        //  UploadId\r\n        UploadIdList = UploadIdList.reverse();\r\n        Async.eachLimit(UploadIdList, 1, function (UploadId, asyncCallback) {\r\n            if (!self._isRunningTask(TaskId)) return;\r\n            // \r\n            if (session.using[UploadId]) {\r\n                asyncCallback(); //  UploadId\r\n                return;\r\n            }\r\n            //  UploadId \r\n            wholeMultipartListPart.call(self, {\r\n                Bucket: Bucket,\r\n                Region: Region,\r\n                Key: Key,\r\n                UploadId: UploadId,\r\n            }, function (err, PartListData) {\r\n                if (!self._isRunningTask(TaskId)) return;\r\n                if (err) {\r\n                    session.removeUsing(UploadId);\r\n                    return ep.emit('error', err);\r\n                }\r\n                var PartList = PartListData.PartList;\r\n                PartList.forEach(function (item) {\r\n                    item.PartNumber *= 1;\r\n                    item.Size *= 1;\r\n                    item.ETag = item.ETag || '';\r\n                });\r\n                isAvailableUploadList(PartList, function (err, isAvailable) {\r\n                    if (!self._isRunningTask(TaskId)) return;\r\n                    if (err) return ep.emit('error', err);\r\n                    if (isAvailable) {\r\n                        asyncCallback({\r\n                            UploadId: UploadId,\r\n                            PartList: PartList\r\n                        }); // \r\n                    } else {\r\n                        asyncCallback(); //  UploadId\r\n                    }\r\n                });\r\n            });\r\n        }, function (AvailableUploadData) {\r\n            if (!self._isRunningTask(TaskId)) return;\r\n            onHashProgress(null, true);\r\n            if (AvailableUploadData && AvailableUploadData.UploadId) {\r\n                ep.emit('upload_id_available', AvailableUploadData);\r\n            } else {\r\n                ep.emit('no_available_upload_id');\r\n            }\r\n        });\r\n    });\r\n\r\n    //  UploadId\r\n    ep.on('seek_local_avail_upload_id', function (RemoteUploadIdList) {\r\n        //  UploadId\r\n        var uuid = session.getFileId(params.Body, params.ChunkSize, Bucket, Key);\r\n        var LocalUploadIdList = session.getUploadIdList(uuid);\r\n        if (!uuid || !LocalUploadIdList) {\r\n            ep.emit('has_and_check_upload_id', RemoteUploadIdList);\r\n            return;\r\n        }\r\n        var next = function (index) {\r\n            //  UploadId\r\n            if (index >= LocalUploadIdList.length) {\r\n                ep.emit('has_and_check_upload_id', RemoteUploadIdList);\r\n                return;\r\n            }\r\n            var UploadId = LocalUploadIdList[index];\r\n            //  UploadId \r\n            if (!util.isInArray(RemoteUploadIdList, UploadId)) {\r\n                session.removeUploadId(UploadId);\r\n                next(index + 1);\r\n                return;\r\n            }\r\n            // \r\n            if (session.using[UploadId]) {\r\n                next(index + 1);\r\n                return;\r\n            }\r\n            //  UploadId \r\n            wholeMultipartListPart.call(self, {\r\n                Bucket: Bucket,\r\n                Region: Region,\r\n                Key: Key,\r\n                UploadId: UploadId,\r\n            }, function (err, PartListData) {\r\n                if (!self._isRunningTask(TaskId)) return;\r\n                if (err) {\r\n                    //  UploadId \r\n                    session.removeUploadId(UploadId);\r\n                    next(index + 1);\r\n                } else {\r\n                    //  UploadId\r\n                    ep.emit('upload_id_available', {\r\n                        UploadId: UploadId,\r\n                        PartList: PartListData.PartList,\r\n                    });\r\n                }\r\n            });\r\n        };\r\n        next(0);\r\n    });\r\n\r\n    //  UploadId \r\n    ep.on('get_remote_upload_id_list', function () {\r\n        //  UploadId \r\n        wholeMultipartList.call(self, {\r\n            Bucket: Bucket,\r\n            Region: Region,\r\n            Key: Key,\r\n        }, function (err, data) {\r\n            if (!self._isRunningTask(TaskId)) return;\r\n            if (err) {\r\n                return ep.emit('error', err);\r\n            }\r\n            //  UploadId \r\n            var RemoteUploadIdList = util.filter(data.UploadList, function (item) {\r\n                return item.Key === Key && (!StorageClass || item.StorageClass.toUpperCase() === StorageClass.toUpperCase());\r\n            }).reverse().map(function (item) {\r\n                return item.UploadId || item.UploadID;\r\n            });\r\n            if (RemoteUploadIdList.length) {\r\n                ep.emit('seek_local_avail_upload_id', RemoteUploadIdList);\r\n            } else {\r\n                //  UploadId UploadId\r\n                var uuid = session.getFileId(params.Body, params.ChunkSize, Bucket, Key), LocalUploadIdList;\r\n                if (uuid && (LocalUploadIdList = session.getUploadIdList(uuid))) {\r\n                    util.each(LocalUploadIdList, function (UploadId) {\r\n                        session.removeUploadId(UploadId);\r\n                    });\r\n                }\r\n                ep.emit('no_available_upload_id');\r\n            }\r\n        });\r\n    });\r\n\r\n    //  UploadId\r\n    ep.emit('get_remote_upload_id_list');\r\n\r\n}\r\n\r\n//  ( Bucket, Region, Prefix)\r\nfunction wholeMultipartList(params, callback) {\r\n    var self = this;\r\n    var UploadList = [];\r\n    var sendParams = {\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        Prefix: params.Key\r\n    };\r\n    var next = function () {\r\n        self.multipartList(sendParams, function (err, data) {\r\n            if (err) return callback(err);\r\n            UploadList.push.apply(UploadList, data.Upload || []);\r\n            if (data.IsTruncated === 'true') { // \r\n                sendParams.KeyMarker = data.NextKeyMarker;\r\n                sendParams.UploadIdMarker = data.NextUploadIdMarker;\r\n                next();\r\n            } else {\r\n                callback(null, {UploadList: UploadList});\r\n            }\r\n        });\r\n    };\r\n    next();\r\n}\r\n\r\n// \r\nfunction wholeMultipartListPart(params, callback) {\r\n    var self = this;\r\n    var PartList = [];\r\n    var sendParams = {\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        Key: params.Key,\r\n        UploadId: params.UploadId\r\n    };\r\n    var next = function () {\r\n        self.multipartListPart(sendParams, function (err, data) {\r\n            if (err) return callback(err);\r\n            PartList.push.apply(PartList, data.Part || []);\r\n            if (data.IsTruncated === 'true') { // \r\n                sendParams.PartNumberMarker = data.NextPartNumberMarker;\r\n                next();\r\n            } else {\r\n                callback(null, {PartList: PartList});\r\n            }\r\n        });\r\n    };\r\n    next();\r\n}\r\n\r\n// \r\n/*\r\n UploadId ()\r\n AsyncLimit ()\r\n SliceList ()\r\n FilePath ()\r\n SliceSize ()\r\n FileSize ()\r\n onProgress ()\r\n */\r\nfunction uploadSliceList(params, cb) {\r\n    var self = this;\r\n    var TaskId = params.TaskId;\r\n    var Bucket = params.Bucket;\r\n    var Region = params.Region;\r\n    var Key = params.Key;\r\n    var UploadData = params.UploadData;\r\n    var FileSize = params.FileSize;\r\n    var SliceSize = params.SliceSize;\r\n    var ChunkParallel = Math.min(params.AsyncLimit || self.options.ChunkParallelLimit || 1, 256);\r\n    var Body = params.Body;\r\n    var SliceCount = Math.ceil(FileSize / SliceSize);\r\n    var FinishSize = 0;\r\n    var ServerSideEncryption = params.ServerSideEncryption;\r\n    var needUploadSlices = util.filter(UploadData.PartList, function (SliceItem) {\r\n        if (SliceItem['Uploaded']) {\r\n            FinishSize += SliceItem['PartNumber'] >= SliceCount ? (FileSize % SliceSize || SliceSize) : SliceSize;\r\n        }\r\n        return !SliceItem['Uploaded'];\r\n    });\r\n    var onProgress = params.onProgress;\r\n\r\n    Async.eachLimit(needUploadSlices, ChunkParallel, function (SliceItem, asyncCallback) {\r\n        if (!self._isRunningTask(TaskId)) return;\r\n        var PartNumber = SliceItem['PartNumber'];\r\n        var currentSize = Math.min(FileSize, SliceItem['PartNumber'] * SliceSize) - (SliceItem['PartNumber'] - 1) * SliceSize;\r\n        var preAddSize = 0;\r\n        uploadSliceItem.call(self, {\r\n            TaskId: TaskId,\r\n            Bucket: Bucket,\r\n            Region: Region,\r\n            Key: Key,\r\n            SliceSize: SliceSize,\r\n            FileSize: FileSize,\r\n            PartNumber: PartNumber,\r\n            ServerSideEncryption: ServerSideEncryption,\r\n            Body: Body,\r\n            UploadData: UploadData,\r\n            onProgress: function (data) {\r\n                FinishSize += data.loaded - preAddSize;\r\n                preAddSize = data.loaded;\r\n                onProgress({loaded: FinishSize, total: FileSize});\r\n            },\r\n        }, function (err, data) {\r\n            if (!self._isRunningTask(TaskId)) return;\r\n            if (!err && !data.ETag) {\r\n                err = 'get ETag error, please add \"ETag\" to CORS ExposeHeader setting.';\r\n            }\r\n            if (err) {\r\n                FinishSize -= preAddSize;\r\n            } else {\r\n                FinishSize += currentSize - preAddSize;\r\n                SliceItem.ETag = data.ETag;\r\n            }\r\n            onProgress({loaded: FinishSize, total: FileSize});\r\n            asyncCallback(err || null, data);\r\n        });\r\n    }, function (err) {\r\n        if (!self._isRunningTask(TaskId)) return;\r\n        if (err) return cb(err);\r\n        cb(null, {\r\n            UploadId: UploadData.UploadId,\r\n            SliceList: UploadData.PartList\r\n        });\r\n    });\r\n}\r\n\r\n// \r\nfunction uploadSliceItem(params, callback) {\r\n    var self = this;\r\n    var TaskId = params.TaskId;\r\n    var Bucket = params.Bucket;\r\n    var Region = params.Region;\r\n    var Key = params.Key;\r\n    var FileSize = params.FileSize;\r\n    var FileBody = params.Body;\r\n    var PartNumber = params.PartNumber * 1;\r\n    var SliceSize = params.SliceSize;\r\n    var ServerSideEncryption = params.ServerSideEncryption;\r\n    var UploadData = params.UploadData;\r\n    var ChunkRetryTimes = self.options.ChunkRetryTimes + 1;\r\n\r\n    var start = SliceSize * (PartNumber - 1);\r\n\r\n    var ContentLength = SliceSize;\r\n\r\n    var end = start + SliceSize;\r\n\r\n    if (end > FileSize) {\r\n        end = FileSize;\r\n        ContentLength = end - start;\r\n    }\r\n\r\n    var PartItem = UploadData.PartList[PartNumber - 1];\r\n    Async.retry(ChunkRetryTimes, function (tryCallback) {\r\n        if (!self._isRunningTask(TaskId)) return;\r\n        util.fileSlice(FileBody, start, end, true, function (Body) {\r\n            self.multipartUpload({\r\n                TaskId: TaskId,\r\n                Bucket: Bucket,\r\n                Region: Region,\r\n                Key: Key,\r\n                ContentLength: ContentLength,\r\n                PartNumber: PartNumber,\r\n                UploadId: UploadData.UploadId,\r\n                ServerSideEncryption: ServerSideEncryption,\r\n                Body: Body,\r\n                onProgress: params.onProgress,\r\n            }, function (err, data) {\r\n                if (!self._isRunningTask(TaskId)) return;\r\n                if (err) {\r\n                    return tryCallback(err);\r\n                } else {\r\n                    PartItem.Uploaded = true;\r\n                    return tryCallback(null, data);\r\n                }\r\n            });\r\n        });\r\n    }, function (err, data) {\r\n        if (!self._isRunningTask(TaskId)) return;\r\n        return callback(err, data);\r\n    });\r\n}\r\n\r\n\r\n// \r\nfunction uploadSliceComplete(params, callback) {\r\n    var Bucket = params.Bucket;\r\n    var Region = params.Region;\r\n    var Key = params.Key;\r\n    var UploadId = params.UploadId;\r\n    var SliceList = params.SliceList;\r\n    var self = this;\r\n    var ChunkRetryTimes = this.options.ChunkRetryTimes + 1;\r\n    var Headers = params.Headers;\r\n    var Parts = SliceList.map(function (item) {\r\n        return {\r\n            PartNumber: item.PartNumber,\r\n            ETag: item.ETag\r\n        };\r\n    });\r\n    // \r\n    Async.retry(ChunkRetryTimes, function (tryCallback) {\r\n        self.multipartComplete({\r\n            Bucket: Bucket,\r\n            Region: Region,\r\n            Key: Key,\r\n            UploadId: UploadId,\r\n            Parts: Parts,\r\n            Headers: Headers,\r\n        }, tryCallback);\r\n    }, function (err, data) {\r\n        callback(err, data);\r\n    });\r\n}\r\n\r\n// \r\n/*\r\n AsyncLimit ()\r\n UploadId ( Level  task )\r\n Level (task : file   Bucket )\r\n */\r\nfunction abortUploadTask(params, callback) {\r\n    var Bucket = params.Bucket;\r\n    var Region = params.Region;\r\n    var Key = params.Key;\r\n    var UploadId = params.UploadId;\r\n    var Level = params.Level || 'task';\r\n    var AsyncLimit = params.AsyncLimit;\r\n    var self = this;\r\n\r\n    var ep = new EventProxy();\r\n\r\n    ep.on('error', function (errData) {\r\n        return callback(errData);\r\n    });\r\n\r\n    // \r\n    ep.on('get_abort_array', function (AbortArray) {\r\n        abortUploadTaskArray.call(self, {\r\n            Bucket: Bucket,\r\n            Region: Region,\r\n            Key: Key,\r\n            Headers: params.Headers,\r\n            AsyncLimit: AsyncLimit,\r\n            AbortArray: AbortArray\r\n        }, function (err, data) {\r\n            if (err) {\r\n                return callback(err);\r\n            }\r\n            callback(null, data);\r\n        });\r\n    });\r\n\r\n    if (Level === 'bucket') {\r\n        // Bucket  Bucket \r\n        wholeMultipartList.call(self, {\r\n            Bucket: Bucket,\r\n            Region: Region\r\n        }, function (err, data) {\r\n            if (err) {\r\n                return callback(err);\r\n            }\r\n            ep.emit('get_abort_array', data.UploadList || []);\r\n        });\r\n    } else if (Level === 'file') {\r\n        // \r\n        if (!Key) return callback({error: 'abort_upload_task_no_key'});\r\n        wholeMultipartList.call(self, {\r\n            Bucket: Bucket,\r\n            Region: Region,\r\n            Key: Key\r\n        }, function (err, data) {\r\n            if (err) {\r\n                return callback(err);\r\n            }\r\n            ep.emit('get_abort_array', data.UploadList || []);\r\n        });\r\n    } else if (Level === 'task') {\r\n        //  UploadId \r\n        if (!UploadId) return callback({error: 'abort_upload_task_no_id'});\r\n        if (!Key) return callback({error: 'abort_upload_task_no_key'});\r\n        ep.emit('get_abort_array', [{\r\n            Key: Key,\r\n            UploadId: UploadId\r\n        }]);\r\n    } else {\r\n        return callback({error: 'abort_unknown_level'});\r\n    }\r\n}\r\n\r\n// \r\nfunction abortUploadTaskArray(params, callback) {\r\n\r\n    var Bucket = params.Bucket;\r\n    var Region = params.Region;\r\n    var Key = params.Key;\r\n    var AbortArray = params.AbortArray;\r\n    var AsyncLimit = params.AsyncLimit || 1;\r\n    var self = this;\r\n\r\n    var index = 0;\r\n    var resultList = new Array(AbortArray.length);\r\n    Async.eachLimit(AbortArray, AsyncLimit, function (AbortItem, callback) {\r\n        var eachIndex = index;\r\n        if (Key && Key !== AbortItem.Key) {\r\n            resultList[eachIndex] = {error: {KeyNotMatch: true}};\r\n            callback(null);\r\n            return;\r\n        }\r\n        var UploadId = AbortItem.UploadId || AbortItem.UploadID;\r\n\r\n        self.multipartAbort({\r\n            Bucket: Bucket,\r\n            Region: Region,\r\n            Key: AbortItem.Key,\r\n            Headers: params.Headers,\r\n            UploadId: UploadId\r\n        }, function (err) {\r\n            var task = {\r\n                Bucket: Bucket,\r\n                Region: Region,\r\n                Key: AbortItem.Key,\r\n                UploadId: UploadId\r\n            };\r\n            resultList[eachIndex] = {error: err, task: task};\r\n            callback(null);\r\n        });\r\n        index++;\r\n\r\n    }, function (err) {\r\n        if (err) {\r\n            return callback(err);\r\n        }\r\n\r\n        var successList = [];\r\n        var errorList = [];\r\n\r\n        for (var i = 0, len = resultList.length; i < len; i++) {\r\n            var item = resultList[i];\r\n            if (item['task']) {\r\n                if (item['error']) {\r\n                    errorList.push(item['task']);\r\n                } else {\r\n                    successList.push(item['task']);\r\n                }\r\n            }\r\n        }\r\n\r\n        return callback(null, {\r\n            successList: successList,\r\n            errorList: errorList\r\n        });\r\n    });\r\n}\r\n\r\n\r\n// \r\nfunction uploadFiles(params, callback) {\r\n    var self = this;\r\n\r\n    // \r\n    var SliceSize = params.SliceSize === undefined ? self.options.SliceSize : params.SliceSize;\r\n\r\n    // \r\n    var TotalSize = 0;\r\n    var TotalFinish = 0;\r\n    var onTotalProgress = util.throttleOnProgress.call(self, TotalFinish, params.onProgress);\r\n\r\n    // \r\n    var unFinishCount = params.files.length;\r\n    var _onTotalFileFinish = params.onFileFinish;\r\n    var resultList = Array(unFinishCount);\r\n    var onTotalFileFinish = function (err, data, options) {\r\n        onTotalProgress(null, true);\r\n        _onTotalFileFinish && _onTotalFileFinish(err, data, options);\r\n        resultList[options.Index] = {\r\n            options: options,\r\n            error: err,\r\n            data: data\r\n        };\r\n        if (--unFinishCount <= 0 && callback) {\r\n            callback(null, {\r\n                files: resultList,\r\n            });\r\n        }\r\n    };\r\n\r\n    // \r\n    var taskList = [];\r\n    util.each(params.files, function (fileParams, index) {\r\n        (function () { //  nodejs \r\n\r\n            var Body = fileParams.Body;\r\n            var FileSize = Body.size || Body.length || 0;\r\n            var fileInfo = {Index: index, TaskId: ''};\r\n\r\n            // \r\n            TotalSize += FileSize;\r\n\r\n            //  option\r\n            util.each(fileParams, function (v, k) {\r\n                if (typeof v !== 'object' && typeof v !== 'function') {\r\n                    fileInfo[k] = v;\r\n                }\r\n            });\r\n\r\n            //  TaskReady\r\n            var _onTaskReady = fileParams.onTaskReady;\r\n            var onTaskReady = function (tid) {\r\n                fileInfo.TaskId = tid;\r\n                _onTaskReady && _onTaskReady(tid);\r\n            };\r\n            fileParams.onTaskReady = onTaskReady;\r\n\r\n            // \r\n            var PreAddSize = 0;\r\n            var _onProgress = fileParams.onProgress;\r\n            var onProgress = function (info) {\r\n                TotalFinish = TotalFinish - PreAddSize + info.loaded;\r\n                PreAddSize = info.loaded;\r\n                _onProgress && _onProgress(info);\r\n                onTotalProgress({loaded: TotalFinish, total: TotalSize});\r\n            };\r\n            fileParams.onProgress = onProgress;\r\n\r\n            // \r\n            var _onFileFinish = fileParams.onFileFinish;\r\n            var onFileFinish = function (err, data) {\r\n                _onFileFinish && _onFileFinish(err, data);\r\n                onTotalFileFinish && onTotalFileFinish(err, data, fileInfo);\r\n            };\r\n\r\n            // \r\n            var api = FileSize >= SliceSize ? 'sliceUploadFile' : 'putObject';\r\n            taskList.push({\r\n                api: api,\r\n                params: fileParams,\r\n                callback: onFileFinish,\r\n            });\r\n        })();\r\n    });\r\n    self._addTasks(taskList);\r\n}\r\n\r\n// \r\nfunction sliceCopyFile(params, callback) {\r\n    var ep = new EventProxy();\r\n\r\n    var self = this;\r\n    var Bucket = params.Bucket;\r\n    var Region = params.Region;\r\n    var Key = params.Key;\r\n    var CopySource = params.CopySource;\r\n    var m = CopySource.match(/^([^.]+-\\d+)\\.cos(v6)?\\.([^.]+)\\.[^/]+\\/(.+)$/);\r\n    if (!m) {\r\n        callback({error: 'CopySource format error'});\r\n        return;\r\n    }\r\n\r\n    var SourceBucket = m[1];\r\n    var SourceRegion = m[3];\r\n    var SourceKey = decodeURIComponent(m[4]);\r\n    var CopySliceSize = params.CopySliceSize === undefined ? self.options.CopySliceSize : params.CopySliceSize;\r\n    CopySliceSize = Math.max(0, CopySliceSize);\r\n\r\n    var ChunkSize = params.CopyChunkSize || this.options.CopyChunkSize;\r\n    var ChunkParallel = this.options.CopyChunkParallelLimit;\r\n\r\n    var FinishSize = 0;\r\n    var FileSize;\r\n    var onProgress;\r\n\r\n    //  multipartComplete \r\n    ep.on('copy_slice_complete', function (UploadData) {var metaHeaders = {};\r\n        util.each(params.Headers, function (val, k) {\r\n            if (k.toLowerCase().indexOf('x-cos-meta-') === 0) metaHeaders[k] = val;\r\n        });\r\n        self.multipartComplete({\r\n            Bucket: Bucket,\r\n            Region: Region,\r\n            Key: Key,\r\n            UploadId: UploadData.UploadId,\r\n            Parts: UploadData.PartList,\r\n        },function (err, data) {\r\n            if (err) {\r\n                onProgress(null, true);\r\n                return callback(err);\r\n            }\r\n            onProgress({loaded: FileSize, total: FileSize}, true);\r\n            callback(null, data);\r\n        });\r\n    });\r\n\r\n    ep.on('get_copy_data_finish',function (UploadData) {\r\n        Async.eachLimit(UploadData.PartList, ChunkParallel, function (SliceItem, asyncCallback) {\r\n            var PartNumber = SliceItem.PartNumber;\r\n            var CopySourceRange = SliceItem.CopySourceRange;\r\n            var currentSize = SliceItem.end - SliceItem.start;\r\n            var preAddSize = 0;\r\n\r\n            copySliceItem.call(self, {\r\n                Bucket: Bucket,\r\n                Region: Region,\r\n                Key: Key,\r\n                CopySource: CopySource,\r\n                UploadId: UploadData.UploadId,\r\n                PartNumber: PartNumber,\r\n                CopySourceRange: CopySourceRange,\r\n                onProgress: function (data) {\r\n                    FinishSize += data.loaded - preAddSize;\r\n                    preAddSize = data.loaded;\r\n                    onProgress({loaded: FinishSize, total: FileSize});\r\n                }\r\n            },function (err,data) {\r\n                if (err) {\r\n                    return asyncCallback(err);\r\n                }\r\n                onProgress({loaded: FinishSize, total: FileSize});\r\n\r\n                FinishSize += currentSize - preAddSize;\r\n                SliceItem.ETag = data.ETag;\r\n                asyncCallback(err || null, data);\r\n            });\r\n        }, function (err) {\r\n            if (err) {\r\n                onProgress(null, true);\r\n                return callback(err);\r\n            }\r\n\r\n            ep.emit('copy_slice_complete', UploadData);\r\n        });\r\n    });\r\n\r\n    ep.on('get_file_size_finish', function (SourceHeaders) {\r\n        // \r\n        (function () {\r\n            var SIZE = [1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 1024 * 2, 1024 * 4, 1024 * 5];\r\n            var AutoChunkSize = 1024 * 1024;\r\n            for (var i = 0; i < SIZE.length; i++) {\r\n                AutoChunkSize = SIZE[i] * 1024 * 1024;\r\n                if (FileSize / AutoChunkSize <= self.options.MaxPartNumber) break;\r\n            }\r\n            params.ChunkSize = ChunkSize = Math.max(ChunkSize, AutoChunkSize);\r\n\r\n            var ChunkCount = Math.ceil(FileSize / ChunkSize);\r\n\r\n            var list = [];\r\n            for (var partNumber = 1; partNumber <= ChunkCount; partNumber++) {\r\n                var start = (partNumber - 1) * ChunkSize;\r\n                var end = partNumber * ChunkSize < FileSize ? (partNumber * ChunkSize - 1) : FileSize - 1;\r\n                var item = {\r\n                    PartNumber: partNumber,\r\n                    start: start,\r\n                    end: end,\r\n                    CopySourceRange: \"bytes=\" + start + \"-\" + end,\r\n                };\r\n                list.push(item);\r\n            }\r\n            params.PartList = list;\r\n        })();\r\n\r\n        var TargetHeader;\r\n        if (params.Headers['x-cos-metadata-directive'] === 'Replaced') {\r\n            TargetHeader = params.Headers;\r\n        } else {\r\n            TargetHeader = SourceHeaders;\r\n        }\r\n        TargetHeader['x-cos-storage-class'] = params.Headers['x-cos-storage-class'] || SourceHeaders['x-cos-storage-class'];\r\n        TargetHeader = util.clearKey(TargetHeader);\r\n        /**\r\n         *  Copy\r\n         */\r\n        if (SourceHeaders['x-cos-storage-class'] === 'ARCHIVE' || SourceHeaders['x-cos-storage-class'] === 'DEEP_ARCHIVE') {\r\n            var restoreHeader = SourceHeaders['x-cos-restore'];\r\n            if (!restoreHeader || restoreHeader === 'ongoing-request=\"true\"') {\r\n                callback({ error: 'Unrestored archive object is not allowed to be copied' });\r\n                return;\r\n            }\r\n        }\r\n        /**\r\n         *  multipartInit \r\n         *  putObjectCopy \r\n         */\r\n        delete TargetHeader['x-cos-copy-source'];\r\n        delete TargetHeader['x-cos-metadata-directive'];\r\n        delete TargetHeader['x-cos-copy-source-If-Modified-Since'];\r\n        delete TargetHeader['x-cos-copy-source-If-Unmodified-Since'];\r\n        delete TargetHeader['x-cos-copy-source-If-Match'];\r\n        delete TargetHeader['x-cos-copy-source-If-None-Match'];\r\n        self.multipartInit({\r\n            Bucket: Bucket,\r\n            Region: Region,\r\n            Key: Key,\r\n            Headers: TargetHeader,\r\n        },function (err,data) {\r\n            if (err) {\r\n                return callback(err);\r\n            }\r\n            params.UploadId = data.UploadId;\r\n            ep.emit('get_copy_data_finish', params);\r\n        });\r\n    });\r\n\r\n    // \r\n    self.headObject({\r\n        Bucket: SourceBucket,\r\n        Region: SourceRegion,\r\n        Key: SourceKey,\r\n    },function(err, data) {\r\n        if (err) {\r\n            if (err.statusCode && err.statusCode === 404) {\r\n                callback({ErrorStatus: SourceKey + ' Not Exist'});\r\n            } else {\r\n                callback(err);\r\n            }\r\n            return;\r\n        }\r\n\r\n        FileSize = params.FileSize = data.headers['content-length'];\r\n        if (FileSize === undefined || !FileSize) {\r\n            callback({error: 'get Content-Length error, please add \"Content-Length\" to CORS ExposeHeader setting.'});\r\n            return;\r\n        }\r\n\r\n        onProgress = util.throttleOnProgress.call(self, FileSize, params.onProgress);\r\n\r\n        // \r\n        if (FileSize <= CopySliceSize) {\r\n            if (!params.Headers['x-cos-metadata-directive']) {\r\n                params.Headers['x-cos-metadata-directive'] = 'Copy';\r\n            }\r\n            self.putObjectCopy(params, function (err, data) {\r\n                if (err) {\r\n                    onProgress(null, true);\r\n                    return callback(err);\r\n                }\r\n                onProgress({loaded: FileSize, total: FileSize}, true);\r\n                callback(err, data);\r\n            });\r\n        } else {\r\n            var resHeaders = data.headers;\r\n            var SourceHeaders = {\r\n                'Cache-Control': resHeaders['cache-control'],\r\n                'Content-Disposition': resHeaders['content-disposition'],\r\n                'Content-Encoding': resHeaders['content-encoding'],\r\n                'Content-Type': resHeaders['content-type'],\r\n                'Expires': resHeaders['expires'],\r\n                'x-cos-storage-class': resHeaders['x-cos-storage-class'],\r\n            };\r\n            util.each(resHeaders, function (v, k) {\r\n                var metaPrefix = 'x-cos-meta-';\r\n                if (k.indexOf(metaPrefix) === 0 && k.length > metaPrefix.length) {\r\n                    SourceHeaders[k] = v;\r\n                }\r\n            });\r\n            ep.emit('get_file_size_finish', SourceHeaders);\r\n        }\r\n    });\r\n}\r\n\r\n// \r\nfunction copySliceItem(params, callback) {\r\n    var TaskId = params.TaskId;\r\n    var Bucket = params.Bucket;\r\n    var Region = params.Region;\r\n    var Key = params.Key;\r\n    var CopySource = params.CopySource;\r\n    var UploadId = params.UploadId;\r\n    var PartNumber = params.PartNumber * 1;\r\n    var CopySourceRange = params.CopySourceRange;\r\n\r\n    var ChunkRetryTimes = this.options.ChunkRetryTimes + 1;\r\n    var self = this;\r\n\r\n    Async.retry(ChunkRetryTimes, function (tryCallback) {\r\n        self.uploadPartCopy({\r\n            TaskId: TaskId,\r\n            Bucket: Bucket,\r\n            Region: Region,\r\n            Key: Key,\r\n            CopySource: CopySource,\r\n            UploadId: UploadId,\r\n            PartNumber:PartNumber,\r\n            CopySourceRange:CopySourceRange,\r\n            onProgress:params.onProgress,\r\n        },function (err,data) {\r\n            tryCallback(err || null, data);\r\n        })\r\n    }, function (err, data) {\r\n        return callback(err, data);\r\n    });\r\n}\r\n\r\n\r\nvar API_MAP = {\r\n    sliceUploadFile: sliceUploadFile,\r\n    abortUploadTask: abortUploadTask,\r\n    uploadFiles: uploadFiles,\r\n    sliceCopyFile: sliceCopyFile,\r\n};\r\n\r\nmodule.exports.init = function (COS, task) {\r\n    task.transferToTaskMethod(API_MAP, 'sliceUploadFile');\r\n    util.each(API_MAP, function (fn, apiName) {\r\n        COS.prototype[apiName] = util.apiWrapper(apiName, fn);\r\n    });\r\n};\r\n","function DOMParser(options){\r\n\tthis.options = options ||{locator:{}};\r\n\t\r\n}\r\nDOMParser.prototype.parseFromString = function(source,mimeType){\r\n\tvar options = this.options;\r\n\tvar sax =  new XMLReader();\r\n\tvar domBuilder = options.domBuilder || new DOMHandler();//contentHandler and LexicalHandler\r\n\tvar errorHandler = options.errorHandler;\r\n\tvar locator = options.locator;\r\n\tvar defaultNSMap = options.xmlns||{};\r\n\tvar entityMap = {'lt':'<','gt':'>','amp':'&','quot':'\"','apos':\"'\"}\r\n\tif(locator){\r\n\t\tdomBuilder.setDocumentLocator(locator)\r\n\t}\r\n\t\r\n\tsax.errorHandler = buildErrorHandler(errorHandler,domBuilder,locator);\r\n\tsax.domBuilder = options.domBuilder || domBuilder;\r\n\tif(/\\/x?html?$/.test(mimeType)){\r\n\t\tentityMap.nbsp = '\\xa0';\r\n\t\tentityMap.copy = '\\xa9';\r\n\t\tdefaultNSMap['']= 'http://www.w3.org/1999/xhtml';\r\n\t}\r\n\tdefaultNSMap.xml = defaultNSMap.xml || 'http://www.w3.org/XML/1998/namespace';\r\n\tif(source){\r\n\t\tsax.parse(source,defaultNSMap,entityMap);\r\n\t}else{\r\n\t\tsax.errorHandler.error(\"invalid doc source\");\r\n\t}\r\n\treturn domBuilder.doc;\r\n}\r\nfunction buildErrorHandler(errorImpl,domBuilder,locator){\r\n\tif(!errorImpl){\r\n\t\tif(domBuilder instanceof DOMHandler){\r\n\t\t\treturn domBuilder;\r\n\t\t}\r\n\t\terrorImpl = domBuilder ;\r\n\t}\r\n\tvar errorHandler = {}\r\n\tvar isCallback = errorImpl instanceof Function;\r\n\tlocator = locator||{}\r\n\tfunction build(key){\r\n\t\tvar fn = errorImpl[key];\r\n\t\tif(!fn && isCallback){\r\n\t\t\tfn = errorImpl.length == 2?function(msg){errorImpl(key,msg)}:errorImpl;\r\n\t\t}\r\n\t\terrorHandler[key] = fn && function(msg){\r\n\t\t\tfn('[xmldom '+key+']\\t'+msg+_locator(locator));\r\n\t\t}||function(){};\r\n\t}\r\n\tbuild('warning');\r\n\tbuild('error');\r\n\tbuild('fatalError');\r\n\treturn errorHandler;\r\n}\r\n\r\n//console.log('#\\n\\n\\n\\n\\n\\n\\n####')\r\n/**\r\n * +ContentHandler+ErrorHandler\r\n * +LexicalHandler+EntityResolver2\r\n * -DeclHandler-DTDHandler \r\n * \r\n * DefaultHandler:EntityResolver, DTDHandler, ContentHandler, ErrorHandler\r\n * DefaultHandler2:DefaultHandler,LexicalHandler, DeclHandler, EntityResolver2\r\n * @link http://www.saxproject.org/apidoc/org/xml/sax/helpers/DefaultHandler.html\r\n */\r\nfunction DOMHandler() {\r\n    this.cdata = false;\r\n}\r\nfunction position(locator,node){\r\n\tnode.lineNumber = locator.lineNumber;\r\n\tnode.columnNumber = locator.columnNumber;\r\n}\r\n/**\r\n * @see org.xml.sax.ContentHandler#startDocument\r\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ContentHandler.html\r\n */ \r\nDOMHandler.prototype = {\r\n\tstartDocument : function() {\r\n    \tthis.doc = new DOMImplementation().createDocument(null, null, null);\r\n    \tif (this.locator) {\r\n        \tthis.doc.documentURI = this.locator.systemId;\r\n    \t}\r\n\t},\r\n\tstartElement:function(namespaceURI, localName, qName, attrs) {\r\n\t\tvar doc = this.doc;\r\n\t    var el = doc.createElementNS(namespaceURI, qName||localName);\r\n\t    var len = attrs.length;\r\n\t    appendElement(this, el);\r\n\t    this.currentElement = el;\r\n\t    \r\n\t\tthis.locator && position(this.locator,el)\r\n\t    for (var i = 0 ; i < len; i++) {\r\n\t        var namespaceURI = attrs.getURI(i);\r\n\t        var value = attrs.getValue(i);\r\n\t        var qName = attrs.getQName(i);\r\n\t\t\tvar attr = doc.createAttributeNS(namespaceURI, qName);\r\n\t\t\tthis.locator &&position(attrs.getLocator(i),attr);\r\n\t\t\tattr.value = attr.nodeValue = value;\r\n\t\t\tel.setAttributeNode(attr)\r\n\t    }\r\n\t},\r\n\tendElement:function(namespaceURI, localName, qName) {\r\n\t\tvar current = this.currentElement\r\n\t\tvar tagName = current.tagName;\r\n\t\tthis.currentElement = current.parentNode;\r\n\t},\r\n\tstartPrefixMapping:function(prefix, uri) {\r\n\t},\r\n\tendPrefixMapping:function(prefix) {\r\n\t},\r\n\tprocessingInstruction:function(target, data) {\r\n\t    var ins = this.doc.createProcessingInstruction(target, data);\r\n\t    this.locator && position(this.locator,ins)\r\n\t    appendElement(this, ins);\r\n\t},\r\n\tignorableWhitespace:function(ch, start, length) {\r\n\t},\r\n\tcharacters:function(chars, start, length) {\r\n\t\tchars = _toString.apply(this,arguments)\r\n\t\t//console.log(chars)\r\n\t\tif(chars){\r\n\t\t\tif (this.cdata) {\r\n\t\t\t\tvar charNode = this.doc.createCDATASection(chars);\r\n\t\t\t} else {\r\n\t\t\t\tvar charNode = this.doc.createTextNode(chars);\r\n\t\t\t}\r\n\t\t\tif(this.currentElement){\r\n\t\t\t\tthis.currentElement.appendChild(charNode);\r\n\t\t\t}else if(/^\\s*$/.test(chars)){\r\n\t\t\t\tthis.doc.appendChild(charNode);\r\n\t\t\t\t//process xml\r\n\t\t\t}\r\n\t\t\tthis.locator && position(this.locator,charNode)\r\n\t\t}\r\n\t},\r\n\tskippedEntity:function(name) {\r\n\t},\r\n\tendDocument:function() {\r\n\t\tthis.doc.normalize();\r\n\t},\r\n\tsetDocumentLocator:function (locator) {\r\n\t    if(this.locator = locator){// && !('lineNumber' in locator)){\r\n\t    \tlocator.lineNumber = 0;\r\n\t    }\r\n\t},\r\n\t//LexicalHandler\r\n\tcomment:function(chars, start, length) {\r\n\t\tchars = _toString.apply(this,arguments)\r\n\t    var comm = this.doc.createComment(chars);\r\n\t    this.locator && position(this.locator,comm)\r\n\t    appendElement(this, comm);\r\n\t},\r\n\t\r\n\tstartCDATA:function() {\r\n\t    //used in characters() methods\r\n\t    this.cdata = true;\r\n\t},\r\n\tendCDATA:function() {\r\n\t    this.cdata = false;\r\n\t},\r\n\t\r\n\tstartDTD:function(name, publicId, systemId) {\r\n\t\tvar impl = this.doc.implementation;\r\n\t    if (impl && impl.createDocumentType) {\r\n\t        var dt = impl.createDocumentType(name, publicId, systemId);\r\n\t        this.locator && position(this.locator,dt)\r\n\t        appendElement(this, dt);\r\n\t    }\r\n\t},\r\n\t/**\r\n\t * @see org.xml.sax.ErrorHandler\r\n\t * @link http://www.saxproject.org/apidoc/org/xml/sax/ErrorHandler.html\r\n\t */\r\n\twarning:function(error) {\r\n\t\tconsole.warn('[xmldom warning]\\t'+error,_locator(this.locator));\r\n\t},\r\n\terror:function(error) {\r\n\t\tconsole.error('[xmldom error]\\t'+error,_locator(this.locator));\r\n\t},\r\n\tfatalError:function(error) {\r\n\t\tconsole.error('[xmldom fatalError]\\t'+error,_locator(this.locator));\r\n\t    throw error;\r\n\t}\r\n}\r\nfunction _locator(l){\r\n\tif(l){\r\n\t\treturn '\\n@'+(l.systemId ||'')+'#[line:'+l.lineNumber+',col:'+l.columnNumber+']'\r\n\t}\r\n}\r\nfunction _toString(chars,start,length){\r\n\tif(typeof chars == 'string'){\r\n\t\treturn chars.substr(start,length)\r\n\t}else{//java sax connect width xmldom on rhino(what about: \"? && !(chars instanceof String)\")\r\n\t\tif(chars.length >= start+length || start){\r\n\t\t\treturn new java.lang.String(chars,start,length)+'';\r\n\t\t}\r\n\t\treturn chars;\r\n\t}\r\n}\r\n\r\n/*\r\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/LexicalHandler.html\r\n * used method of org.xml.sax.ext.LexicalHandler:\r\n *  #comment(chars, start, length)\r\n *  #startCDATA()\r\n *  #endCDATA()\r\n *  #startDTD(name, publicId, systemId)\r\n *\r\n *\r\n * IGNORED method of org.xml.sax.ext.LexicalHandler:\r\n *  #endDTD()\r\n *  #startEntity(name)\r\n *  #endEntity(name)\r\n *\r\n *\r\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/DeclHandler.html\r\n * IGNORED method of org.xml.sax.ext.DeclHandler\r\n * \t#attributeDecl(eName, aName, type, mode, value)\r\n *  #elementDecl(name, model)\r\n *  #externalEntityDecl(name, publicId, systemId)\r\n *  #internalEntityDecl(name, value)\r\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/EntityResolver2.html\r\n * IGNORED method of org.xml.sax.EntityResolver2\r\n *  #resolveEntity(String name,String publicId,String baseURI,String systemId)\r\n *  #resolveEntity(publicId, systemId)\r\n *  #getExternalSubset(name, baseURI)\r\n * @link http://www.saxproject.org/apidoc/org/xml/sax/DTDHandler.html\r\n * IGNORED method of org.xml.sax.DTDHandler\r\n *  #notationDecl(name, publicId, systemId) {};\r\n *  #unparsedEntityDecl(name, publicId, systemId, notationName) {};\r\n */\r\n\"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl\".replace(/\\w+/g,function(key){\r\n\tDOMHandler.prototype[key] = function(){return null}\r\n})\r\n\r\n/* Private static helpers treated below as private instance methods, so don't need to add these to the public API; we might use a Relator to also get rid of non-standard public properties */\r\nfunction appendElement (hander,node) {\r\n    if (!hander.currentElement) {\r\n        hander.doc.appendChild(node);\r\n    } else {\r\n        hander.currentElement.appendChild(node);\r\n    }\r\n}//appendChild and setAttributeNS are preformance key\r\n\r\n//if(typeof require == 'function'){\r\n\tvar XMLReader = require('./sax').XMLReader;\r\n\tvar DOMImplementation = exports.DOMImplementation = require('./dom').DOMImplementation;\r\n\texports.XMLSerializer = require('./dom').XMLSerializer ;\r\n\texports.DOMParser = DOMParser;\r\n//}\r\n","var COS = require('./src/cos');\r\nmodule.exports = COS;","/* globals __webpack_amd_options__ */\nmodule.exports = __webpack_amd_options__;\n","exports.nextTick = function nextTick(fn) {\n    var args = Array.prototype.slice.call(arguments);\n    args.shift();\n    setTimeout(function () {\n        fn.apply(null, args);\n    }, 0);\n};\n\nexports.platform = exports.arch = \nexports.execPath = exports.title = 'browser';\nexports.pid = 1;\nexports.browser = true;\nexports.env = {};\nexports.argv = [];\n\nexports.binding = function (name) {\n\tthrow new Error('No such module. (Possibly not yet loaded)')\n};\n\n(function () {\n    var cwd = '/';\n    var path;\n    exports.cwd = function () { return cwd };\n    exports.chdir = function (dir) {\n        if (!path) path = require('path');\n        cwd = path.resolve(dir, cwd);\n    };\n})();\n\nexports.exit = exports.kill = \nexports.umask = exports.dlopen = \nexports.uptime = exports.memoryUsage = \nexports.uvCounters = function() {};\nexports.features = {};\n","/*\n * DOM Level 2\n * Object DOMException\n * @see http://www.w3.org/TR/REC-DOM-Level-1/ecma-script-language-binding.html\n * @see http://www.w3.org/TR/2000/REC-DOM-Level-2-Core-20001113/ecma-script-binding.html\n */\n\nfunction copy(src,dest){\n\tfor(var p in src){\n\t\tdest[p] = src[p];\n\t}\n}\n/**\n^\\w+\\.prototype\\.([_\\w]+)\\s*=\\s*((?:.*\\{\\s*?[\\r\\n][\\s\\S]*?^})|\\S.*?(?=[;\\r\\n]));?\n^\\w+\\.prototype\\.([_\\w]+)\\s*=\\s*(\\S.*?(?=[;\\r\\n]));?\n */\nfunction _extends(Class,Super){\n\tvar pt = Class.prototype;\n\tif(Object.create){\n\t\tvar ppt = Object.create(Super.prototype)\n\t\tpt.__proto__ = ppt;\n\t}\n\tif(!(pt instanceof Super)){\n\t\tfunction t(){};\n\t\tt.prototype = Super.prototype;\n\t\tt = new t();\n\t\tcopy(pt,t);\n\t\tClass.prototype = pt = t;\n\t}\n\tif(pt.constructor != Class){\n\t\tif(typeof Class != 'function'){\n\t\t\tconsole.error(\"unknow Class:\"+Class)\n\t\t}\n\t\tpt.constructor = Class\n\t}\n}\nvar htmlns = 'http://www.w3.org/1999/xhtml' ;\n// Node Types\nvar NodeType = {}\nvar ELEMENT_NODE                = NodeType.ELEMENT_NODE                = 1;\nvar ATTRIBUTE_NODE              = NodeType.ATTRIBUTE_NODE              = 2;\nvar TEXT_NODE                   = NodeType.TEXT_NODE                   = 3;\nvar CDATA_SECTION_NODE          = NodeType.CDATA_SECTION_NODE          = 4;\nvar ENTITY_REFERENCE_NODE       = NodeType.ENTITY_REFERENCE_NODE       = 5;\nvar ENTITY_NODE                 = NodeType.ENTITY_NODE                 = 6;\nvar PROCESSING_INSTRUCTION_NODE = NodeType.PROCESSING_INSTRUCTION_NODE = 7;\nvar COMMENT_NODE                = NodeType.COMMENT_NODE                = 8;\nvar DOCUMENT_NODE               = NodeType.DOCUMENT_NODE               = 9;\nvar DOCUMENT_TYPE_NODE          = NodeType.DOCUMENT_TYPE_NODE          = 10;\nvar DOCUMENT_FRAGMENT_NODE      = NodeType.DOCUMENT_FRAGMENT_NODE      = 11;\nvar NOTATION_NODE               = NodeType.NOTATION_NODE               = 12;\n\n// ExceptionCode\nvar ExceptionCode = {}\nvar ExceptionMessage = {};\nvar INDEX_SIZE_ERR              = ExceptionCode.INDEX_SIZE_ERR              = ((ExceptionMessage[1]=\"Index size error\"),1);\nvar DOMSTRING_SIZE_ERR          = ExceptionCode.DOMSTRING_SIZE_ERR          = ((ExceptionMessage[2]=\"DOMString size error\"),2);\nvar HIERARCHY_REQUEST_ERR       = ExceptionCode.HIERARCHY_REQUEST_ERR       = ((ExceptionMessage[3]=\"Hierarchy request error\"),3);\nvar WRONG_DOCUMENT_ERR          = ExceptionCode.WRONG_DOCUMENT_ERR          = ((ExceptionMessage[4]=\"Wrong document\"),4);\nvar INVALID_CHARACTER_ERR       = ExceptionCode.INVALID_CHARACTER_ERR       = ((ExceptionMessage[5]=\"Invalid character\"),5);\nvar NO_DATA_ALLOWED_ERR         = ExceptionCode.NO_DATA_ALLOWED_ERR         = ((ExceptionMessage[6]=\"No data allowed\"),6);\nvar NO_MODIFICATION_ALLOWED_ERR = ExceptionCode.NO_MODIFICATION_ALLOWED_ERR = ((ExceptionMessage[7]=\"No modification allowed\"),7);\nvar NOT_FOUND_ERR               = ExceptionCode.NOT_FOUND_ERR               = ((ExceptionMessage[8]=\"Not found\"),8);\nvar NOT_SUPPORTED_ERR           = ExceptionCode.NOT_SUPPORTED_ERR           = ((ExceptionMessage[9]=\"Not supported\"),9);\nvar INUSE_ATTRIBUTE_ERR         = ExceptionCode.INUSE_ATTRIBUTE_ERR         = ((ExceptionMessage[10]=\"Attribute in use\"),10);\n//level2\nvar INVALID_STATE_ERR        \t= ExceptionCode.INVALID_STATE_ERR        \t= ((ExceptionMessage[11]=\"Invalid state\"),11);\nvar SYNTAX_ERR               \t= ExceptionCode.SYNTAX_ERR               \t= ((ExceptionMessage[12]=\"Syntax error\"),12);\nvar INVALID_MODIFICATION_ERR \t= ExceptionCode.INVALID_MODIFICATION_ERR \t= ((ExceptionMessage[13]=\"Invalid modification\"),13);\nvar NAMESPACE_ERR            \t= ExceptionCode.NAMESPACE_ERR           \t= ((ExceptionMessage[14]=\"Invalid namespace\"),14);\nvar INVALID_ACCESS_ERR       \t= ExceptionCode.INVALID_ACCESS_ERR      \t= ((ExceptionMessage[15]=\"Invalid access\"),15);\n\n\nfunction DOMException(code, message) {\n\tif(message instanceof Error){\n\t\tvar error = message;\n\t}else{\n\t\terror = this;\n\t\tError.call(this, ExceptionMessage[code]);\n\t\tthis.message = ExceptionMessage[code];\n\t\tif(Error.captureStackTrace) Error.captureStackTrace(this, DOMException);\n\t}\n\terror.code = code;\n\tif(message) this.message = this.message + \": \" + message;\n\treturn error;\n};\nDOMException.prototype = Error.prototype;\ncopy(ExceptionCode,DOMException)\n/**\n * @see http://www.w3.org/TR/2000/REC-DOM-Level-2-Core-20001113/core.html#ID-536297177\n * The NodeList interface provides the abstraction of an ordered collection of nodes, without defining or constraining how this collection is implemented. NodeList objects in the DOM are live.\n * The items in the NodeList are accessible via an integral index, starting from 0.\n */\nfunction NodeList() {\n};\nNodeList.prototype = {\n\t/**\n\t * The number of nodes in the list. The range of valid child node indices is 0 to length-1 inclusive.\n\t * @standard level1\n\t */\n\tlength:0, \n\t/**\n\t * Returns the indexth item in the collection. If index is greater than or equal to the number of nodes in the list, this returns null.\n\t * @standard level1\n\t * @param index  unsigned long \n\t *   Index into the collection.\n\t * @return Node\n\t * \tThe node at the indexth position in the NodeList, or null if that is not a valid index. \n\t */\n\titem: function(index) {\n\t\treturn this[index] || null;\n\t},\n\ttoString:function(isHTML,nodeFilter){\n\t\tfor(var buf = [], i = 0;i<this.length;i++){\n\t\t\tserializeToString(this[i],buf,isHTML,nodeFilter);\n\t\t}\n\t\treturn buf.join('');\n\t}\n};\nfunction LiveNodeList(node,refresh){\n\tthis._node = node;\n\tthis._refresh = refresh\n\t_updateLiveList(this);\n}\nfunction _updateLiveList(list){\n\tvar inc = list._node._inc || list._node.ownerDocument._inc;\n\tif(list._inc != inc){\n\t\tvar ls = list._refresh(list._node);\n\t\t//console.log(ls.length)\n\t\t__set__(list,'length',ls.length);\n\t\tcopy(ls,list);\n\t\tlist._inc = inc;\n\t}\n}\nLiveNodeList.prototype.item = function(i){\n\t_updateLiveList(this);\n\treturn this[i];\n}\n\n_extends(LiveNodeList,NodeList);\n/**\n * \n * Objects implementing the NamedNodeMap interface are used to represent collections of nodes that can be accessed by name. Note that NamedNodeMap does not inherit from NodeList; NamedNodeMaps are not maintained in any particular order. Objects contained in an object implementing NamedNodeMap may also be accessed by an ordinal index, but this is simply to allow convenient enumeration of the contents of a NamedNodeMap, and does not imply that the DOM specifies an order to these Nodes.\n * NamedNodeMap objects in the DOM are live.\n * used for attributes or DocumentType entities \n */\nfunction NamedNodeMap() {\n};\n\nfunction _findNodeIndex(list,node){\n\tvar i = list.length;\n\twhile(i--){\n\t\tif(list[i] === node){return i}\n\t}\n}\n\nfunction _addNamedNode(el,list,newAttr,oldAttr){\n\tif(oldAttr){\n\t\tlist[_findNodeIndex(list,oldAttr)] = newAttr;\n\t}else{\n\t\tlist[list.length++] = newAttr;\n\t}\n\tif(el){\n\t\tnewAttr.ownerElement = el;\n\t\tvar doc = el.ownerDocument;\n\t\tif(doc){\n\t\t\toldAttr && _onRemoveAttribute(doc,el,oldAttr);\n\t\t\t_onAddAttribute(doc,el,newAttr);\n\t\t}\n\t}\n}\nfunction _removeNamedNode(el,list,attr){\n\t//console.log('remove attr:'+attr)\n\tvar i = _findNodeIndex(list,attr);\n\tif(i>=0){\n\t\tvar lastIndex = list.length-1\n\t\twhile(i<lastIndex){\n\t\t\tlist[i] = list[++i]\n\t\t}\n\t\tlist.length = lastIndex;\n\t\tif(el){\n\t\t\tvar doc = el.ownerDocument;\n\t\t\tif(doc){\n\t\t\t\t_onRemoveAttribute(doc,el,attr);\n\t\t\t\tattr.ownerElement = null;\n\t\t\t}\n\t\t}\n\t}else{\n\t\tthrow DOMException(NOT_FOUND_ERR,new Error(el.tagName+'@'+attr))\n\t}\n}\nNamedNodeMap.prototype = {\n\tlength:0,\n\titem:NodeList.prototype.item,\n\tgetNamedItem: function(key) {\n//\t\tif(key.indexOf(':')>0 || key == 'xmlns'){\n//\t\t\treturn null;\n//\t\t}\n\t\t//console.log()\n\t\tvar i = this.length;\n\t\twhile(i--){\n\t\t\tvar attr = this[i];\n\t\t\t//console.log(attr.nodeName,key)\n\t\t\tif(attr.nodeName == key){\n\t\t\t\treturn attr;\n\t\t\t}\n\t\t}\n\t},\n\tsetNamedItem: function(attr) {\n\t\tvar el = attr.ownerElement;\n\t\tif(el && el!=this._ownerElement){\n\t\t\tthrow new DOMException(INUSE_ATTRIBUTE_ERR);\n\t\t}\n\t\tvar oldAttr = this.getNamedItem(attr.nodeName);\n\t\t_addNamedNode(this._ownerElement,this,attr,oldAttr);\n\t\treturn oldAttr;\n\t},\n\t/* returns Node */\n\tsetNamedItemNS: function(attr) {// raises: WRONG_DOCUMENT_ERR,NO_MODIFICATION_ALLOWED_ERR,INUSE_ATTRIBUTE_ERR\n\t\tvar el = attr.ownerElement, oldAttr;\n\t\tif(el && el!=this._ownerElement){\n\t\t\tthrow new DOMException(INUSE_ATTRIBUTE_ERR);\n\t\t}\n\t\toldAttr = this.getNamedItemNS(attr.namespaceURI,attr.localName);\n\t\t_addNamedNode(this._ownerElement,this,attr,oldAttr);\n\t\treturn oldAttr;\n\t},\n\n\t/* returns Node */\n\tremoveNamedItem: function(key) {\n\t\tvar attr = this.getNamedItem(key);\n\t\t_removeNamedNode(this._ownerElement,this,attr);\n\t\treturn attr;\n\t\t\n\t\t\n\t},// raises: NOT_FOUND_ERR,NO_MODIFICATION_ALLOWED_ERR\n\t\n\t//for level2\n\tremoveNamedItemNS:function(namespaceURI,localName){\n\t\tvar attr = this.getNamedItemNS(namespaceURI,localName);\n\t\t_removeNamedNode(this._ownerElement,this,attr);\n\t\treturn attr;\n\t},\n\tgetNamedItemNS: function(namespaceURI, localName) {\n\t\tvar i = this.length;\n\t\twhile(i--){\n\t\t\tvar node = this[i];\n\t\t\tif(node.localName == localName && node.namespaceURI == namespaceURI){\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n};\n/**\n * @see http://www.w3.org/TR/REC-DOM-Level-1/level-one-core.html#ID-102161490\n */\nfunction DOMImplementation(/* Object */ features) {\n\tthis._features = {};\n\tif (features) {\n\t\tfor (var feature in features) {\n\t\t\t this._features = features[feature];\n\t\t}\n\t}\n};\n\nDOMImplementation.prototype = {\n\thasFeature: function(/* string */ feature, /* string */ version) {\n\t\tvar versions = this._features[feature.toLowerCase()];\n\t\tif (versions && (!version || version in versions)) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t},\n\t// Introduced in DOM Level 2:\n\tcreateDocument:function(namespaceURI,  qualifiedName, doctype){// raises:INVALID_CHARACTER_ERR,NAMESPACE_ERR,WRONG_DOCUMENT_ERR\n\t\tvar doc = new Document();\n\t\tdoc.implementation = this;\n\t\tdoc.childNodes = new NodeList();\n\t\tdoc.doctype = doctype;\n\t\tif(doctype){\n\t\t\tdoc.appendChild(doctype);\n\t\t}\n\t\tif(qualifiedName){\n\t\t\tvar root = doc.createElementNS(namespaceURI,qualifiedName);\n\t\t\tdoc.appendChild(root);\n\t\t}\n\t\treturn doc;\n\t},\n\t// Introduced in DOM Level 2:\n\tcreateDocumentType:function(qualifiedName, publicId, systemId){// raises:INVALID_CHARACTER_ERR,NAMESPACE_ERR\n\t\tvar node = new DocumentType();\n\t\tnode.name = qualifiedName;\n\t\tnode.nodeName = qualifiedName;\n\t\tnode.publicId = publicId;\n\t\tnode.systemId = systemId;\n\t\t// Introduced in DOM Level 2:\n\t\t//readonly attribute DOMString        internalSubset;\n\t\t\n\t\t//TODO:..\n\t\t//  readonly attribute NamedNodeMap     entities;\n\t\t//  readonly attribute NamedNodeMap     notations;\n\t\treturn node;\n\t}\n};\n\n\n/**\n * @see http://www.w3.org/TR/2000/REC-DOM-Level-2-Core-20001113/core.html#ID-1950641247\n */\n\nfunction Node() {\n};\n\nNode.prototype = {\n\tfirstChild : null,\n\tlastChild : null,\n\tpreviousSibling : null,\n\tnextSibling : null,\n\tattributes : null,\n\tparentNode : null,\n\tchildNodes : null,\n\townerDocument : null,\n\tnodeValue : null,\n\tnamespaceURI : null,\n\tprefix : null,\n\tlocalName : null,\n\t// Modified in DOM Level 2:\n\tinsertBefore:function(newChild, refChild){//raises \n\t\treturn _insertBefore(this,newChild,refChild);\n\t},\n\treplaceChild:function(newChild, oldChild){//raises \n\t\tthis.insertBefore(newChild,oldChild);\n\t\tif(oldChild){\n\t\t\tthis.removeChild(oldChild);\n\t\t}\n\t},\n\tremoveChild:function(oldChild){\n\t\treturn _removeChild(this,oldChild);\n\t},\n\tappendChild:function(newChild){\n\t\treturn this.insertBefore(newChild,null);\n\t},\n\thasChildNodes:function(){\n\t\treturn this.firstChild != null;\n\t},\n\tcloneNode:function(deep){\n\t\treturn cloneNode(this.ownerDocument||this,this,deep);\n\t},\n\t// Modified in DOM Level 2:\n\tnormalize:function(){\n\t\tvar child = this.firstChild;\n\t\twhile(child){\n\t\t\tvar next = child.nextSibling;\n\t\t\tif(next && next.nodeType == TEXT_NODE && child.nodeType == TEXT_NODE){\n\t\t\t\tthis.removeChild(next);\n\t\t\t\tchild.appendData(next.data);\n\t\t\t}else{\n\t\t\t\tchild.normalize();\n\t\t\t\tchild = next;\n\t\t\t}\n\t\t}\n\t},\n  \t// Introduced in DOM Level 2:\n\tisSupported:function(feature, version){\n\t\treturn this.ownerDocument.implementation.hasFeature(feature,version);\n\t},\n    // Introduced in DOM Level 2:\n    hasAttributes:function(){\n    \treturn this.attributes.length>0;\n    },\n    lookupPrefix:function(namespaceURI){\n    \tvar el = this;\n    \twhile(el){\n    \t\tvar map = el._nsMap;\n    \t\t//console.dir(map)\n    \t\tif(map){\n    \t\t\tfor(var n in map){\n    \t\t\t\tif(map[n] == namespaceURI){\n    \t\t\t\t\treturn n;\n    \t\t\t\t}\n    \t\t\t}\n    \t\t}\n    \t\tel = el.nodeType == ATTRIBUTE_NODE?el.ownerDocument : el.parentNode;\n    \t}\n    \treturn null;\n    },\n    // Introduced in DOM Level 3:\n    lookupNamespaceURI:function(prefix){\n    \tvar el = this;\n    \twhile(el){\n    \t\tvar map = el._nsMap;\n    \t\t//console.dir(map)\n    \t\tif(map){\n    \t\t\tif(prefix in map){\n    \t\t\t\treturn map[prefix] ;\n    \t\t\t}\n    \t\t}\n    \t\tel = el.nodeType == ATTRIBUTE_NODE?el.ownerDocument : el.parentNode;\n    \t}\n    \treturn null;\n    },\n    // Introduced in DOM Level 3:\n    isDefaultNamespace:function(namespaceURI){\n    \tvar prefix = this.lookupPrefix(namespaceURI);\n    \treturn prefix == null;\n    }\n};\n\n\nfunction _xmlEncoder(c){\n\treturn c == '<' && '&lt;' ||\n         c == '>' && '&gt;' ||\n         c == '&' && '&amp;' ||\n         c == '\"' && '&quot;' ||\n         '&#'+c.charCodeAt()+';'\n}\n\n\ncopy(NodeType,Node);\ncopy(NodeType,Node.prototype);\n\n/**\n * @param callback return true for continue,false for break\n * @return boolean true: break visit;\n */\nfunction _visitNode(node,callback){\n\tif(callback(node)){\n\t\treturn true;\n\t}\n\tif(node = node.firstChild){\n\t\tdo{\n\t\t\tif(_visitNode(node,callback)){return true}\n        }while(node=node.nextSibling)\n    }\n}\n\n\n\nfunction Document(){\n}\nfunction _onAddAttribute(doc,el,newAttr){\n\tdoc && doc._inc++;\n\tvar ns = newAttr.namespaceURI ;\n\tif(ns == 'http://www.w3.org/2000/xmlns/'){\n\t\t//update namespace\n\t\tel._nsMap[newAttr.prefix?newAttr.localName:''] = newAttr.value\n\t}\n}\nfunction _onRemoveAttribute(doc,el,newAttr,remove){\n\tdoc && doc._inc++;\n\tvar ns = newAttr.namespaceURI ;\n\tif(ns == 'http://www.w3.org/2000/xmlns/'){\n\t\t//update namespace\n\t\tdelete el._nsMap[newAttr.prefix?newAttr.localName:'']\n\t}\n}\nfunction _onUpdateChild(doc,el,newChild){\n\tif(doc && doc._inc){\n\t\tdoc._inc++;\n\t\t//update childNodes\n\t\tvar cs = el.childNodes;\n\t\tif(newChild){\n\t\t\tcs[cs.length++] = newChild;\n\t\t}else{\n\t\t\t//console.log(1)\n\t\t\tvar child = el.firstChild;\n\t\t\tvar i = 0;\n\t\t\twhile(child){\n\t\t\t\tcs[i++] = child;\n\t\t\t\tchild =child.nextSibling;\n\t\t\t}\n\t\t\tcs.length = i;\n\t\t}\n\t}\n}\n\n/**\n * attributes;\n * children;\n * \n * writeable properties:\n * nodeValue,Attr:value,CharacterData:data\n * prefix\n */\nfunction _removeChild(parentNode,child){\n\tvar previous = child.previousSibling;\n\tvar next = child.nextSibling;\n\tif(previous){\n\t\tprevious.nextSibling = next;\n\t}else{\n\t\tparentNode.firstChild = next\n\t}\n\tif(next){\n\t\tnext.previousSibling = previous;\n\t}else{\n\t\tparentNode.lastChild = previous;\n\t}\n\t_onUpdateChild(parentNode.ownerDocument,parentNode);\n\treturn child;\n}\n/**\n * preformance key(refChild == null)\n */\nfunction _insertBefore(parentNode,newChild,nextChild){\n\tvar cp = newChild.parentNode;\n\tif(cp){\n\t\tcp.removeChild(newChild);//remove and update\n\t}\n\tif(newChild.nodeType === DOCUMENT_FRAGMENT_NODE){\n\t\tvar newFirst = newChild.firstChild;\n\t\tif (newFirst == null) {\n\t\t\treturn newChild;\n\t\t}\n\t\tvar newLast = newChild.lastChild;\n\t}else{\n\t\tnewFirst = newLast = newChild;\n\t}\n\tvar pre = nextChild ? nextChild.previousSibling : parentNode.lastChild;\n\n\tnewFirst.previousSibling = pre;\n\tnewLast.nextSibling = nextChild;\n\t\n\t\n\tif(pre){\n\t\tpre.nextSibling = newFirst;\n\t}else{\n\t\tparentNode.firstChild = newFirst;\n\t}\n\tif(nextChild == null){\n\t\tparentNode.lastChild = newLast;\n\t}else{\n\t\tnextChild.previousSibling = newLast;\n\t}\n\tdo{\n\t\tnewFirst.parentNode = parentNode;\n\t}while(newFirst !== newLast && (newFirst= newFirst.nextSibling))\n\t_onUpdateChild(parentNode.ownerDocument||parentNode,parentNode);\n\t//console.log(parentNode.lastChild.nextSibling == null)\n\tif (newChild.nodeType == DOCUMENT_FRAGMENT_NODE) {\n\t\tnewChild.firstChild = newChild.lastChild = null;\n\t}\n\treturn newChild;\n}\nfunction _appendSingleChild(parentNode,newChild){\n\tvar cp = newChild.parentNode;\n\tif(cp){\n\t\tvar pre = parentNode.lastChild;\n\t\tcp.removeChild(newChild);//remove and update\n\t\tvar pre = parentNode.lastChild;\n\t}\n\tvar pre = parentNode.lastChild;\n\tnewChild.parentNode = parentNode;\n\tnewChild.previousSibling = pre;\n\tnewChild.nextSibling = null;\n\tif(pre){\n\t\tpre.nextSibling = newChild;\n\t}else{\n\t\tparentNode.firstChild = newChild;\n\t}\n\tparentNode.lastChild = newChild;\n\t_onUpdateChild(parentNode.ownerDocument,parentNode,newChild);\n\treturn newChild;\n\t//console.log(\"__aa\",parentNode.lastChild.nextSibling == null)\n}\nDocument.prototype = {\n\t//implementation : null,\n\tnodeName :  '#document',\n\tnodeType :  DOCUMENT_NODE,\n\tdoctype :  null,\n\tdocumentElement :  null,\n\t_inc : 1,\n\t\n\tinsertBefore :  function(newChild, refChild){//raises \n\t\tif(newChild.nodeType == DOCUMENT_FRAGMENT_NODE){\n\t\t\tvar child = newChild.firstChild;\n\t\t\twhile(child){\n\t\t\t\tvar next = child.nextSibling;\n\t\t\t\tthis.insertBefore(child,refChild);\n\t\t\t\tchild = next;\n\t\t\t}\n\t\t\treturn newChild;\n\t\t}\n\t\tif(this.documentElement == null && newChild.nodeType == ELEMENT_NODE){\n\t\t\tthis.documentElement = newChild;\n\t\t}\n\t\t\n\t\treturn _insertBefore(this,newChild,refChild),(newChild.ownerDocument = this),newChild;\n\t},\n\tremoveChild :  function(oldChild){\n\t\tif(this.documentElement == oldChild){\n\t\t\tthis.documentElement = null;\n\t\t}\n\t\treturn _removeChild(this,oldChild);\n\t},\n\t// Introduced in DOM Level 2:\n\timportNode : function(importedNode,deep){\n\t\treturn importNode(this,importedNode,deep);\n\t},\n\t// Introduced in DOM Level 2:\n\tgetElementById :\tfunction(id){\n\t\tvar rtv = null;\n\t\t_visitNode(this.documentElement,function(node){\n\t\t\tif(node.nodeType == ELEMENT_NODE){\n\t\t\t\tif(node.getAttribute('id') == id){\n\t\t\t\t\trtv = node;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t\treturn rtv;\n\t},\n\t\n\t//document factory method:\n\tcreateElement :\tfunction(tagName){\n\t\tvar node = new Element();\n\t\tnode.ownerDocument = this;\n\t\tnode.nodeName = tagName;\n\t\tnode.tagName = tagName;\n\t\tnode.childNodes = new NodeList();\n\t\tvar attrs\t= node.attributes = new NamedNodeMap();\n\t\tattrs._ownerElement = node;\n\t\treturn node;\n\t},\n\tcreateDocumentFragment :\tfunction(){\n\t\tvar node = new DocumentFragment();\n\t\tnode.ownerDocument = this;\n\t\tnode.childNodes = new NodeList();\n\t\treturn node;\n\t},\n\tcreateTextNode :\tfunction(data){\n\t\tvar node = new Text();\n\t\tnode.ownerDocument = this;\n\t\tnode.appendData(data)\n\t\treturn node;\n\t},\n\tcreateComment :\tfunction(data){\n\t\tvar node = new Comment();\n\t\tnode.ownerDocument = this;\n\t\tnode.appendData(data)\n\t\treturn node;\n\t},\n\tcreateCDATASection :\tfunction(data){\n\t\tvar node = new CDATASection();\n\t\tnode.ownerDocument = this;\n\t\tnode.appendData(data)\n\t\treturn node;\n\t},\n\tcreateProcessingInstruction :\tfunction(target,data){\n\t\tvar node = new ProcessingInstruction();\n\t\tnode.ownerDocument = this;\n\t\tnode.tagName = node.target = target;\n\t\tnode.nodeValue= node.data = data;\n\t\treturn node;\n\t},\n\tcreateAttribute :\tfunction(name){\n\t\tvar node = new Attr();\n\t\tnode.ownerDocument\t= this;\n\t\tnode.name = name;\n\t\tnode.nodeName\t= name;\n\t\tnode.localName = name;\n\t\tnode.specified = true;\n\t\treturn node;\n\t},\n\tcreateEntityReference :\tfunction(name){\n\t\tvar node = new EntityReference();\n\t\tnode.ownerDocument\t= this;\n\t\tnode.nodeName\t= name;\n\t\treturn node;\n\t},\n\t// Introduced in DOM Level 2:\n\tcreateElementNS :\tfunction(namespaceURI,qualifiedName){\n\t\tvar node = new Element();\n\t\tvar pl = qualifiedName.split(':');\n\t\tvar attrs\t= node.attributes = new NamedNodeMap();\n\t\tnode.childNodes = new NodeList();\n\t\tnode.ownerDocument = this;\n\t\tnode.nodeName = qualifiedName;\n\t\tnode.tagName = qualifiedName;\n\t\tnode.namespaceURI = namespaceURI;\n\t\tif(pl.length == 2){\n\t\t\tnode.prefix = pl[0];\n\t\t\tnode.localName = pl[1];\n\t\t}else{\n\t\t\t//el.prefix = null;\n\t\t\tnode.localName = qualifiedName;\n\t\t}\n\t\tattrs._ownerElement = node;\n\t\treturn node;\n\t},\n\t// Introduced in DOM Level 2:\n\tcreateAttributeNS :\tfunction(namespaceURI,qualifiedName){\n\t\tvar node = new Attr();\n\t\tvar pl = qualifiedName.split(':');\n\t\tnode.ownerDocument = this;\n\t\tnode.nodeName = qualifiedName;\n\t\tnode.name = qualifiedName;\n\t\tnode.namespaceURI = namespaceURI;\n\t\tnode.specified = true;\n\t\tif(pl.length == 2){\n\t\t\tnode.prefix = pl[0];\n\t\t\tnode.localName = pl[1];\n\t\t}else{\n\t\t\t//el.prefix = null;\n\t\t\tnode.localName = qualifiedName;\n\t\t}\n\t\treturn node;\n\t}\n};\n_extends(Document,Node);\n\n\nfunction Element() {\n\tthis._nsMap = {};\n};\nElement.prototype = {\n\tnodeType : ELEMENT_NODE,\n\thasAttribute : function(name){\n\t\treturn this.getAttributeNode(name)!=null;\n\t},\n\tgetAttribute : function(name){\n\t\tvar attr = this.getAttributeNode(name);\n\t\treturn attr && attr.value || '';\n\t},\n\tgetAttributeNode : function(name){\n\t\treturn this.attributes.getNamedItem(name);\n\t},\n\tsetAttribute : function(name, value){\n\t\tvar attr = this.ownerDocument.createAttribute(name);\n\t\tattr.value = attr.nodeValue = \"\" + value;\n\t\tthis.setAttributeNode(attr)\n\t},\n\tremoveAttribute : function(name){\n\t\tvar attr = this.getAttributeNode(name)\n\t\tattr && this.removeAttributeNode(attr);\n\t},\n\t\n\t//four real opeartion method\n\tappendChild:function(newChild){\n\t\tif(newChild.nodeType === DOCUMENT_FRAGMENT_NODE){\n\t\t\treturn this.insertBefore(newChild,null);\n\t\t}else{\n\t\t\treturn _appendSingleChild(this,newChild);\n\t\t}\n\t},\n\tsetAttributeNode : function(newAttr){\n\t\treturn this.attributes.setNamedItem(newAttr);\n\t},\n\tsetAttributeNodeNS : function(newAttr){\n\t\treturn this.attributes.setNamedItemNS(newAttr);\n\t},\n\tremoveAttributeNode : function(oldAttr){\n\t\t//console.log(this == oldAttr.ownerElement)\n\t\treturn this.attributes.removeNamedItem(oldAttr.nodeName);\n\t},\n\t//get real attribute name,and remove it by removeAttributeNode\n\tremoveAttributeNS : function(namespaceURI, localName){\n\t\tvar old = this.getAttributeNodeNS(namespaceURI, localName);\n\t\told && this.removeAttributeNode(old);\n\t},\n\t\n\thasAttributeNS : function(namespaceURI, localName){\n\t\treturn this.getAttributeNodeNS(namespaceURI, localName)!=null;\n\t},\n\tgetAttributeNS : function(namespaceURI, localName){\n\t\tvar attr = this.getAttributeNodeNS(namespaceURI, localName);\n\t\treturn attr && attr.value || '';\n\t},\n\tsetAttributeNS : function(namespaceURI, qualifiedName, value){\n\t\tvar attr = this.ownerDocument.createAttributeNS(namespaceURI, qualifiedName);\n\t\tattr.value = attr.nodeValue = \"\" + value;\n\t\tthis.setAttributeNode(attr)\n\t},\n\tgetAttributeNodeNS : function(namespaceURI, localName){\n\t\treturn this.attributes.getNamedItemNS(namespaceURI, localName);\n\t},\n\t\n\tgetElementsByTagName : function(tagName){\n\t\treturn new LiveNodeList(this,function(base){\n\t\t\tvar ls = [];\n\t\t\t_visitNode(base,function(node){\n\t\t\t\tif(node !== base && node.nodeType == ELEMENT_NODE && (tagName === '*' || node.tagName == tagName)){\n\t\t\t\t\tls.push(node);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn ls;\n\t\t});\n\t},\n\tgetElementsByTagNameNS : function(namespaceURI, localName){\n\t\treturn new LiveNodeList(this,function(base){\n\t\t\tvar ls = [];\n\t\t\t_visitNode(base,function(node){\n\t\t\t\tif(node !== base && node.nodeType === ELEMENT_NODE && (namespaceURI === '*' || node.namespaceURI === namespaceURI) && (localName === '*' || node.localName == localName)){\n\t\t\t\t\tls.push(node);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn ls;\n\t\t\t\n\t\t});\n\t}\n};\nDocument.prototype.getElementsByTagName = Element.prototype.getElementsByTagName;\nDocument.prototype.getElementsByTagNameNS = Element.prototype.getElementsByTagNameNS;\n\n\n_extends(Element,Node);\nfunction Attr() {\n};\nAttr.prototype.nodeType = ATTRIBUTE_NODE;\n_extends(Attr,Node);\n\n\nfunction CharacterData() {\n};\nCharacterData.prototype = {\n\tdata : '',\n\tsubstringData : function(offset, count) {\n\t\treturn this.data.substring(offset, offset+count);\n\t},\n\tappendData: function(text) {\n\t\ttext = this.data+text;\n\t\tthis.nodeValue = this.data = text;\n\t\tthis.length = text.length;\n\t},\n\tinsertData: function(offset,text) {\n\t\tthis.replaceData(offset,0,text);\n\t\n\t},\n\tappendChild:function(newChild){\n\t\tthrow new Error(ExceptionMessage[HIERARCHY_REQUEST_ERR])\n\t},\n\tdeleteData: function(offset, count) {\n\t\tthis.replaceData(offset,count,\"\");\n\t},\n\treplaceData: function(offset, count, text) {\n\t\tvar start = this.data.substring(0,offset);\n\t\tvar end = this.data.substring(offset+count);\n\t\ttext = start + text + end;\n\t\tthis.nodeValue = this.data = text;\n\t\tthis.length = text.length;\n\t}\n}\n_extends(CharacterData,Node);\nfunction Text() {\n};\nText.prototype = {\n\tnodeName : \"#text\",\n\tnodeType : TEXT_NODE,\n\tsplitText : function(offset) {\n\t\tvar text = this.data;\n\t\tvar newText = text.substring(offset);\n\t\ttext = text.substring(0, offset);\n\t\tthis.data = this.nodeValue = text;\n\t\tthis.length = text.length;\n\t\tvar newNode = this.ownerDocument.createTextNode(newText);\n\t\tif(this.parentNode){\n\t\t\tthis.parentNode.insertBefore(newNode, this.nextSibling);\n\t\t}\n\t\treturn newNode;\n\t}\n}\n_extends(Text,CharacterData);\nfunction Comment() {\n};\nComment.prototype = {\n\tnodeName : \"#comment\",\n\tnodeType : COMMENT_NODE\n}\n_extends(Comment,CharacterData);\n\nfunction CDATASection() {\n};\nCDATASection.prototype = {\n\tnodeName : \"#cdata-section\",\n\tnodeType : CDATA_SECTION_NODE\n}\n_extends(CDATASection,CharacterData);\n\n\nfunction DocumentType() {\n};\nDocumentType.prototype.nodeType = DOCUMENT_TYPE_NODE;\n_extends(DocumentType,Node);\n\nfunction Notation() {\n};\nNotation.prototype.nodeType = NOTATION_NODE;\n_extends(Notation,Node);\n\nfunction Entity() {\n};\nEntity.prototype.nodeType = ENTITY_NODE;\n_extends(Entity,Node);\n\nfunction EntityReference() {\n};\nEntityReference.prototype.nodeType = ENTITY_REFERENCE_NODE;\n_extends(EntityReference,Node);\n\nfunction DocumentFragment() {\n};\nDocumentFragment.prototype.nodeName =\t\"#document-fragment\";\nDocumentFragment.prototype.nodeType =\tDOCUMENT_FRAGMENT_NODE;\n_extends(DocumentFragment,Node);\n\n\nfunction ProcessingInstruction() {\n}\nProcessingInstruction.prototype.nodeType = PROCESSING_INSTRUCTION_NODE;\n_extends(ProcessingInstruction,Node);\nfunction XMLSerializer(){}\nXMLSerializer.prototype.serializeToString = function(node,isHtml,nodeFilter){\n\treturn nodeSerializeToString.call(node,isHtml,nodeFilter);\n}\nNode.prototype.toString = nodeSerializeToString;\nfunction nodeSerializeToString(isHtml,nodeFilter){\n\tvar buf = [];\n\tvar refNode = this.nodeType == 9?this.documentElement:this;\n\tvar prefix = refNode.prefix;\n\tvar uri = refNode.namespaceURI;\n\t\n\tif(uri && prefix == null){\n\t\t//console.log(prefix)\n\t\tvar prefix = refNode.lookupPrefix(uri);\n\t\tif(prefix == null){\n\t\t\t//isHTML = true;\n\t\t\tvar visibleNamespaces=[\n\t\t\t{namespace:uri,prefix:null}\n\t\t\t//{namespace:uri,prefix:''}\n\t\t\t]\n\t\t}\n\t}\n\tserializeToString(this,buf,isHtml,nodeFilter,visibleNamespaces);\n\t//console.log('###',this.nodeType,uri,prefix,buf.join(''))\n\treturn buf.join('');\n}\nfunction needNamespaceDefine(node,isHTML, visibleNamespaces) {\n\tvar prefix = node.prefix||'';\n\tvar uri = node.namespaceURI;\n\tif (!prefix && !uri){\n\t\treturn false;\n\t}\n\tif (prefix === \"xml\" && uri === \"http://www.w3.org/XML/1998/namespace\" \n\t\t|| uri == 'http://www.w3.org/2000/xmlns/'){\n\t\treturn false;\n\t}\n\t\n\tvar i = visibleNamespaces.length \n\t//console.log('@@@@',node.tagName,prefix,uri,visibleNamespaces)\n\twhile (i--) {\n\t\tvar ns = visibleNamespaces[i];\n\t\t// get namespace prefix\n\t\t//console.log(node.nodeType,node.tagName,ns.prefix,prefix)\n\t\tif (ns.prefix == prefix){\n\t\t\treturn ns.namespace != uri;\n\t\t}\n\t}\n\t//console.log(isHTML,uri,prefix=='')\n\t//if(isHTML && prefix ==null && uri == 'http://www.w3.org/1999/xhtml'){\n\t//\treturn false;\n\t//}\n\t//node.flag = '11111'\n\t//console.error(3,true,node.flag,node.prefix,node.namespaceURI)\n\treturn true;\n}\nfunction serializeToString(node,buf,isHTML,nodeFilter,visibleNamespaces){\n\tif(nodeFilter){\n\t\tnode = nodeFilter(node);\n\t\tif(node){\n\t\t\tif(typeof node == 'string'){\n\t\t\t\tbuf.push(node);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}else{\n\t\t\treturn;\n\t\t}\n\t\t//buf.sort.apply(attrs, attributeSorter);\n\t}\n\tswitch(node.nodeType){\n\tcase ELEMENT_NODE:\n\t\tif (!visibleNamespaces) visibleNamespaces = [];\n\t\tvar startVisibleNamespaces = visibleNamespaces.length;\n\t\tvar attrs = node.attributes;\n\t\tvar len = attrs.length;\n\t\tvar child = node.firstChild;\n\t\tvar nodeName = node.tagName;\n\t\t\n\t\tisHTML =  (htmlns === node.namespaceURI) ||isHTML \n\t\tbuf.push('<',nodeName);\n\t\t\n\t\t\n\t\t\n\t\tfor(var i=0;i<len;i++){\n\t\t\t// add namespaces for attributes\n\t\t\tvar attr = attrs.item(i);\n\t\t\tif (attr.prefix == 'xmlns') {\n\t\t\t\tvisibleNamespaces.push({ prefix: attr.localName, namespace: attr.value });\n\t\t\t}else if(attr.nodeName == 'xmlns'){\n\t\t\t\tvisibleNamespaces.push({ prefix: '', namespace: attr.value });\n\t\t\t}\n\t\t}\n\t\tfor(var i=0;i<len;i++){\n\t\t\tvar attr = attrs.item(i);\n\t\t\tif (needNamespaceDefine(attr,isHTML, visibleNamespaces)) {\n\t\t\t\tvar prefix = attr.prefix||'';\n\t\t\t\tvar uri = attr.namespaceURI;\n\t\t\t\tvar ns = prefix ? ' xmlns:' + prefix : \" xmlns\";\n\t\t\t\tbuf.push(ns, '=\"' , uri , '\"');\n\t\t\t\tvisibleNamespaces.push({ prefix: prefix, namespace:uri });\n\t\t\t}\n\t\t\tserializeToString(attr,buf,isHTML,nodeFilter,visibleNamespaces);\n\t\t}\n\t\t// add namespace for current node\t\t\n\t\tif (needNamespaceDefine(node,isHTML, visibleNamespaces)) {\n\t\t\tvar prefix = node.prefix||'';\n\t\t\tvar uri = node.namespaceURI;\n\t\t\tvar ns = prefix ? ' xmlns:' + prefix : \" xmlns\";\n\t\t\tbuf.push(ns, '=\"' , uri , '\"');\n\t\t\tvisibleNamespaces.push({ prefix: prefix, namespace:uri });\n\t\t}\n\t\t\n\t\tif(child || isHTML && !/^(?:meta|link|img|br|hr|input)$/i.test(nodeName)){\n\t\t\tbuf.push('>');\n\t\t\t//if is cdata child node\n\t\t\tif(isHTML && /^script$/i.test(nodeName)){\n\t\t\t\twhile(child){\n\t\t\t\t\tif(child.data){\n\t\t\t\t\t\tbuf.push(child.data);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tserializeToString(child,buf,isHTML,nodeFilter,visibleNamespaces);\n\t\t\t\t\t}\n\t\t\t\t\tchild = child.nextSibling;\n\t\t\t\t}\n\t\t\t}else\n\t\t\t{\n\t\t\t\twhile(child){\n\t\t\t\t\tserializeToString(child,buf,isHTML,nodeFilter,visibleNamespaces);\n\t\t\t\t\tchild = child.nextSibling;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbuf.push('</',nodeName,'>');\n\t\t}else{\n\t\t\tbuf.push('/>');\n\t\t}\n\t\t// remove added visible namespaces\n\t\t//visibleNamespaces.length = startVisibleNamespaces;\n\t\treturn;\n\tcase DOCUMENT_NODE:\n\tcase DOCUMENT_FRAGMENT_NODE:\n\t\tvar child = node.firstChild;\n\t\twhile(child){\n\t\t\tserializeToString(child,buf,isHTML,nodeFilter,visibleNamespaces);\n\t\t\tchild = child.nextSibling;\n\t\t}\n\t\treturn;\n\tcase ATTRIBUTE_NODE:\n\t\treturn buf.push(' ',node.name,'=\"',node.value.replace(/[<&\"]/g,_xmlEncoder),'\"');\n\tcase TEXT_NODE:\n\t\treturn buf.push(node.data.replace(/[<&]/g,_xmlEncoder));\n\tcase CDATA_SECTION_NODE:\n\t\treturn buf.push( '<![CDATA[',node.data,']]>');\n\tcase COMMENT_NODE:\n\t\treturn buf.push( \"<!--\",node.data,\"-->\");\n\tcase DOCUMENT_TYPE_NODE:\n\t\tvar pubid = node.publicId;\n\t\tvar sysid = node.systemId;\n\t\tbuf.push('<!DOCTYPE ',node.name);\n\t\tif(pubid){\n\t\t\tbuf.push(' PUBLIC \"',pubid);\n\t\t\tif (sysid && sysid!='.') {\n\t\t\t\tbuf.push( '\" \"',sysid);\n\t\t\t}\n\t\t\tbuf.push('\">');\n\t\t}else if(sysid && sysid!='.'){\n\t\t\tbuf.push(' SYSTEM \"',sysid,'\">');\n\t\t}else{\n\t\t\tvar sub = node.internalSubset;\n\t\t\tif(sub){\n\t\t\t\tbuf.push(\" [\",sub,\"]\");\n\t\t\t}\n\t\t\tbuf.push(\">\");\n\t\t}\n\t\treturn;\n\tcase PROCESSING_INSTRUCTION_NODE:\n\t\treturn buf.push( \"<?\",node.target,\" \",node.data,\"?>\");\n\tcase ENTITY_REFERENCE_NODE:\n\t\treturn buf.push( '&',node.nodeName,';');\n\t//case ENTITY_NODE:\n\t//case NOTATION_NODE:\n\tdefault:\n\t\tbuf.push('??',node.nodeName);\n\t}\n}\nfunction importNode(doc,node,deep){\n\tvar node2;\n\tswitch (node.nodeType) {\n\tcase ELEMENT_NODE:\n\t\tnode2 = node.cloneNode(false);\n\t\tnode2.ownerDocument = doc;\n\t\t//var attrs = node2.attributes;\n\t\t//var len = attrs.length;\n\t\t//for(var i=0;i<len;i++){\n\t\t\t//node2.setAttributeNodeNS(importNode(doc,attrs.item(i),deep));\n\t\t//}\n\tcase DOCUMENT_FRAGMENT_NODE:\n\t\tbreak;\n\tcase ATTRIBUTE_NODE:\n\t\tdeep = true;\n\t\tbreak;\n\t//case ENTITY_REFERENCE_NODE:\n\t//case PROCESSING_INSTRUCTION_NODE:\n\t////case TEXT_NODE:\n\t//case CDATA_SECTION_NODE:\n\t//case COMMENT_NODE:\n\t//\tdeep = false;\n\t//\tbreak;\n\t//case DOCUMENT_NODE:\n\t//case DOCUMENT_TYPE_NODE:\n\t//cannot be imported.\n\t//case ENTITY_NODE:\n\t//case NOTATION_NODE\n\t//can not hit in level3\n\t//default:throw e;\n\t}\n\tif(!node2){\n\t\tnode2 = node.cloneNode(false);//false\n\t}\n\tnode2.ownerDocument = doc;\n\tnode2.parentNode = null;\n\tif(deep){\n\t\tvar child = node.firstChild;\n\t\twhile(child){\n\t\t\tnode2.appendChild(importNode(doc,child,deep));\n\t\t\tchild = child.nextSibling;\n\t\t}\n\t}\n\treturn node2;\n}\n//\n//var _relationMap = {firstChild:1,lastChild:1,previousSibling:1,nextSibling:1,\n//\t\t\t\t\tattributes:1,childNodes:1,parentNode:1,documentElement:1,doctype,};\nfunction cloneNode(doc,node,deep){\n\tvar node2 = new node.constructor();\n\tfor(var n in node){\n\t\tvar v = node[n];\n\t\tif(typeof v != 'object' ){\n\t\t\tif(v != node2[n]){\n\t\t\t\tnode2[n] = v;\n\t\t\t}\n\t\t}\n\t}\n\tif(node.childNodes){\n\t\tnode2.childNodes = new NodeList();\n\t}\n\tnode2.ownerDocument = doc;\n\tswitch (node2.nodeType) {\n\tcase ELEMENT_NODE:\n\t\tvar attrs\t= node.attributes;\n\t\tvar attrs2\t= node2.attributes = new NamedNodeMap();\n\t\tvar len = attrs.length\n\t\tattrs2._ownerElement = node2;\n\t\tfor(var i=0;i<len;i++){\n\t\t\tnode2.setAttributeNode(cloneNode(doc,attrs.item(i),true));\n\t\t}\n\t\tbreak;;\n\tcase ATTRIBUTE_NODE:\n\t\tdeep = true;\n\t}\n\tif(deep){\n\t\tvar child = node.firstChild;\n\t\twhile(child){\n\t\t\tnode2.appendChild(cloneNode(doc,child,deep));\n\t\t\tchild = child.nextSibling;\n\t\t}\n\t}\n\treturn node2;\n}\n\nfunction __set__(object,key,value){\n\tobject[key] = value\n}\n//do dynamic\ntry{\n\tif(Object.defineProperty){\n\t\tObject.defineProperty(LiveNodeList.prototype,'length',{\n\t\t\tget:function(){\n\t\t\t\t_updateLiveList(this);\n\t\t\t\treturn this.$$length;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(Node.prototype,'textContent',{\n\t\t\tget:function(){\n\t\t\t\treturn getTextContent(this);\n\t\t\t},\n\t\t\tset:function(data){\n\t\t\t\tswitch(this.nodeType){\n\t\t\t\tcase ELEMENT_NODE:\n\t\t\t\tcase DOCUMENT_FRAGMENT_NODE:\n\t\t\t\t\twhile(this.firstChild){\n\t\t\t\t\t\tthis.removeChild(this.firstChild);\n\t\t\t\t\t}\n\t\t\t\t\tif(data || String(data)){\n\t\t\t\t\t\tthis.appendChild(this.ownerDocument.createTextNode(data));\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\t//TODO:\n\t\t\t\t\tthis.data = data;\n\t\t\t\t\tthis.value = data;\n\t\t\t\t\tthis.nodeValue = data;\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t\t\n\t\tfunction getTextContent(node){\n\t\t\tswitch(node.nodeType){\n\t\t\tcase ELEMENT_NODE:\n\t\t\tcase DOCUMENT_FRAGMENT_NODE:\n\t\t\t\tvar buf = [];\n\t\t\t\tnode = node.firstChild;\n\t\t\t\twhile(node){\n\t\t\t\t\tif(node.nodeType!==7 && node.nodeType !==8){\n\t\t\t\t\t\tbuf.push(getTextContent(node));\n\t\t\t\t\t}\n\t\t\t\t\tnode = node.nextSibling;\n\t\t\t\t}\n\t\t\t\treturn buf.join('');\n\t\t\tdefault:\n\t\t\t\treturn node.nodeValue;\n\t\t\t}\n\t\t}\n\t\t__set__ = function(object,key,value){\n\t\t\t//console.log(value)\n\t\t\tobject['$$'+key] = value\n\t\t}\n\t}\n}catch(e){//ie8\n}\n\n//if(typeof require == 'function'){\n\texports.DOMImplementation = DOMImplementation;\n\texports.XMLSerializer = XMLSerializer;\n//}\n","/* https://github.com/emn178/js-md5 */\r\n(function () {\r\n    'use strict';\r\n\r\n    var ERROR = 'input is invalid type';\r\n    var WINDOW = typeof window === 'object';\r\n    var root = WINDOW ? window : {};\r\n    if (root.JS_MD5_NO_WINDOW) {\r\n        WINDOW = false;\r\n    }\r\n    var WEB_WORKER = !WINDOW && typeof self === 'object';\r\n    var NODE_JS = !root.JS_MD5_NO_NODE_JS && typeof process === 'object' && process.versions && process.versions.node;\r\n    if (NODE_JS) {\r\n        root = global;\r\n    } else if (WEB_WORKER) {\r\n        root = self;\r\n    }\r\n    var COMMON_JS = !root.JS_MD5_NO_COMMON_JS && typeof module === 'object' && module.exports;\r\n    var AMD = typeof define === 'function' && define.amd;\r\n    var ARRAY_BUFFER = !root.JS_MD5_NO_ARRAY_BUFFER && typeof ArrayBuffer !== 'undefined';\r\n    var HEX_CHARS = '0123456789abcdef'.split('');\r\n    var EXTRA = [128, 32768, 8388608, -2147483648];\r\n    var SHIFT = [0, 8, 16, 24];\r\n    var OUTPUT_TYPES = ['hex', 'array', 'digest', 'buffer', 'arrayBuffer', 'base64'];\r\n    var BASE64_ENCODE_CHAR = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'.split('');\r\n\r\n    var blocks = [], buffer8;\r\n    if (ARRAY_BUFFER) {\r\n        var buffer = new ArrayBuffer(68);\r\n        buffer8 = new Uint8Array(buffer);\r\n        blocks = new Uint32Array(buffer);\r\n    }\r\n\r\n    if (root.JS_MD5_NO_NODE_JS || !Array.isArray) {\r\n        Array.isArray = function (obj) {\r\n            return Object.prototype.toString.call(obj) === '[object Array]';\r\n        };\r\n    }\r\n\r\n    if (ARRAY_BUFFER && (root.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW || !ArrayBuffer.isView)) {\r\n        ArrayBuffer.isView = function (obj) {\r\n            return typeof obj === 'object' && obj.buffer && obj.buffer.constructor === ArrayBuffer;\r\n        };\r\n    }\r\n\r\n    /**\r\n     * @method hex\r\n     * @memberof md5\r\n     * @description Output hash as hex string\r\n     * @param {String|Array|Uint8Array|ArrayBuffer} message message to hash\r\n     * @returns {String} Hex string\r\n     * @example\r\n     * md5.hex('The quick brown fox jumps over the lazy dog');\r\n     * // equal to\r\n     * md5('The quick brown fox jumps over the lazy dog');\r\n     */\r\n    /**\r\n     * @method digest\r\n     * @memberof md5\r\n     * @description Output hash as bytes array\r\n     * @param {String|Array|Uint8Array|ArrayBuffer} message message to hash\r\n     * @returns {Array} Bytes array\r\n     * @example\r\n     * md5.digest('The quick brown fox jumps over the lazy dog');\r\n     */\r\n    /**\r\n     * @method array\r\n     * @memberof md5\r\n     * @description Output hash as bytes array\r\n     * @param {String|Array|Uint8Array|ArrayBuffer} message message to hash\r\n     * @returns {Array} Bytes array\r\n     * @example\r\n     * md5.array('The quick brown fox jumps over the lazy dog');\r\n     */\r\n    /**\r\n     * @method arrayBuffer\r\n     * @memberof md5\r\n     * @description Output hash as ArrayBuffer\r\n     * @param {String|Array|Uint8Array|ArrayBuffer} message message to hash\r\n     * @returns {ArrayBuffer} ArrayBuffer\r\n     * @example\r\n     * md5.arrayBuffer('The quick brown fox jumps over the lazy dog');\r\n     */\r\n    /**\r\n     * @method buffer\r\n     * @deprecated This maybe confuse with Buffer in node.js. Please use arrayBuffer instead.\r\n     * @memberof md5\r\n     * @description Output hash as ArrayBuffer\r\n     * @param {String|Array|Uint8Array|ArrayBuffer} message message to hash\r\n     * @returns {ArrayBuffer} ArrayBuffer\r\n     * @example\r\n     * md5.buffer('The quick brown fox jumps over the lazy dog');\r\n     */\r\n    /**\r\n     * @method base64\r\n     * @memberof md5\r\n     * @description Output hash as base64 string\r\n     * @param {String|Array|Uint8Array|ArrayBuffer} message message to hash\r\n     * @returns {String} base64 string\r\n     * @example\r\n     * md5.base64('The quick brown fox jumps over the lazy dog');\r\n     */\r\n    var createOutputMethod = function (outputType) {\r\n        return function (message, isBinStr) {\r\n            return new Md5(true).update(message, isBinStr)[outputType]();\r\n        };\r\n    };\r\n\r\n    /**\r\n     * @method create\r\n     * @memberof md5\r\n     * @description Create Md5 object\r\n     * @returns {Md5} Md5 object.\r\n     * @example\r\n     * var hash = md5.create();\r\n     */\r\n    /**\r\n     * @method update\r\n     * @memberof md5\r\n     * @description Create and update Md5 object\r\n     * @param {String|Array|Uint8Array|ArrayBuffer} message message to hash\r\n     * @returns {Md5} Md5 object.\r\n     * @example\r\n     * var hash = md5.update('The quick brown fox jumps over the lazy dog');\r\n     * // equal to\r\n     * var hash = md5.create();\r\n     * hash.update('The quick brown fox jumps over the lazy dog');\r\n     */\r\n    var createMethod = function () {\r\n        var method = createOutputMethod('hex');\r\n        if (NODE_JS) {\r\n            method = nodeWrap(method);\r\n        }\r\n        method.getCtx = method.create = function () {\r\n            return new Md5();\r\n        };\r\n        method.update = function (message) {\r\n            return method.create().update(message);\r\n        };\r\n        for (var i = 0; i < OUTPUT_TYPES.length; ++i) {\r\n            var type = OUTPUT_TYPES[i];\r\n            method[type] = createOutputMethod(type);\r\n        }\r\n        return method;\r\n    };\r\n\r\n    var nodeWrap = function (method) {\r\n        var crypto = eval(\"require('crypto')\");\r\n        var Buffer = eval(\"require('buffer').Buffer\");\r\n        var nodeMethod = function (message) {\r\n            if (typeof message === 'string') {\r\n                return crypto.createHash('md5').update(message, 'utf8').digest('hex');\r\n            } else {\r\n                if (message === null || message === undefined) {\r\n                    throw ERROR;\r\n                } else if (message.constructor === ArrayBuffer) {\r\n                    message = new Uint8Array(message);\r\n                }\r\n            }\r\n            if (Array.isArray(message) || ArrayBuffer.isView(message) ||\r\n                message.constructor === Buffer) {\r\n                return crypto.createHash('md5').update(new Buffer(message)).digest('hex');\r\n            } else {\r\n                return method(message);\r\n            }\r\n        };\r\n        return nodeMethod;\r\n    };\r\n\r\n    /**\r\n     * Md5 class\r\n     * @class Md5\r\n     * @description This is internal class.\r\n     * @see {@link md5.create}\r\n     */\r\n    function Md5(sharedMemory) {\r\n        if (sharedMemory) {\r\n            blocks[0] = blocks[16] = blocks[1] = blocks[2] = blocks[3] =\r\n                blocks[4] = blocks[5] = blocks[6] = blocks[7] =\r\n                    blocks[8] = blocks[9] = blocks[10] = blocks[11] =\r\n                        blocks[12] = blocks[13] = blocks[14] = blocks[15] = 0;\r\n            this.blocks = blocks;\r\n            this.buffer8 = buffer8;\r\n        } else {\r\n            if (ARRAY_BUFFER) {\r\n                var buffer = new ArrayBuffer(68);\r\n                this.buffer8 = new Uint8Array(buffer);\r\n                this.blocks = new Uint32Array(buffer);\r\n            } else {\r\n                this.blocks = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n            }\r\n        }\r\n        this.h0 = this.h1 = this.h2 = this.h3 = this.start = this.bytes = this.hBytes = 0;\r\n        this.finalized = this.hashed = false;\r\n        this.first = true;\r\n    }\r\n\r\n    /**\r\n     * @method update\r\n     * @memberof Md5\r\n     * @instance\r\n     * @description Update hash\r\n     * @param {String|Array|Uint8Array|ArrayBuffer} message message to hash\r\n     * @returns {Md5} Md5 object.\r\n     * @see {@link md5.update}\r\n     */\r\n    Md5.prototype.update = function (message, isBinStr) {\r\n        if (this.finalized) {\r\n            return;\r\n        }\r\n        if (typeof message === 'string' && isBinStr) message = decodeURIComponent(escape(message));\r\n\r\n        var notString, type = typeof message;\r\n        if (type !== 'string') {\r\n            if (type === 'object') {\r\n                if (message === null) {\r\n                    throw ERROR;\r\n                } else if (ARRAY_BUFFER && message.constructor === ArrayBuffer) {\r\n                    message = new Uint8Array(message);\r\n                } else if (!Array.isArray(message)) {\r\n                    if (!ARRAY_BUFFER || !ArrayBuffer.isView(message)) {\r\n                        throw ERROR;\r\n                    }\r\n                }\r\n            } else {\r\n                throw ERROR;\r\n            }\r\n            notString = true;\r\n        }\r\n        var code, index = 0, i, length = message.length, blocks = this.blocks;\r\n        var buffer8 = this.buffer8;\r\n\r\n        while (index < length) {\r\n            if (this.hashed) {\r\n                this.hashed = false;\r\n                blocks[0] = blocks[16];\r\n                blocks[16] = blocks[1] = blocks[2] = blocks[3] =\r\n                    blocks[4] = blocks[5] = blocks[6] = blocks[7] =\r\n                        blocks[8] = blocks[9] = blocks[10] = blocks[11] =\r\n                            blocks[12] = blocks[13] = blocks[14] = blocks[15] = 0;\r\n            }\r\n\r\n            if (notString) {\r\n                if (ARRAY_BUFFER) {\r\n                    for (i = this.start; index < length && i < 64; ++index) {\r\n                        buffer8[i++] = message[index];\r\n                    }\r\n                } else {\r\n                    for (i = this.start; index < length && i < 64; ++index) {\r\n                        blocks[i >> 2] |= message[index] << SHIFT[i++ & 3];\r\n                    }\r\n                }\r\n            } else {\r\n                if (ARRAY_BUFFER) {\r\n                    for (i = this.start; index < length && i < 64; ++index) {\r\n                        code = message.charCodeAt(index);\r\n                        if (code < 0x80) {\r\n                            buffer8[i++] = code;\r\n                        } else if (code < 0x800) {\r\n                            buffer8[i++] = 0xc0 | (code >> 6);\r\n                            buffer8[i++] = 0x80 | (code & 0x3f);\r\n                        } else if (code < 0xd800 || code >= 0xe000) {\r\n                            buffer8[i++] = 0xe0 | (code >> 12);\r\n                            buffer8[i++] = 0x80 | ((code >> 6) & 0x3f);\r\n                            buffer8[i++] = 0x80 | (code & 0x3f);\r\n                        } else {\r\n                            code = 0x10000 + (((code & 0x3ff) << 10) | (message.charCodeAt(++index) & 0x3ff));\r\n                            buffer8[i++] = 0xf0 | (code >> 18);\r\n                            buffer8[i++] = 0x80 | ((code >> 12) & 0x3f);\r\n                            buffer8[i++] = 0x80 | ((code >> 6) & 0x3f);\r\n                            buffer8[i++] = 0x80 | (code & 0x3f);\r\n                        }\r\n                    }\r\n                } else {\r\n                    for (i = this.start; index < length && i < 64; ++index) {\r\n                        code = message.charCodeAt(index);\r\n                        if (code < 0x80) {\r\n                            blocks[i >> 2] |= code << SHIFT[i++ & 3];\r\n                        } else if (code < 0x800) {\r\n                            blocks[i >> 2] |= (0xc0 | (code >> 6)) << SHIFT[i++ & 3];\r\n                            blocks[i >> 2] |= (0x80 | (code & 0x3f)) << SHIFT[i++ & 3];\r\n                        } else if (code < 0xd800 || code >= 0xe000) {\r\n                            blocks[i >> 2] |= (0xe0 | (code >> 12)) << SHIFT[i++ & 3];\r\n                            blocks[i >> 2] |= (0x80 | ((code >> 6) & 0x3f)) << SHIFT[i++ & 3];\r\n                            blocks[i >> 2] |= (0x80 | (code & 0x3f)) << SHIFT[i++ & 3];\r\n                        } else {\r\n                            code = 0x10000 + (((code & 0x3ff) << 10) | (message.charCodeAt(++index) & 0x3ff));\r\n                            blocks[i >> 2] |= (0xf0 | (code >> 18)) << SHIFT[i++ & 3];\r\n                            blocks[i >> 2] |= (0x80 | ((code >> 12) & 0x3f)) << SHIFT[i++ & 3];\r\n                            blocks[i >> 2] |= (0x80 | ((code >> 6) & 0x3f)) << SHIFT[i++ & 3];\r\n                            blocks[i >> 2] |= (0x80 | (code & 0x3f)) << SHIFT[i++ & 3];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            this.lastByteIndex = i;\r\n            this.bytes += i - this.start;\r\n            if (i >= 64) {\r\n                this.start = i - 64;\r\n                this.hash();\r\n                this.hashed = true;\r\n            } else {\r\n                this.start = i;\r\n            }\r\n        }\r\n        if (this.bytes > 4294967295) {\r\n            this.hBytes += this.bytes / 4294967296 << 0;\r\n            this.bytes = this.bytes % 4294967296;\r\n        }\r\n        return this;\r\n    };\r\n\r\n    Md5.prototype.finalize = function () {\r\n        if (this.finalized) {\r\n            return;\r\n        }\r\n        this.finalized = true;\r\n        var blocks = this.blocks, i = this.lastByteIndex;\r\n        blocks[i >> 2] |= EXTRA[i & 3];\r\n        if (i >= 56) {\r\n            if (!this.hashed) {\r\n                this.hash();\r\n            }\r\n            blocks[0] = blocks[16];\r\n            blocks[16] = blocks[1] = blocks[2] = blocks[3] =\r\n                blocks[4] = blocks[5] = blocks[6] = blocks[7] =\r\n                    blocks[8] = blocks[9] = blocks[10] = blocks[11] =\r\n                        blocks[12] = blocks[13] = blocks[14] = blocks[15] = 0;\r\n        }\r\n        blocks[14] = this.bytes << 3;\r\n        blocks[15] = this.hBytes << 3 | this.bytes >>> 29;\r\n        this.hash();\r\n    };\r\n\r\n    Md5.prototype.hash = function () {\r\n        var a, b, c, d, bc, da, blocks = this.blocks;\r\n\r\n        if (this.first) {\r\n            a = blocks[0] - 680876937;\r\n            a = (a << 7 | a >>> 25) - 271733879 << 0;\r\n            d = (-1732584194 ^ a & 2004318071) + blocks[1] - 117830708;\r\n            d = (d << 12 | d >>> 20) + a << 0;\r\n            c = (-271733879 ^ (d & (a ^ -271733879))) + blocks[2] - 1126478375;\r\n            c = (c << 17 | c >>> 15) + d << 0;\r\n            b = (a ^ (c & (d ^ a))) + blocks[3] - 1316259209;\r\n            b = (b << 22 | b >>> 10) + c << 0;\r\n        } else {\r\n            a = this.h0;\r\n            b = this.h1;\r\n            c = this.h2;\r\n            d = this.h3;\r\n            a += (d ^ (b & (c ^ d))) + blocks[0] - 680876936;\r\n            a = (a << 7 | a >>> 25) + b << 0;\r\n            d += (c ^ (a & (b ^ c))) + blocks[1] - 389564586;\r\n            d = (d << 12 | d >>> 20) + a << 0;\r\n            c += (b ^ (d & (a ^ b))) + blocks[2] + 606105819;\r\n            c = (c << 17 | c >>> 15) + d << 0;\r\n            b += (a ^ (c & (d ^ a))) + blocks[3] - 1044525330;\r\n            b = (b << 22 | b >>> 10) + c << 0;\r\n        }\r\n\r\n        a += (d ^ (b & (c ^ d))) + blocks[4] - 176418897;\r\n        a = (a << 7 | a >>> 25) + b << 0;\r\n        d += (c ^ (a & (b ^ c))) + blocks[5] + 1200080426;\r\n        d = (d << 12 | d >>> 20) + a << 0;\r\n        c += (b ^ (d & (a ^ b))) + blocks[6] - 1473231341;\r\n        c = (c << 17 | c >>> 15) + d << 0;\r\n        b += (a ^ (c & (d ^ a))) + blocks[7] - 45705983;\r\n        b = (b << 22 | b >>> 10) + c << 0;\r\n        a += (d ^ (b & (c ^ d))) + blocks[8] + 1770035416;\r\n        a = (a << 7 | a >>> 25) + b << 0;\r\n        d += (c ^ (a & (b ^ c))) + blocks[9] - 1958414417;\r\n        d = (d << 12 | d >>> 20) + a << 0;\r\n        c += (b ^ (d & (a ^ b))) + blocks[10] - 42063;\r\n        c = (c << 17 | c >>> 15) + d << 0;\r\n        b += (a ^ (c & (d ^ a))) + blocks[11] - 1990404162;\r\n        b = (b << 22 | b >>> 10) + c << 0;\r\n        a += (d ^ (b & (c ^ d))) + blocks[12] + 1804603682;\r\n        a = (a << 7 | a >>> 25) + b << 0;\r\n        d += (c ^ (a & (b ^ c))) + blocks[13] - 40341101;\r\n        d = (d << 12 | d >>> 20) + a << 0;\r\n        c += (b ^ (d & (a ^ b))) + blocks[14] - 1502002290;\r\n        c = (c << 17 | c >>> 15) + d << 0;\r\n        b += (a ^ (c & (d ^ a))) + blocks[15] + 1236535329;\r\n        b = (b << 22 | b >>> 10) + c << 0;\r\n        a += (c ^ (d & (b ^ c))) + blocks[1] - 165796510;\r\n        a = (a << 5 | a >>> 27) + b << 0;\r\n        d += (b ^ (c & (a ^ b))) + blocks[6] - 1069501632;\r\n        d = (d << 9 | d >>> 23) + a << 0;\r\n        c += (a ^ (b & (d ^ a))) + blocks[11] + 643717713;\r\n        c = (c << 14 | c >>> 18) + d << 0;\r\n        b += (d ^ (a & (c ^ d))) + blocks[0] - 373897302;\r\n        b = (b << 20 | b >>> 12) + c << 0;\r\n        a += (c ^ (d & (b ^ c))) + blocks[5] - 701558691;\r\n        a = (a << 5 | a >>> 27) + b << 0;\r\n        d += (b ^ (c & (a ^ b))) + blocks[10] + 38016083;\r\n        d = (d << 9 | d >>> 23) + a << 0;\r\n        c += (a ^ (b & (d ^ a))) + blocks[15] - 660478335;\r\n        c = (c << 14 | c >>> 18) + d << 0;\r\n        b += (d ^ (a & (c ^ d))) + blocks[4] - 405537848;\r\n        b = (b << 20 | b >>> 12) + c << 0;\r\n        a += (c ^ (d & (b ^ c))) + blocks[9] + 568446438;\r\n        a = (a << 5 | a >>> 27) + b << 0;\r\n        d += (b ^ (c & (a ^ b))) + blocks[14] - 1019803690;\r\n        d = (d << 9 | d >>> 23) + a << 0;\r\n        c += (a ^ (b & (d ^ a))) + blocks[3] - 187363961;\r\n        c = (c << 14 | c >>> 18) + d << 0;\r\n        b += (d ^ (a & (c ^ d))) + blocks[8] + 1163531501;\r\n        b = (b << 20 | b >>> 12) + c << 0;\r\n        a += (c ^ (d & (b ^ c))) + blocks[13] - 1444681467;\r\n        a = (a << 5 | a >>> 27) + b << 0;\r\n        d += (b ^ (c & (a ^ b))) + blocks[2] - 51403784;\r\n        d = (d << 9 | d >>> 23) + a << 0;\r\n        c += (a ^ (b & (d ^ a))) + blocks[7] + 1735328473;\r\n        c = (c << 14 | c >>> 18) + d << 0;\r\n        b += (d ^ (a & (c ^ d))) + blocks[12] - 1926607734;\r\n        b = (b << 20 | b >>> 12) + c << 0;\r\n        bc = b ^ c;\r\n        a += (bc ^ d) + blocks[5] - 378558;\r\n        a = (a << 4 | a >>> 28) + b << 0;\r\n        d += (bc ^ a) + blocks[8] - 2022574463;\r\n        d = (d << 11 | d >>> 21) + a << 0;\r\n        da = d ^ a;\r\n        c += (da ^ b) + blocks[11] + 1839030562;\r\n        c = (c << 16 | c >>> 16) + d << 0;\r\n        b += (da ^ c) + blocks[14] - 35309556;\r\n        b = (b << 23 | b >>> 9) + c << 0;\r\n        bc = b ^ c;\r\n        a += (bc ^ d) + blocks[1] - 1530992060;\r\n        a = (a << 4 | a >>> 28) + b << 0;\r\n        d += (bc ^ a) + blocks[4] + 1272893353;\r\n        d = (d << 11 | d >>> 21) + a << 0;\r\n        da = d ^ a;\r\n        c += (da ^ b) + blocks[7] - 155497632;\r\n        c = (c << 16 | c >>> 16) + d << 0;\r\n        b += (da ^ c) + blocks[10] - 1094730640;\r\n        b = (b << 23 | b >>> 9) + c << 0;\r\n        bc = b ^ c;\r\n        a += (bc ^ d) + blocks[13] + 681279174;\r\n        a = (a << 4 | a >>> 28) + b << 0;\r\n        d += (bc ^ a) + blocks[0] - 358537222;\r\n        d = (d << 11 | d >>> 21) + a << 0;\r\n        da = d ^ a;\r\n        c += (da ^ b) + blocks[3] - 722521979;\r\n        c = (c << 16 | c >>> 16) + d << 0;\r\n        b += (da ^ c) + blocks[6] + 76029189;\r\n        b = (b << 23 | b >>> 9) + c << 0;\r\n        bc = b ^ c;\r\n        a += (bc ^ d) + blocks[9] - 640364487;\r\n        a = (a << 4 | a >>> 28) + b << 0;\r\n        d += (bc ^ a) + blocks[12] - 421815835;\r\n        d = (d << 11 | d >>> 21) + a << 0;\r\n        da = d ^ a;\r\n        c += (da ^ b) + blocks[15] + 530742520;\r\n        c = (c << 16 | c >>> 16) + d << 0;\r\n        b += (da ^ c) + blocks[2] - 995338651;\r\n        b = (b << 23 | b >>> 9) + c << 0;\r\n        a += (c ^ (b | ~d)) + blocks[0] - 198630844;\r\n        a = (a << 6 | a >>> 26) + b << 0;\r\n        d += (b ^ (a | ~c)) + blocks[7] + 1126891415;\r\n        d = (d << 10 | d >>> 22) + a << 0;\r\n        c += (a ^ (d | ~b)) + blocks[14] - 1416354905;\r\n        c = (c << 15 | c >>> 17) + d << 0;\r\n        b += (d ^ (c | ~a)) + blocks[5] - 57434055;\r\n        b = (b << 21 | b >>> 11) + c << 0;\r\n        a += (c ^ (b | ~d)) + blocks[12] + 1700485571;\r\n        a = (a << 6 | a >>> 26) + b << 0;\r\n        d += (b ^ (a | ~c)) + blocks[3] - 1894986606;\r\n        d = (d << 10 | d >>> 22) + a << 0;\r\n        c += (a ^ (d | ~b)) + blocks[10] - 1051523;\r\n        c = (c << 15 | c >>> 17) + d << 0;\r\n        b += (d ^ (c | ~a)) + blocks[1] - 2054922799;\r\n        b = (b << 21 | b >>> 11) + c << 0;\r\n        a += (c ^ (b | ~d)) + blocks[8] + 1873313359;\r\n        a = (a << 6 | a >>> 26) + b << 0;\r\n        d += (b ^ (a | ~c)) + blocks[15] - 30611744;\r\n        d = (d << 10 | d >>> 22) + a << 0;\r\n        c += (a ^ (d | ~b)) + blocks[6] - 1560198380;\r\n        c = (c << 15 | c >>> 17) + d << 0;\r\n        b += (d ^ (c | ~a)) + blocks[13] + 1309151649;\r\n        b = (b << 21 | b >>> 11) + c << 0;\r\n        a += (c ^ (b | ~d)) + blocks[4] - 145523070;\r\n        a = (a << 6 | a >>> 26) + b << 0;\r\n        d += (b ^ (a | ~c)) + blocks[11] - 1120210379;\r\n        d = (d << 10 | d >>> 22) + a << 0;\r\n        c += (a ^ (d | ~b)) + blocks[2] + 718787259;\r\n        c = (c << 15 | c >>> 17) + d << 0;\r\n        b += (d ^ (c | ~a)) + blocks[9] - 343485551;\r\n        b = (b << 21 | b >>> 11) + c << 0;\r\n\r\n        if (this.first) {\r\n            this.h0 = a + 1732584193 << 0;\r\n            this.h1 = b - 271733879 << 0;\r\n            this.h2 = c - 1732584194 << 0;\r\n            this.h3 = d + 271733878 << 0;\r\n            this.first = false;\r\n        } else {\r\n            this.h0 = this.h0 + a << 0;\r\n            this.h1 = this.h1 + b << 0;\r\n            this.h2 = this.h2 + c << 0;\r\n            this.h3 = this.h3 + d << 0;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @method hex\r\n     * @memberof Md5\r\n     * @instance\r\n     * @description Output hash as hex string\r\n     * @returns {String} Hex string\r\n     * @see {@link md5.hex}\r\n     * @example\r\n     * hash.hex();\r\n     */\r\n    Md5.prototype.hex = function () {\r\n        this.finalize();\r\n\r\n        var h0 = this.h0, h1 = this.h1, h2 = this.h2, h3 = this.h3;\r\n\r\n        return HEX_CHARS[(h0 >> 4) & 0x0F] + HEX_CHARS[h0 & 0x0F] +\r\n            HEX_CHARS[(h0 >> 12) & 0x0F] + HEX_CHARS[(h0 >> 8) & 0x0F] +\r\n            HEX_CHARS[(h0 >> 20) & 0x0F] + HEX_CHARS[(h0 >> 16) & 0x0F] +\r\n            HEX_CHARS[(h0 >> 28) & 0x0F] + HEX_CHARS[(h0 >> 24) & 0x0F] +\r\n            HEX_CHARS[(h1 >> 4) & 0x0F] + HEX_CHARS[h1 & 0x0F] +\r\n            HEX_CHARS[(h1 >> 12) & 0x0F] + HEX_CHARS[(h1 >> 8) & 0x0F] +\r\n            HEX_CHARS[(h1 >> 20) & 0x0F] + HEX_CHARS[(h1 >> 16) & 0x0F] +\r\n            HEX_CHARS[(h1 >> 28) & 0x0F] + HEX_CHARS[(h1 >> 24) & 0x0F] +\r\n            HEX_CHARS[(h2 >> 4) & 0x0F] + HEX_CHARS[h2 & 0x0F] +\r\n            HEX_CHARS[(h2 >> 12) & 0x0F] + HEX_CHARS[(h2 >> 8) & 0x0F] +\r\n            HEX_CHARS[(h2 >> 20) & 0x0F] + HEX_CHARS[(h2 >> 16) & 0x0F] +\r\n            HEX_CHARS[(h2 >> 28) & 0x0F] + HEX_CHARS[(h2 >> 24) & 0x0F] +\r\n            HEX_CHARS[(h3 >> 4) & 0x0F] + HEX_CHARS[h3 & 0x0F] +\r\n            HEX_CHARS[(h3 >> 12) & 0x0F] + HEX_CHARS[(h3 >> 8) & 0x0F] +\r\n            HEX_CHARS[(h3 >> 20) & 0x0F] + HEX_CHARS[(h3 >> 16) & 0x0F] +\r\n            HEX_CHARS[(h3 >> 28) & 0x0F] + HEX_CHARS[(h3 >> 24) & 0x0F];\r\n    };\r\n\r\n    /**\r\n     * @method toString\r\n     * @memberof Md5\r\n     * @instance\r\n     * @description Output hash as hex string\r\n     * @returns {String} Hex string\r\n     * @see {@link md5.hex}\r\n     * @example\r\n     * hash.toString();\r\n     */\r\n    Md5.prototype.toString = Md5.prototype.hex;\r\n\r\n    /**\r\n     * @method digest\r\n     * @memberof Md5\r\n     * @instance\r\n     * @description Output hash as bytes array\r\n     * @returns {Array} Bytes array\r\n     * @see {@link md5.digest}\r\n     * @example\r\n     * hash.digest();\r\n     */\r\n    Md5.prototype.digest = function (format) {\r\n        if (format === 'hex') return this.hex();\r\n        this.finalize();\r\n\r\n        var h0 = this.h0, h1 = this.h1, h2 = this.h2, h3 = this.h3;\r\n        var res = [\r\n            h0 & 0xFF, (h0 >> 8) & 0xFF, (h0 >> 16) & 0xFF, (h0 >> 24) & 0xFF,\r\n            h1 & 0xFF, (h1 >> 8) & 0xFF, (h1 >> 16) & 0xFF, (h1 >> 24) & 0xFF,\r\n            h2 & 0xFF, (h2 >> 8) & 0xFF, (h2 >> 16) & 0xFF, (h2 >> 24) & 0xFF,\r\n            h3 & 0xFF, (h3 >> 8) & 0xFF, (h3 >> 16) & 0xFF, (h3 >> 24) & 0xFF\r\n        ];\r\n        return res;\r\n    };\r\n\r\n    /**\r\n     * @method array\r\n     * @memberof Md5\r\n     * @instance\r\n     * @description Output hash as bytes array\r\n     * @returns {Array} Bytes array\r\n     * @see {@link md5.array}\r\n     * @example\r\n     * hash.array();\r\n     */\r\n    Md5.prototype.array = Md5.prototype.digest;\r\n\r\n    /**\r\n     * @method arrayBuffer\r\n     * @memberof Md5\r\n     * @instance\r\n     * @description Output hash as ArrayBuffer\r\n     * @returns {ArrayBuffer} ArrayBuffer\r\n     * @see {@link md5.arrayBuffer}\r\n     * @example\r\n     * hash.arrayBuffer();\r\n     */\r\n    Md5.prototype.arrayBuffer = function () {\r\n        this.finalize();\r\n\r\n        var buffer = new ArrayBuffer(16);\r\n        var blocks = new Uint32Array(buffer);\r\n        blocks[0] = this.h0;\r\n        blocks[1] = this.h1;\r\n        blocks[2] = this.h2;\r\n        blocks[3] = this.h3;\r\n        return buffer;\r\n    };\r\n\r\n    /**\r\n     * @method buffer\r\n     * @deprecated This maybe confuse with Buffer in node.js. Please use arrayBuffer instead.\r\n     * @memberof Md5\r\n     * @instance\r\n     * @description Output hash as ArrayBuffer\r\n     * @returns {ArrayBuffer} ArrayBuffer\r\n     * @see {@link md5.buffer}\r\n     * @example\r\n     * hash.buffer();\r\n     */\r\n    Md5.prototype.buffer = Md5.prototype.arrayBuffer;\r\n\r\n    /**\r\n     * @method base64\r\n     * @memberof Md5\r\n     * @instance\r\n     * @description Output hash as base64 string\r\n     * @returns {String} base64 string\r\n     * @see {@link md5.base64}\r\n     * @example\r\n     * hash.base64();\r\n     */\r\n    Md5.prototype.base64 = function () {\r\n        var v1, v2, v3, base64Str = '', bytes = this.array();\r\n        for (var i = 0; i < 15;) {\r\n            v1 = bytes[i++];\r\n            v2 = bytes[i++];\r\n            v3 = bytes[i++];\r\n            base64Str += BASE64_ENCODE_CHAR[v1 >>> 2] +\r\n                BASE64_ENCODE_CHAR[(v1 << 4 | v2 >>> 4) & 63] +\r\n                BASE64_ENCODE_CHAR[(v2 << 2 | v3 >>> 6) & 63] +\r\n                BASE64_ENCODE_CHAR[v3 & 63];\r\n        }\r\n        v1 = bytes[i];\r\n        base64Str += BASE64_ENCODE_CHAR[v1 >>> 2] +\r\n            BASE64_ENCODE_CHAR[(v1 << 4) & 63] +\r\n            '==';\r\n        return base64Str;\r\n    };\r\n\r\n    var exports = createMethod();\r\n\r\n    if (COMMON_JS) {\r\n        module.exports = exports;\r\n    } else {\r\n        /**\r\n         * @method md5\b\r\n         * @description Md5 hash function, export to global in browsers.\r\n         * @param {String|Array|Uint8Array|ArrayBuffer} message message to hash\r\n         * @returns {String} md5 hashes\r\n         * @example\r\n         * md5(''); // d41d8cd98f00b204e9800998ecf8427e\r\n         * md5('The quick brown fox jumps over the lazy dog'); // 9e107d9d372bb6826bd81d3542a419d6\r\n         * md5('The quick brown fox jumps over the lazy dog.'); // e4d909c290d0fb1ca068ffaddf22cbd0\r\n         *\r\n         * // It also supports UTF-8 encoding\r\n         * md5(''); // a7bac2239fcdcb3a067903d8077c4a07\r\n         *\r\n         * // It also supports byte `Array`, `Uint8Array`, `ArrayBuffer`\r\n         * md5([]); // d41d8cd98f00b204e9800998ecf8427e\r\n         * md5(new Uint8Array([])); // d41d8cd98f00b204e9800998ecf8427e\r\n         */\r\n        root.md5 = exports;\r\n        if (AMD) {\r\n            define(function () {\r\n                return exports;\r\n            });\r\n        }\r\n    }\r\n})();\r\n","var REQUEST = require('../lib/request');\r\nvar util = require('./util');\r\n\r\n\r\n// Bucket \r\n\r\n/**\r\n *  bucket \r\n * @param  {Object}  params         \r\n * \r\n * @param  {Function}  callback     \r\n */\r\nfunction getService(params, callback) {\r\n\r\n    if (typeof params === 'function') {\r\n        callback = params;\r\n        params = {};\r\n    }\r\n    var protocol = this.options.Protocol || (util.isBrowser && location.protocol === 'http:' ? 'http:' : 'https:');\r\n    var domain = this.options.ServiceDomain;\r\n    var appId = params.AppId || this.options.appId;\r\n    var region = params.Region;\r\n    if (domain) {\r\n        domain = domain.replace(/\\{\\{AppId\\}\\}/ig, appId || '')\r\n            .replace(/\\{\\{Region\\}\\}/ig, region || '').replace(/\\{\\{.*?\\}\\}/ig, '');\r\n        if (!/^[a-zA-Z]+:\\/\\//.test(domain)) {\r\n            domain = protocol + '//' + domain;\r\n        }\r\n        if (domain.slice(-1) === '/') {\r\n            domain = domain.slice(0, -1);\r\n        }\r\n    } else if (region) {\r\n        domain = protocol + '//cos.' + region + '.myqcloud.com';\r\n    } else {\r\n        domain = protocol + '//service.cos.myqcloud.com';\r\n    }\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetService',\r\n        url: domain,\r\n        method: 'GET',\r\n        headers: params.Headers,\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n        var buckets = (data && data.ListAllMyBucketsResult && data.ListAllMyBucketsResult.Buckets\r\n            && data.ListAllMyBucketsResult.Buckets.Bucket) || [];\r\n        buckets = util.isArray(buckets) ? buckets : [buckets];\r\n        var owner = (data && data.ListAllMyBucketsResult && data.ListAllMyBucketsResult.Owner) || {};\r\n        callback(null, {\r\n            Buckets: buckets,\r\n            Owner: owner,\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket\r\n * @param  {Object}  params                         \r\n *     @param  {String}  params.Bucket              Bucket\r\n *     @param  {String}  params.Region              \r\n *     @param  {String}  params.ACL                 privatepublic-readprivate\r\n *     @param  {String}  params.GrantRead           x-cos-grant-read: uin=\" \",uin=\" \"\r\n *     @param  {String}  params.GrantWrite          x-cos-grant-write: uin=\" \",uin=\" \"\r\n *     @param  {String}  params.GrantFullControl    x-cos-grant-full-control: uin=\" \",uin=\" \"\r\n * @param  {Function}  callback                     \r\n * @return  {Object}  err                           https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                          \r\n *     @return  {String}  data.Location             \r\n */\r\nfunction putBucket(params, callback) {\r\n\r\n    var self = this;\r\n\r\n    var xml = '';\r\n    if(params['BucketAZConfig']){\r\n        var CreateBucketConfiguration = {\r\n            BucketAZConfig: params.BucketAZConfig\r\n        };\r\n        xml = util.json2xml({CreateBucketConfiguration: CreateBucketConfiguration});\r\n    }\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:PutBucket',\r\n        method: 'PUT',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        body: xml,\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n        var url = getUrl({\r\n            protocol: self.options.Protocol,\r\n            domain: self.options.Domain,\r\n            bucket: params.Bucket,\r\n            region: params.Region,\r\n            isLocation: true,\r\n        });\r\n        callback(null, {\r\n            Location: url,\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n * Bucket\r\n * @param  {Object}  params                     \r\n *     @param  {String}  params.Bucket          Bucket\r\n *     @param  {String}  params.Region          \r\n * @param  {Function}  callback                 \r\n * @return  {Object}  err                       https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                      \r\n *     @return  {Boolean}  data.BucketExist     Bucket\r\n *     @return  {Boolean}  data.BucketAuth       Bucket \r\n */\r\nfunction headBucket(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:HeadBucket',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        method: 'HEAD',\r\n    }, function (err, data) {\r\n        callback(err, data);\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket  object \r\n * @param  {Object}  params                         \r\n *     @param  {String}  params.Bucket              Bucket\r\n *     @param  {String}  params.Region              \r\n *     @param  {String}  params.Prefix              \r\n *     @param  {String}  params.Delimiter           PrefixPrefixdelimiter\r\n *     @param  {String}  params.Marker              UTF-8marker\r\n *     @param  {String}  params.MaxKeys             1000\r\n *     @param  {String}  params.EncodingType        \r\n * @param  {Function}  callback                     \r\n * @return  {Object}  err                           https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                          \r\n *     @return  {Object}  data.ListBucketResult      object \r\n */\r\nfunction getBucket(params, callback) {\r\n    var reqParams = {};\r\n    reqParams['prefix'] = params['Prefix'] || '';\r\n    reqParams['delimiter'] = params['Delimiter'];\r\n    reqParams['marker'] = params['Marker'];\r\n    reqParams['max-keys'] = params['MaxKeys'];\r\n    reqParams['encoding-type'] = params['EncodingType'];\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetBucket',\r\n        ResourceKey: reqParams['prefix'],\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        qs: reqParams,\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n        var ListBucketResult = data.ListBucketResult || {};\r\n        var Contents = ListBucketResult.Contents || [];\r\n        var CommonPrefixes = ListBucketResult.CommonPrefixes || [];\r\n\r\n        Contents = util.isArray(Contents) ? Contents : [Contents];\r\n        CommonPrefixes = util.isArray(CommonPrefixes) ? CommonPrefixes : [CommonPrefixes];\r\n\r\n        var result = util.clone(ListBucketResult);\r\n        util.extend(result, {\r\n            Contents: Contents,\r\n            CommonPrefixes: CommonPrefixes,\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n\r\n        callback(null, result);\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket\r\n * @param  {Object}  params                 \r\n *     @param  {String}  params.Bucket      Bucket\r\n *     @param  {String}  params.Region      \r\n * @param  {Function}  callback             \r\n * @return  {Object}  err                   https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                  \r\n *     @return  {String}  data.Location     \r\n */\r\nfunction deleteBucket(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:DeleteBucket',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        method: 'DELETE',\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket  \r\n * @param  {Object}  params                         \r\n *     @param  {String}  params.Bucket              Bucket\r\n *     @param  {String}  params.Region              \r\n *     @param  {String}  params.ACL                 privatepublic-readprivate\r\n *     @param  {String}  params.GrantRead           x-cos-grant-read: uin=\" \",uin=\" \"\r\n *     @param  {String}  params.GrantWrite          x-cos-grant-write: uin=\" \",uin=\" \"\r\n *     @param  {String}  params.GrantFullControl    x-cos-grant-full-control: uin=\" \",uin=\" \"\r\n * @param  {Function}  callback                     \r\n * @return  {Object}  err                           https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                          \r\n */\r\nfunction putBucketAcl(params, callback) {\r\n    var headers = params.Headers;\r\n\r\n    var xml = '';\r\n    if (params['AccessControlPolicy']) {\r\n        var AccessControlPolicy = util.clone(params['AccessControlPolicy'] || {});\r\n        var Grants = AccessControlPolicy.Grants || AccessControlPolicy.Grant;\r\n        Grants = util.isArray(Grants) ? Grants : [Grants];\r\n        delete AccessControlPolicy.Grant;\r\n        delete AccessControlPolicy.Grants;\r\n        AccessControlPolicy.AccessControlList = {Grant: Grants};\r\n        xml = util.json2xml({AccessControlPolicy: AccessControlPolicy});\r\n\r\n        headers['Content-Type'] = 'application/xml';\r\n        headers['Content-MD5'] = util.binaryBase64(util.md5(xml));\r\n    }\r\n\r\n    // Grant Header \r\n    util.each(headers, function (val, key) {\r\n        if (key.indexOf('x-cos-grant-') === 0) {\r\n            headers[key] = uniqGrant(headers[key]);\r\n        }\r\n    });\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:PutBucketACL',\r\n        method: 'PUT',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: headers,\r\n        action: 'acl',\r\n        body: xml,\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket  \r\n * @param  {Object}  params                         \r\n *     @param  {String}  params.Bucket              Bucket\r\n *     @param  {String}  params.Region              \r\n * @param  {Function}  callback                     \r\n * @return  {Object}  err                           https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                          \r\n *     @return  {Object}  data.AccessControlPolicy  \r\n */\r\nfunction getBucketAcl(params, callback) {\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetBucketACL',\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'acl',\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n        var AccessControlPolicy = data.AccessControlPolicy || {};\r\n        var Owner = AccessControlPolicy.Owner || {};\r\n        var Grant = AccessControlPolicy.AccessControlList.Grant || [];\r\n        Grant = util.isArray(Grant) ? Grant : [Grant];\r\n        var result = decodeAcl(AccessControlPolicy);\r\n        if (data.headers && data.headers['x-cos-acl']) {\r\n            result.ACL = data.headers['x-cos-acl'];\r\n        }\r\n        result = util.extend(result, {\r\n            Owner: Owner,\r\n            Grants: Grant,\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n        callback(null, result);\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket  \r\n * @param  {Object}  params                             \r\n *     @param  {String}  params.Bucket                  Bucket\r\n *     @param  {String}  params.Region                  \r\n *     @param  {Object}  params.CORSConfiguration       \r\n * @param  {Array}  params.CORSConfiguration.CORSRules  \r\n * @param  {Function}  callback                         \r\n * @return  {Object}  err                               https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                              \r\n */\r\nfunction putBucketCors(params, callback) {\r\n\r\n    var CORSConfiguration = params['CORSConfiguration'] || {};\r\n    var CORSRules = CORSConfiguration['CORSRules'] || params['CORSRules'] || [];\r\n    CORSRules = util.clone(util.isArray(CORSRules) ? CORSRules : [CORSRules]);\r\n    util.each(CORSRules, function (rule) {\r\n        util.each(['AllowedOrigin', 'AllowedHeader', 'AllowedMethod', 'ExposeHeader'], function (key) {\r\n            var sKey = key + 's';\r\n            var val = rule[sKey] || rule[key] || [];\r\n            delete rule[sKey];\r\n            rule[key] = util.isArray(val) ? val : [val];\r\n        });\r\n    });\r\n\r\n    var xml = util.json2xml({CORSConfiguration: {CORSRule: CORSRules}});\r\n\r\n    var headers = params.Headers;\r\n    headers['Content-Type'] = 'application/xml';\r\n    headers['Content-MD5'] = util.binaryBase64(util.md5(xml));\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:PutBucketCORS',\r\n        method: 'PUT',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        body: xml,\r\n        action: 'cors',\r\n        headers: headers,\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket  \r\n * @param  {Object}  params                         \r\n *     @param  {String}  params.Bucket              Bucket\r\n *     @param  {String}  params.Region              \r\n * @param  {Function}  callback                     \r\n * @return  {Object}  err                           https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                          \r\n *     @return  {Object}  data.CORSRules            Bucket\r\n */\r\nfunction getBucketCors(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetBucketCORS',\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'cors',\r\n    }, function (err, data) {\r\n        if (err) {\r\n            if (err.statusCode === 404 && err.error && err.error.Code === 'NoSuchCORSConfiguration') {\r\n                var result = {\r\n                    CORSRules: [],\r\n                    statusCode: err.statusCode,\r\n                };\r\n                err.headers && (result.headers = err.headers);\r\n                callback(null, result);\r\n            } else {\r\n                callback(err);\r\n            }\r\n            return;\r\n        }\r\n        var CORSConfiguration = data.CORSConfiguration || {};\r\n        var CORSRules = CORSConfiguration.CORSRules || CORSConfiguration.CORSRule || [];\r\n        CORSRules = util.clone(util.isArray(CORSRules) ? CORSRules : [CORSRules]);\r\n\r\n        util.each(CORSRules, function (rule) {\r\n            util.each(['AllowedOrigin', 'AllowedHeader', 'AllowedMethod', 'ExposeHeader'], function (key) {\r\n                var sKey = key + 's';\r\n                var val = rule[sKey] || rule[key] || [];\r\n                delete rule[key];\r\n                rule[sKey] = util.isArray(val) ? val : [val];\r\n            });\r\n        });\r\n\r\n        callback(null, {\r\n            CORSRules: CORSRules,\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket  \r\n * @param  {Object}  params                 \r\n *     @param  {String}  params.Bucket      Bucket\r\n *     @param  {String}  params.Region      \r\n * @param  {Function}  callback             \r\n * @return  {Object}  err                   https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                  \r\n */\r\nfunction deleteBucketCors(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:DeleteBucketCORS',\r\n        method: 'DELETE',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'cors',\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode || err.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket  \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Bucket  Bucket\r\n *     @param  {String}  params.Region  \r\n * @param  {Function}  callback         \r\n * @return  {Object}  err               https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data               LocationConstraint\r\n */\r\nfunction getBucketLocation(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetBucketLocation',\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'location',\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n        callback(null, data);\r\n    });\r\n}\r\n\r\nfunction putBucketPolicy(params, callback) {\r\n    var PolicyStr = params['Policy'];\r\n    if (typeof PolicyStr !== 'string') PolicyStr = JSON.stringify(PolicyStr);\r\n\r\n    var headers = params.Headers;\r\n    headers['Content-Type'] = 'application/json';\r\n    headers['Content-MD5'] = util.binaryBase64(util.md5(PolicyStr));\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:PutBucketPolicy',\r\n        method: 'PUT',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        action: 'policy',\r\n        body: PolicyStr,\r\n        headers: headers,\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Bucket  Bucket\r\n *     @param  {String}  params.Region  \r\n * @param  {Function}  callback         \r\n * @return  {Object}  err               https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data              \r\n */\r\nfunction getBucketPolicy(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetBucketPolicy',\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'policy',\r\n        rawBody: true,\r\n    }, function (err, data) {\r\n        if (err) {\r\n            if (err.statusCode && err.statusCode === 403) {\r\n                return callback({ErrorStatus: 'Access Denied'});\r\n            }\r\n            if (err.statusCode && err.statusCode === 405) {\r\n                return callback({ErrorStatus: 'Method Not Allowed'});\r\n            }\r\n            if (err.statusCode && err.statusCode === 404) {\r\n                return callback({ErrorStatus: 'Policy Not Found'});\r\n            }\r\n            return callback(err);\r\n        }\r\n        var Policy = {};\r\n        try {\r\n            Policy = JSON.parse(data.body);\r\n        } catch (e) {\r\n        }\r\n        callback(null, {\r\n            Policy: Policy,\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket  \r\n * @param  {Object}  params                 \r\n *     @param  {String}  params.Bucket      Bucket\r\n *     @param  {String}  params.Region      \r\n * @param  {Function}  callback             \r\n * @return  {Object}  err                   https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                  \r\n */\r\nfunction deleteBucketPolicy(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:DeleteBucketPolicy',\r\n        method: 'DELETE',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'policy',\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode || err.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Bucket  Bucket\r\n *     @param  {String}  params.Region  \r\n *     @param  {Array}   params.TagSet  \r\n * @param  {Function}  callback         \r\n * @return  {Object}  err               https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data              \r\n */\r\nfunction putBucketTagging(params, callback) {\r\n\r\n    var Tagging = params['Tagging'] || {};\r\n    var Tags = Tagging.TagSet || Tagging.Tags || params['Tags'] || [];\r\n    Tags = util.clone(util.isArray(Tags) ? Tags : [Tags]);\r\n    var xml = util.json2xml({Tagging: {TagSet: {Tag: Tags}}});\r\n\r\n    var headers = params.Headers;\r\n    headers['Content-Type'] = 'application/xml';\r\n    headers['Content-MD5'] = util.binaryBase64(util.md5(xml));\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:PutBucketTagging',\r\n        method: 'PUT',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        body: xml,\r\n        action: 'tagging',\r\n        headers: headers,\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Bucket  Bucket\r\n *     @param  {String}  params.Region  \r\n * @param  {Function}  callback         \r\n * @return  {Object}  err               https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data              \r\n */\r\nfunction getBucketTagging(params, callback) {\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetBucketTagging',\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'tagging',\r\n    }, function (err, data) {\r\n        if (err) {\r\n            if (err.statusCode === 404 && err.error && (err.error === \"Not Found\" || err.error.Code === 'NoSuchTagSet')) {\r\n                var result = {\r\n                    Tags: [],\r\n                    statusCode: err.statusCode,\r\n                };\r\n                err.headers && (result.headers = err.headers);\r\n                callback(null, result);\r\n            } else {\r\n                callback(err);\r\n            }\r\n            return;\r\n        }\r\n        var Tags = [];\r\n        try {\r\n            Tags = data.Tagging.TagSet.Tag || [];\r\n        } catch (e) {\r\n        }\r\n        Tags = util.clone(util.isArray(Tags) ? Tags : [Tags]);\r\n        callback(null, {\r\n            Tags: Tags,\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket  \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Bucket  Bucket\r\n *     @param  {String}  params.Region  \r\n * @param  {Function}  callback         \r\n * @return  {Object}  err               https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data              \r\n */\r\nfunction deleteBucketTagging(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:DeleteBucketTagging',\r\n        method: 'DELETE',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'tagging',\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\nfunction putBucketLifecycle(params, callback) {\r\n\r\n    var LifecycleConfiguration = params['LifecycleConfiguration'] || {};\r\n    var Rules = LifecycleConfiguration.Rules || params.Rules || [];\r\n    Rules = util.clone(Rules);\r\n    var xml = util.json2xml({LifecycleConfiguration: {Rule: Rules}});\r\n\r\n    var headers = params.Headers;\r\n    headers['Content-Type'] = 'application/xml';\r\n    headers['Content-MD5'] = util.binaryBase64(util.md5(xml));\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:PutBucketLifecycle',\r\n        method: 'PUT',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        body: xml,\r\n        action: 'lifecycle',\r\n        headers: headers,\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\nfunction getBucketLifecycle(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetBucketLifecycle',\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'lifecycle',\r\n    }, function (err, data) {\r\n        if (err) {\r\n            if (err.statusCode === 404 && err.error && err.error.Code === 'NoSuchLifecycleConfiguration') {\r\n                var result = {\r\n                    Rules: [],\r\n                    statusCode: err.statusCode,\r\n                };\r\n                err.headers && (result.headers = err.headers);\r\n                callback(null, result);\r\n            } else {\r\n                callback(err);\r\n            }\r\n            return;\r\n        }\r\n        var Rules = [];\r\n        try {\r\n            Rules = data.LifecycleConfiguration.Rule || [];\r\n        } catch (e) {\r\n        }\r\n        Rules = util.clone(util.isArray(Rules) ? Rules : [Rules]);\r\n        callback(null, {\r\n            Rules: Rules,\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\nfunction deleteBucketLifecycle(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:DeleteBucketLifecycle',\r\n        method: 'DELETE',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'lifecycle',\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\nfunction putBucketVersioning(params, callback) {\r\n\r\n    if (!params['VersioningConfiguration']) {\r\n        callback({error: 'missing param VersioningConfiguration'});\r\n        return;\r\n    }\r\n    var VersioningConfiguration = params['VersioningConfiguration'] || {};\r\n    var xml = util.json2xml({VersioningConfiguration: VersioningConfiguration});\r\n\r\n    var headers = params.Headers;\r\n    headers['Content-Type'] = 'application/xml';\r\n    headers['Content-MD5'] = util.binaryBase64(util.md5(xml));\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:PutBucketVersioning',\r\n        method: 'PUT',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        body: xml,\r\n        action: 'versioning',\r\n        headers: headers,\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\nfunction getBucketVersioning(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetBucketVersioning',\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'versioning',\r\n    }, function (err, data) {\r\n        if (!err) {\r\n            !data.VersioningConfiguration && (data.VersioningConfiguration = {});\r\n        }\r\n        callback(err, data);\r\n    });\r\n}\r\n\r\nfunction putBucketReplication(params, callback) {\r\n    var ReplicationConfiguration = util.clone(params.ReplicationConfiguration);\r\n    var xml = util.json2xml({ReplicationConfiguration: ReplicationConfiguration});\r\n    xml = xml.replace(/<(\\/?)Rules>/ig, '<$1Rule>');\r\n    xml = xml.replace(/<(\\/?)Tags>/ig, '<$1Tag>');\r\n\r\n    var headers = params.Headers;\r\n    headers['Content-Type'] = 'application/xml';\r\n    headers['Content-MD5'] = util.binaryBase64(util.md5(xml));\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:PutBucketReplication',\r\n        method: 'PUT',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        body: xml,\r\n        action: 'replication',\r\n        headers: headers,\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\nfunction getBucketReplication(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetBucketReplication',\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'replication',\r\n    }, function (err, data) {\r\n        if (err) {\r\n            if (err.statusCode === 404 && err.error && (err.error === 'Not Found' || err.error.Code === 'ReplicationConfigurationnotFoundError')) {\r\n                var result = {\r\n                    ReplicationConfiguration: {Rules: []},\r\n                    statusCode: err.statusCode,\r\n                };\r\n                err.headers && (result.headers = err.headers);\r\n                callback(null, result);\r\n            } else {\r\n                callback(err);\r\n            }\r\n            return;\r\n        }\r\n        if (!err) {\r\n            !data.ReplicationConfiguration && (data.ReplicationConfiguration = {});\r\n        }\r\n        if (data.ReplicationConfiguration.Rule) {\r\n            data.ReplicationConfiguration.Rules = data.ReplicationConfiguration.Rule;\r\n            delete data.ReplicationConfiguration.Rule;\r\n        }\r\n        callback(err, data);\r\n    });\r\n}\r\n\r\nfunction deleteBucketReplication(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:DeleteBucketReplication',\r\n        method: 'DELETE',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'replication',\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket \r\n * @param  {Object}  params                                                 \r\n *     @param  {String}  params.Bucket                                      Bucket\r\n *     @param  {String}  params.Region                                      \r\n *     @param  {Object}  params.WebsiteConfiguration                        \r\n *         @param  {Object}   WebsiteConfiguration.IndexDocument            \r\n *         @param  {Object}   WebsiteConfiguration.ErrorDocument            \r\n *         @param  {Object}   WebsiteConfiguration.RedirectAllRequestsTo    \r\n *         @param  {Array}   params.RoutingRules                            \r\n * @param  {Function}  callback                                             \r\n * @return  {Object}  err                                                   https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                                                  \r\n */\r\nfunction putBucketWebsite(params, callback) {\r\n\r\n    if (!params['WebsiteConfiguration']) {\r\n        callback({ error: 'missing param WebsiteConfiguration' });\r\n        return;\r\n    }\r\n\r\n    var WebsiteConfiguration = util.clone(params['WebsiteConfiguration'] || {});\r\n    var RoutingRules = WebsiteConfiguration['RoutingRules'] || WebsiteConfiguration['RoutingRule'] || [];\r\n    RoutingRules = util.isArray(RoutingRules) ? RoutingRules : [RoutingRules];\r\n    delete WebsiteConfiguration.RoutingRule;\r\n    delete WebsiteConfiguration.RoutingRules;\r\n    if (RoutingRules.length) WebsiteConfiguration.RoutingRules = { RoutingRule: RoutingRules };\r\n    var xml = util.json2xml({ WebsiteConfiguration: WebsiteConfiguration });\r\n\r\n    var headers = params.Headers;\r\n    headers['Content-Type'] = 'application/xml';\r\n    headers['Content-MD5'] = util.binaryBase64(util.md5(xml));\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:PutBucketWebsite',\r\n        method: 'PUT',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        body: xml,\r\n        action: 'website',\r\n        headers: headers,\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Bucket  Bucket\r\n *     @param  {String}  params.Region  \r\n * @param  {Function}  callback         \r\n * @return  {Object}  err               https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data              \r\n */\r\nfunction getBucketWebsite(params, callback) {\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetBucketWebsite',\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        Key: params.Key,\r\n        headers: params.Headers,\r\n        action: 'website',\r\n    }, function (err, data) {\r\n        if (err) {\r\n            if(err.statusCode === 404 && err.error.Code === 'NoSuchWebsiteConfiguration'){\r\n                var result = {\r\n                    WebsiteConfiguration: {},\r\n                    statusCode: err.statusCode,\r\n                };\r\n                err.headers && (result.headers = err.headers);\r\n                callback(null, result);\r\n            } else {\r\n                callback(err);\r\n            }\r\n            return;\r\n        }\r\n\r\n        var WebsiteConfiguration = data.WebsiteConfiguration || {};\r\n        if (WebsiteConfiguration['RoutingRules']) {\r\n            var RoutingRules = util.clone(WebsiteConfiguration['RoutingRules'].RoutingRule || []);\r\n            RoutingRules = util.makeArray(RoutingRules);\r\n            WebsiteConfiguration.RoutingRules = RoutingRules;\r\n        }\r\n\r\n        callback(null, {\r\n            WebsiteConfiguration: WebsiteConfiguration,\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Bucket  Bucket\r\n *     @param  {String}  params.Region  \r\n * @param  {Function}  callback         \r\n * @return  {Object}  err               https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data              \r\n */\r\nfunction deleteBucketWebsite(params, callback) {\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:DeleteBucketWebsite',\r\n        method: 'DELETE',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'website',\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket \r\n * @param  {Object}  params                                                 \r\n *     @param  {String}  params.Bucket                                      Bucket\r\n *     @param  {String}  params.Region                                      \r\n *     @param  {Object}  params.RefererConfiguration                        \r\n *         @param  {String}   RefererConfiguration.Status                   EnabledDisabled\r\n *         @param  {String}   RefererConfiguration.RefererType              Black-ListWhite-List\r\n *         @param  {Array}   RefererConfiguration.DomianList.Domain         \r\n *         @param  {String}   RefererConfiguration.EmptyReferConfiguration  \r\n * @param  {Function}  callback                                             \r\n * @return  {Object}  err                                                   https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                                                  \r\n */\r\nfunction putBucketReferer(params, callback) {\r\n\r\n    if (!params['RefererConfiguration']) {\r\n        callback({ error: 'missing param RefererConfiguration' });\r\n        return;\r\n    }\r\n\r\n    var RefererConfiguration = util.clone(params['RefererConfiguration'] || {});\r\n    var DomainList = RefererConfiguration['DomainList'] || {};\r\n    var Domains = DomainList['Domains'] || DomainList['Domain'] || [];\r\n    Domains = util.isArray(Domains) ? Domains : [Domains];\r\n    if (Domains.length) RefererConfiguration.DomainList = {Domain: Domains};\r\n    var xml = util.json2xml({ RefererConfiguration: RefererConfiguration });\r\n\r\n    var headers = params.Headers;\r\n    headers['Content-Type'] = 'application/xml';\r\n    headers['Content-MD5'] = util.binaryBase64(util.md5(xml));\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:PutBucketReferer',\r\n        method: 'PUT',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        body: xml,\r\n        action: 'referer',\r\n        headers: headers,\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Bucket  Bucket\r\n *     @param  {String}  params.Region  \r\n * @param  {Function}  callback         \r\n * @return  {Object}  err               https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data              \r\n */\r\nfunction getBucketReferer(params, callback) {\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetBucketReferer',\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        Key: params.Key,\r\n        headers: params.Headers,\r\n        action: 'referer',\r\n    }, function (err, data) {\r\n        if (err) {\r\n            if(err.statusCode === 404 && err.error.Code === 'NoSuchRefererConfiguration'){\r\n                var result = {\r\n                    WebsiteConfiguration: {},\r\n                    statusCode: err.statusCode,\r\n                };\r\n                err.headers && (result.headers = err.headers);\r\n                callback(null, result);\r\n            } else {\r\n                callback(err);\r\n            }\r\n            return;\r\n        }\r\n\r\n        var RefererConfiguration = data.RefererConfiguration || {};\r\n        if (RefererConfiguration['DomainList']) {\r\n            var Domains = util.clone(RefererConfiguration['DomainList'].Domain || []);\r\n            Domains = util.makeArray(Domains);\r\n            RefererConfiguration.DomainList = {Domains: Domains};\r\n        }\r\n\r\n        callback(null, {\r\n            RefererConfiguration: RefererConfiguration,\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket \r\n * @param  {Object}  params                                                 \r\n *     @param  {String}  params.Bucket                                      Bucket\r\n *     @param  {String}  params.Region                                      \r\n * @param  {Function}  callback                                             \r\n * @return  {Object}  err                                                   https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                                                  \r\n */\r\nfunction putBucketDomain(params, callback) {\r\n\r\n    var DomainConfiguration = params['DomainConfiguration'] || {};\r\n    var DomainRule = DomainConfiguration.DomainRule || params.DomainRule || [];\r\n    DomainRule = util.clone(DomainRule);\r\n    var xml = util.json2xml({DomainConfiguration: {DomainRule: DomainRule}});\r\n\r\n    var headers = params.Headers;\r\n    headers['Content-Type'] = 'application/xml';\r\n    headers['Content-MD5'] = util.binaryBase64(util.md5(xml));\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:PutBucketDomain',\r\n        method: 'PUT',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        body: xml,\r\n        action: 'domain',\r\n        headers: headers,\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Bucket  Bucket\r\n *     @param  {String}  params.Region  \r\n * @param  {Function}  callback         \r\n * @return  {Object}  err               https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data              \r\n */\r\nfunction getBucketDomain(params, callback) {\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetBucketDomain',\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'domain',\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n\r\n        var DomainRule = [];\r\n        try {\r\n            DomainRule = data.DomainConfiguration.DomainRule || [];\r\n        } catch (e) {\r\n        }\r\n        DomainRule = util.clone(util.isArray(DomainRule) ? DomainRule : [DomainRule]);\r\n        callback(null, {\r\n            DomainRule: DomainRule,\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Bucket  Bucket\r\n *     @param  {String}  params.Region  \r\n * @param  {Function}  callback         \r\n * @return  {Object}  err               https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data              \r\n */\r\nfunction deleteBucketDomain(params, callback) {\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:DeleteBucketDomain',\r\n        method: 'DELETE',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'domain',\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket \r\n * @param  {Object}  params                                                 \r\n *     @param  {String}  params.Bucket                                      Bucket\r\n *     @param  {String}  params.Region                                      \r\n * @param  {Function}  callback                                             \r\n * @return  {Object}  err                                                   https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                                                  \r\n */\r\nfunction putBucketOrigin(params, callback){\r\n    var OriginConfiguration = params['OriginConfiguration'] || {};\r\n    var OriginRule = OriginConfiguration.OriginRule || params.OriginRule || [];\r\n    OriginRule = util.clone(OriginRule);\r\n    var xml = util.json2xml({OriginConfiguration: {OriginRule: OriginRule}});\r\n\r\n    var headers = params.Headers;\r\n    headers['Content-Type'] = 'application/xml';\r\n    headers['Content-MD5'] = util.binaryBase64(util.md5(xml));\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:PutBucketOrigin',\r\n        method: 'PUT',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        body: xml,\r\n        action: 'origin',\r\n        headers: headers,\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Bucket  Bucket\r\n *     @param  {String}  params.Region  \r\n * @param  {Function}  callback         \r\n * @return  {Object}  err               https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data              \r\n */\r\nfunction getBucketOrigin(params, callback) {\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetBucketOrigin',\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'origin',\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n\r\n        var OriginRule = [];\r\n        try {\r\n            OriginRule = data.OriginConfiguration.OriginRule || [];\r\n        } catch (e) {\r\n        }\r\n        OriginRule = util.clone(util.isArray(OriginRule) ? OriginRule : [OriginRule]);\r\n        callback(null, {\r\n            OriginRule: OriginRule,\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Bucket  Bucket\r\n *     @param  {String}  params.Region  \r\n * @param  {Function}  callback         \r\n * @return  {Object}  err               https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data              \r\n */\r\nfunction deleteBucketOrigin(params, callback) {\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:DeleteBucketOrigin',\r\n        method: 'DELETE',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'origin',\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket \r\n * @param  {Object}  params                                                 \r\n *     @param  {String}  params.Bucket                                      Bucket\r\n *     @param  {String}  params.Region                                      \r\n *     @param  {(Object|String)}  params.BucketLoggingStatus                         \r\n * @param  {Function}  callback                                             \r\n * @return  {Object}  err                                                   https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                                                  \r\n */\r\nfunction putBucketLogging(params, callback) {\r\n    var xml = util.json2xml({\r\n        BucketLoggingStatus: params['BucketLoggingStatus'] || ''\r\n    });\r\n\r\n    var headers = params.Headers;\r\n    headers['Content-Type'] = 'application/xml';\r\n    headers['Content-MD5'] = util.binaryBase64(util.md5(xml));\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:PutBucketLogging',\r\n        method: 'PUT',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        body: xml,\r\n        action: 'logging',\r\n        headers: headers,\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Bucket  Bucket\r\n *     @param  {String}  params.Region  \r\n * @param  {Function}  callback         \r\n * @return  {Object}  err               https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data              \r\n */\r\nfunction getBucketLogging(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetBucketLogging',\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'logging',\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n        callback(null, {\r\n            BucketLoggingStatus: data.BucketLoggingStatus,\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n * / Bucket \r\n * @param  {Object}  params                                                 \r\n *     @param  {String}  params.Bucket                                      Bucket\r\n *     @param  {String}  params.Region                                      \r\n *     @param  {String}  params.Id                                          \r\n *     @param  {Object}  params.InventoryConfiguration                      \r\n * @param  {Function}  callback                                             \r\n * @return  {Object}  err                                                   https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                                                  \r\n */\r\nfunction putBucketInventory(params, callback) {\r\n    var InventoryConfiguration = util.clone(params['InventoryConfiguration']);\r\n\r\n    if (InventoryConfiguration.OptionalFields) {\r\n        var Field = InventoryConfiguration.OptionalFields || [];\r\n        InventoryConfiguration.OptionalFields = {\r\n            Field: Field\r\n        };\r\n    }\r\n\r\n    if (InventoryConfiguration.Destination\r\n        && InventoryConfiguration.Destination.COSBucketDestination\r\n        && InventoryConfiguration.Destination.COSBucketDestination.Encryption\r\n    ) {\r\n        var Encryption = InventoryConfiguration.Destination.COSBucketDestination.Encryption;\r\n        if (Object.keys(Encryption).indexOf('SSECOS') > -1) {\r\n            Encryption['SSE-COS'] = Encryption['SSECOS'];\r\n            delete Encryption['SSECOS'];\r\n        }\r\n    }\r\n\r\n    var xml = util.json2xml({\r\n        InventoryConfiguration: InventoryConfiguration\r\n    });\r\n\r\n    var headers = params.Headers;\r\n    headers['Content-Type'] = 'application/xml';\r\n    headers['Content-MD5'] = util.binaryBase64(util.md5(xml));\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:PutBucketInventory',\r\n        method: 'PUT',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        body: xml,\r\n        action: 'inventory',\r\n        qs: {\r\n            id: params['Id']\r\n        },\r\n        headers: headers,\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Bucket  Bucket\r\n *     @param  {String}  params.Region  \r\n *     @param  {String}  params.Id      \r\n * @param  {Function}  callback         \r\n * @return  {Object}  err               https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data              \r\n */\r\nfunction getBucketInventory(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetBucketInventory',\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'inventory',\r\n        qs: {\r\n            id: params['Id']\r\n        }\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n\r\n        var InventoryConfiguration = data['InventoryConfiguration'];\r\n        if (InventoryConfiguration && InventoryConfiguration.OptionalFields && InventoryConfiguration.OptionalFields.Field) {\r\n            var Field = InventoryConfiguration.OptionalFields.Field;\r\n            if (!util.isArray(Field)) {\r\n                Field = [Field];\r\n            }\r\n            InventoryConfiguration.OptionalFields = Field;\r\n        }\r\n        if (InventoryConfiguration.Destination\r\n            && InventoryConfiguration.Destination.COSBucketDestination\r\n            && InventoryConfiguration.Destination.COSBucketDestination.Encryption\r\n        ) {\r\n            var Encryption = InventoryConfiguration.Destination.COSBucketDestination.Encryption;\r\n            if (Object.keys(Encryption).indexOf('SSE-COS') > -1) {\r\n                Encryption['SSECOS'] = Encryption['SSE-COS'];\r\n                delete Encryption['SSE-COS'];\r\n            }\r\n        }\r\n\r\n        callback(null, {\r\n            InventoryConfiguration: InventoryConfiguration,\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket \r\n * @param  {Object}  params                             \r\n *     @param  {String}  params.Bucket                  Bucket\r\n *     @param  {String}  params.Region                  \r\n *     @param  {String}  params.ContinuationToken        COS  IsTruncated  true NextContinuationToken  continuation-token \r\n * @param  {Function}  callback                         \r\n * @return  {Object}  err                               https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                              \r\n */\r\nfunction listBucketInventory(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:ListBucketInventory',\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'inventory',\r\n        qs: {\r\n            'continuation-token': params['ContinuationToken']\r\n        }\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n        var ListInventoryConfigurationResult = data['ListInventoryConfigurationResult'];\r\n        var InventoryConfigurations = ListInventoryConfigurationResult.InventoryConfiguration || [];\r\n        InventoryConfigurations = util.isArray(InventoryConfigurations) ? InventoryConfigurations : [InventoryConfigurations];\r\n        delete ListInventoryConfigurationResult['InventoryConfiguration'];\r\n        util.each(InventoryConfigurations, function (InventoryConfiguration) {\r\n            if (InventoryConfiguration && InventoryConfiguration.OptionalFields && InventoryConfiguration.OptionalFields.Field) {\r\n                var Field = InventoryConfiguration.OptionalFields.Field;\r\n                if (!util.isArray(Field)) {\r\n                    Field = [Field];\r\n                }\r\n                InventoryConfiguration.OptionalFields = Field;\r\n            }\r\n\r\n            if (InventoryConfiguration.Destination\r\n                && InventoryConfiguration.Destination.COSBucketDestination\r\n                && InventoryConfiguration.Destination.COSBucketDestination.Encryption\r\n            ) {\r\n                var Encryption = InventoryConfiguration.Destination.COSBucketDestination.Encryption;\r\n                if (Object.keys(Encryption).indexOf('SSE-COS') > -1) {\r\n                    Encryption['SSECOS'] = Encryption['SSE-COS'];\r\n                    delete Encryption['SSE-COS'];\r\n                }\r\n            }\r\n        });\r\n        ListInventoryConfigurationResult.InventoryConfigurations = InventoryConfigurations;\r\n        util.extend(ListInventoryConfigurationResult, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n        callback(null, ListInventoryConfigurationResult);\r\n    });\r\n}\r\n\r\n/**\r\n *  Bucket \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Bucket  Bucket\r\n *     @param  {String}  params.Region  \r\n *     @param  {String}  params.Id      \r\n * @param  {Function}  callback         \r\n * @return  {Object}  err               https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data              \r\n */\r\nfunction deleteBucketInventory(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:DeleteBucketInventory',\r\n        method: 'DELETE',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'inventory',\r\n        qs: {\r\n            id: params['Id']\r\n        }\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/*  */\r\nfunction putBucketAccelerate(params, callback) {\r\n\r\n    if (!params['AccelerateConfiguration']) {\r\n        callback({error: 'missing param AccelerateConfiguration'});\r\n        return;\r\n    }\r\n\r\n    var configuration = { AccelerateConfiguration: params.AccelerateConfiguration || {} };\r\n\r\n    var xml = util.json2xml(configuration);\r\n\r\n    var headers = {};\r\n    headers['Content-Type'] = 'application/xml';\r\n    headers['Content-MD5'] = util.binaryBase64(util.md5(xml));\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:PutBucketAccelerate',\r\n        method: 'PUT',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        body: xml,\r\n        action: 'accelerate',\r\n        headers: headers,\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\nfunction getBucketAccelerate(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetBucketAccelerate',\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        action: 'accelerate',\r\n    }, function (err, data) {\r\n        if (!err) {\r\n            !data.AccelerateConfiguration && (data.AccelerateConfiguration = {});\r\n        }\r\n        callback(err, data);\r\n    });\r\n}\r\n\r\n// Object \r\n\r\n/**\r\n * ObjectHeadGet\r\n * @param  {Object}  params                         \r\n *     @param  {String}  params.Bucket              Bucket\r\n *     @param  {String}  params.Region              \r\n *     @param  {String}  params.Key                 \r\n *     @param  {String}  params.IfModifiedSince     ObjectObject304\r\n * @param  {Function}  callback                     \r\n * @return  {Object}  err                           https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                           object  IfModifiedSince NotModified  true\r\n *     @return  {Boolean}  data.NotModified          IfModifiedSince  object true\r\n */\r\nfunction headObject(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:HeadObject',\r\n        method: 'HEAD',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        Key: params.Key,\r\n        VersionId: params.VersionId,\r\n        headers: params.Headers,\r\n    }, function (err, data) {\r\n        if (err) {\r\n            var statusCode = err.statusCode;\r\n            if (params.Headers['If-Modified-Since'] && statusCode && statusCode === 304) {\r\n                return callback(null, {\r\n                    NotModified: true,\r\n                    statusCode: statusCode,\r\n                });\r\n            }\r\n            return callback(err);\r\n        }\r\n        data.ETag = util.attr(data.headers, 'etag', '');\r\n        callback(null, data);\r\n    });\r\n}\r\n\r\n\r\nfunction listObjectVersions(params, callback) {\r\n    var reqParams = {};\r\n    reqParams['prefix'] = params['Prefix'] || '';\r\n    reqParams['delimiter'] = params['Delimiter'];\r\n    reqParams['key-marker'] = params['KeyMarker'];\r\n    reqParams['version-id-marker'] = params['VersionIdMarker'];\r\n    reqParams['max-keys'] = params['MaxKeys'];\r\n    reqParams['encoding-type'] = params['EncodingType'];\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetBucketObjectVersions',\r\n        ResourceKey: reqParams['prefix'],\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        qs: reqParams,\r\n        action: 'versions',\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n        var ListVersionsResult = data.ListVersionsResult || {};\r\n        var DeleteMarkers = ListVersionsResult.DeleteMarker || [];\r\n        DeleteMarkers = util.isArray(DeleteMarkers) ? DeleteMarkers : [DeleteMarkers];\r\n        var Versions = ListVersionsResult.Version || [];\r\n        Versions = util.isArray(Versions) ? Versions : [Versions];\r\n\r\n        var result = util.clone(ListVersionsResult);\r\n        delete result.DeleteMarker;\r\n        delete result.Version;\r\n        util.extend(result, {\r\n            DeleteMarkers: DeleteMarkers,\r\n            Versions: Versions,\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n\r\n        callback(null, result);\r\n    });\r\n}\r\n\r\n/**\r\n *  object\r\n * @param  {Object}  params                                 \r\n *     @param  {String}  params.Bucket                      Bucket\r\n *     @param  {String}  params.Region                      \r\n *     @param  {String}  params.Key                         \r\n *     @param  {WriteStream}  params.Output                 \r\n *     @param  {String}  params.IfModifiedSince             ObjectObject304\r\n *     @param  {String}  params.IfUnmodifiedSince            412 (precondition failed)\r\n *     @param  {String}  params.IfMatch                      ETag  412 (precondition failed)\r\n *     @param  {String}  params.IfNoneMatch                  ETag 304 (not modified)\r\n *     @param  {String}  params.ResponseContentType          Content-Type \r\n *     @param  {String}  params.ResponseContentLanguage      Content-Language \r\n *     @param  {String}  params.ResponseExpires              Content-Expires \r\n *     @param  {String}  params.ResponseCacheControl         Cache-Control \r\n *     @param  {String}  params.ResponseContentDisposition   Content-Disposition \r\n *     @param  {String}  params.ResponseContentEncoding      Content-Encoding \r\n * @param  {Function}  callback                             \r\n * @param  {Object}  err                                    https://cloud.tencent.com/document/product/436/7730\r\n * @param  {Object}  data                                    object  body  headers\r\n */\r\nfunction getObject(params, callback) {\r\n    var reqParams = params.Query || {};\r\n\r\n    reqParams['response-content-type'] = params['ResponseContentType'];\r\n    reqParams['response-content-language'] = params['ResponseContentLanguage'];\r\n    reqParams['response-expires'] = params['ResponseExpires'];\r\n    reqParams['response-cache-control'] = params['ResponseCacheControl'];\r\n    reqParams['response-content-disposition'] = params['ResponseContentDisposition'];\r\n    reqParams['response-content-encoding'] = params['ResponseContentEncoding'];\r\n\r\n    //  output\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetObject',\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        Key: params.Key,\r\n        VersionId: params.VersionId,\r\n        DataType: params.DataType,\r\n        headers: params.Headers,\r\n        qs: reqParams,\r\n        rawBody: true,\r\n    }, function (err, data) {\r\n        if (err) {\r\n            var statusCode = err.statusCode;\r\n            if (params.Headers['If-Modified-Since'] && statusCode && statusCode === 304) {\r\n                return callback(null, {\r\n                    NotModified: true\r\n                });\r\n            }\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            Body: data.body,\r\n            ETag: util.attr(data.headers, 'etag', ''),\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n\r\n}\r\n\r\n/**\r\n *  object\r\n * @param  {Object} params                                          \r\n *     @param  {String}  params.Bucket                              Bucket\r\n *     @param  {String}  params.Region                              \r\n *     @param  {String}  params.Key                                 \r\n *     @param  {File || Blob || String}  params.Body                \r\n *     @param  {String}  params.CacheControl                        RFC 2616  Object \r\n *     @param  {String}  params.ContentDisposition                  RFC 2616  Object \r\n *     @param  {String}  params.ContentEncoding                     RFC 2616  Object \r\n *     @param  {String}  params.ContentLength                       RFC 2616  HTTP \r\n *     @param  {String}  params.ContentType                         RFC 2616 MIME Object \r\n *     @param  {String}  params.Expect                               Expect: 100-continue \r\n *     @param  {String}  params.Expires                             RFC 2616  Object \r\n *     @param  {String}  params.ContentSha1                         RFC 3174  160-bit  SHA-1 \r\n *     @param  {String}  params.ACL                                 private | public-read\r\n *     @param  {String}  params.GrantRead                           id=\"[OwnerUin]\",\r\n *     @param  {String}  params.GrantReadAcp                        ACLid=\"[OwnerUin]\",\r\n *     @param  {String}  params.GrantWriteAcp                       ACLid=\"[OwnerUin]\",\r\n *     @param  {String}  params.GrantFullControl                    id=\"[OwnerUin]\",\r\n *     @param  {String}  params.StorageClass                        STANDARDSTANDARD_IAARCHIVESTANDARD\r\n *     @param  {String}  params.x-cos-meta-*                        2KB\r\n *     @param  {String}  params.ContentSha1                         RFC 3174  160-bit  SHA-1 \r\n *     @param  {String}  params.ServerSideEncryption                 x-cos-server-side-encryption: \"AES256\"\r\n *     @param  {Function}  params.onProgress                        \r\n * @param  {Function}  callback                                     \r\n * @return  {Object}  err                                           https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                                           object \r\n *     @return  {String}  data.ETag                                  ETag \r\n */\r\nfunction putObject(params, callback) {\r\n    var self = this;\r\n    var FileSize = params.ContentLength;\r\n    var onProgress = util.throttleOnProgress.call(self, FileSize, params.onProgress);\r\n\r\n    //  Cache-ControlContent-Type Object \r\n    var headers = params.Headers;\r\n    if (!headers['Cache-Control'] && !headers['cache-control']) headers['Cache-Control'] = '';\r\n    if (!headers['Content-Type'] && !headers['content-type']) headers['Content-Type'] = params.Body && params.Body.type || '';\r\n    var needCalcMd5 = params.UploadAddMetaMd5 || self.options.UploadAddMetaMd5 || self.options.UploadCheckContentMd5;\r\n    util.getBodyMd5(needCalcMd5, params.Body, function (md5) {\r\n        if (md5) {\r\n            if (self.options.UploadCheckContentMd5) headers['Content-MD5'] = util.binaryBase64(md5);\r\n            if (params.UploadAddMetaMd5 || self.options.UploadAddMetaMd5) headers['x-cos-meta-md5'] = md5;\r\n        }\r\n        if (params.ContentLength !== undefined) headers['Content-Length'] = params.ContentLength;\r\n        onProgress(null, true); //  uploading\r\n        submitRequest.call(self, {\r\n            Action: 'name/cos:PutObject',\r\n            TaskId: params.TaskId,\r\n            method: 'PUT',\r\n            Bucket: params.Bucket,\r\n            Region: params.Region,\r\n            Key: params.Key,\r\n            headers: params.Headers,\r\n            qs: params.Query,\r\n            body: params.Body,\r\n            onProgress: onProgress,\r\n        }, function (err, data) {\r\n            if (err) {\r\n                onProgress(null, true);\r\n                return callback(err);\r\n            }\r\n            onProgress({loaded: FileSize, total: FileSize}, true);\r\n            var url = getUrl({\r\n                ForcePathStyle: self.options.ForcePathStyle,\r\n                protocol: self.options.Protocol,\r\n                domain: self.options.Domain,\r\n                bucket: params.Bucket,\r\n                region: params.Region,\r\n                object: params.Key,\r\n            });\r\n            url = url.substr(url.indexOf('://') + 3);\r\n            data.Location = url;\r\n            data.ETag = util.attr(data.headers, 'etag', '');\r\n            callback(null, data);\r\n        });\r\n    }, params.onHashProgress);\r\n}\r\n\r\n/**\r\n *  object\r\n * @param  {Object}  params                     \r\n *     @param  {String}  params.Bucket          Bucket\r\n *     @param  {String}  params.Region          \r\n *     @param  {String}  params.Key             object\r\n * @param  {Function}  callback                 \r\n * @param  {Object}  err                        https://cloud.tencent.com/document/product/436/7730\r\n * @param  {Object}  data                       \r\n */\r\nfunction deleteObject(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:DeleteObject',\r\n        method: 'DELETE',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        Key: params.Key,\r\n        headers: params.Headers,\r\n        VersionId: params.VersionId,\r\n    }, function (err, data) {\r\n        if (err) {\r\n            var statusCode = err.statusCode;\r\n            if (statusCode && statusCode === 204) {\r\n                return callback(null, {statusCode: statusCode});\r\n            } else if (statusCode && statusCode === 404) {\r\n                return callback(null, {BucketNotFound: true, statusCode: statusCode,});\r\n            } else {\r\n                return callback(err);\r\n            }\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  object  \r\n * @param  {Object}  params                         \r\n *     @param  {String}  params.Bucket              Bucket\r\n *     @param  {String}  params.Region              \r\n *     @param  {String}  params.Key                 object\r\n * @param  {Function}  callback                     \r\n * @return  {Object}  err                           https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                          \r\n *     @return  {Object}  data.AccessControlPolicy  \r\n */\r\nfunction getObjectAcl(params, callback) {\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetObjectACL',\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        Key: params.Key,\r\n        headers: params.Headers,\r\n        action: 'acl',\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n        var AccessControlPolicy = data.AccessControlPolicy || {};\r\n        var Owner = AccessControlPolicy.Owner || {};\r\n        var Grant = AccessControlPolicy.AccessControlList && AccessControlPolicy.AccessControlList.Grant || [];\r\n        Grant = util.isArray(Grant) ? Grant : [Grant];\r\n        var result = decodeAcl(AccessControlPolicy);\r\n        if (data.headers && data.headers['x-cos-acl']) {\r\n            result.ACL = data.headers['x-cos-acl'];\r\n        }\r\n        result = util.extend(result, {\r\n            Owner: Owner,\r\n            Grants: Grant,\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n        callback(null, result);\r\n    });\r\n}\r\n\r\n/**\r\n *  object  \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Bucket  Bucket\r\n *     @param  {String}  params.Region  \r\n *     @param  {String}  params.Key     object\r\n * @param  {Function}  callback         \r\n * @return  {Object}  err               https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data              \r\n */\r\nfunction putObjectAcl(params, callback) {\r\n    var headers = params.Headers;\r\n\r\n    var xml = '';\r\n    if (params['AccessControlPolicy']) {\r\n        var AccessControlPolicy = util.clone(params['AccessControlPolicy'] || {});\r\n        var Grants = AccessControlPolicy.Grants || AccessControlPolicy.Grant;\r\n        Grants = util.isArray(Grants) ? Grants : [Grants];\r\n        delete AccessControlPolicy.Grant;\r\n        delete AccessControlPolicy.Grants;\r\n        AccessControlPolicy.AccessControlList = {Grant: Grants};\r\n        xml = util.json2xml({AccessControlPolicy: AccessControlPolicy});\r\n\r\n        headers['Content-Type'] = 'application/xml';\r\n        headers['Content-MD5'] = util.binaryBase64(util.md5(xml));\r\n    }\r\n\r\n    // Grant Header \r\n    util.each(headers, function (val, key) {\r\n        if (key.indexOf('x-cos-grant-') === 0) {\r\n            headers[key] = uniqGrant(headers[key]);\r\n        }\r\n    });\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:PutObjectACL',\r\n        method: 'PUT',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        Key: params.Key,\r\n        action: 'acl',\r\n        headers: headers,\r\n        body: xml,\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n * Options Object OPTIONS \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Bucket  Bucket\r\n *     @param  {String}  params.Region  \r\n *     @param  {String}  params.Key     object\r\n * @param  {Function}  callback         \r\n * @return  {Object}  err               https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data              \r\n */\r\nfunction optionsObject(params, callback) {\r\n\r\n    var headers = params.Headers;\r\n    headers['Origin'] = params['Origin'];\r\n    headers['Access-Control-Request-Method'] = params['AccessControlRequestMethod'];\r\n    headers['Access-Control-Request-Headers'] = params['AccessControlRequestHeaders'];\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:OptionsObject',\r\n        method: 'OPTIONS',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        Key: params.Key,\r\n        headers: headers,\r\n    }, function (err, data) {\r\n        if (err) {\r\n            if (err.statusCode && err.statusCode === 403) {\r\n                return callback(null, {\r\n                    OptionsForbidden: true,\r\n                    statusCode: err.statusCode\r\n                });\r\n            }\r\n            return callback(err);\r\n        }\r\n\r\n        var headers = data.headers || {};\r\n        callback(null, {\r\n            AccessControlAllowOrigin: headers['access-control-allow-origin'],\r\n            AccessControlAllowMethods: headers['access-control-allow-methods'],\r\n            AccessControlAllowHeaders: headers['access-control-allow-headers'],\r\n            AccessControlExposeHeaders: headers['access-control-expose-headers'],\r\n            AccessControlMaxAge: headers['access-control-max-age'],\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n * @param  {Object}                                     \r\n *     @param  {String}  Bucket                         Bucket \r\n *     @param  {String}  Region                         \r\n *     @param  {String}  Key                            \r\n *     @param  {String}  CopySource                     URLversionid\r\n *     @param  {String}  ACL                            privatepublic-readprivate\r\n *     @param  {String}  GrantRead                       x-cos-grant-read: uin=\" \",uin=\" \"uin=\"RootAcountID/SubAccountID\"uin=\"RootAcountID\"\r\n *     @param  {String}  GrantWrite                      x-cos-grant-write: uin=\" \",uin=\" \"uin=\"RootAcountID/SubAccountID\"uin=\"RootAcountID\"\r\n *     @param  {String}  GrantFullControl                x-cos-grant-full-control: uin=\" \",uin=\" \"uin=\"RootAcountID/SubAccountID\"uin=\"RootAcountID\"\r\n *     @param  {String}  MetadataDirective              Copy, ReplacedCopyCopyHeaderReplacedHeaderReplaced\r\n *     @param  {String}  CopySourceIfModifiedSince      Object412x-cos-copy-source-If-None-Match\r\n *     @param  {String}  CopySourceIfUnmodifiedSince    Object412x-cos-copy-source-If-Match\r\n *     @param  {String}  CopySourceIfMatch              ObjectETag412x-cos-copy-source-If-Unmodified-Since\r\n *     @param  {String}  CopySourceIfNoneMatch          ObjectETag412x-cos-copy-source-If-Modified-Since\r\n *     @param  {String}  StorageClass                   Standard, Standard_IAArchiveStandard\r\n *     @param  {String}  CacheControl                   /\r\n *     @param  {String}  ContentDisposition             MIME MIME  MIME \r\n *     @param  {String}  ContentEncoding                HTTP \r\n *     @param  {String}  ContentLength                  \r\n *     @param  {String}  ContentType                    RFC 2616  HTTP MIMEtext/plain\r\n *     @param  {String}  Expect                         \r\n *     @param  {String}  Expires                        \r\n *     @param  {String}  params.ServerSideEncryption    x-cos-server-side-encryption: \"AES256\"\r\n *     @param  {String}  ContentLanguage                \r\n *     @param  {String}  x-cos-meta-*                    Object 2K\r\n */\r\nfunction putObjectCopy(params, callback) {\r\n\r\n    //  Cache-Control\r\n    var headers = params.Headers;\r\n    if (!headers['Cache-Control'] && !!headers['cache-control']) headers['Cache-Control'] = '';\r\n\r\n    var CopySource = params.CopySource || '';\r\n    var m = CopySource.match(/^([^.]+-\\d+)\\.cos(v6)?\\.([^.]+)\\.[^/]+\\/(.+)$/);\r\n    if (!m) {\r\n        callback({error: 'CopySource format error'});\r\n        return;\r\n    }\r\n\r\n    var SourceBucket = m[1];\r\n    var SourceRegion = m[3];\r\n    var SourceKey = decodeURIComponent(m[4]);\r\n\r\n    submitRequest.call(this, {\r\n        Interface: 'PutObjectCopy',\r\n        Scope: [{\r\n            action: 'name/cos:GetObject',\r\n            bucket: SourceBucket,\r\n            region: SourceRegion,\r\n            prefix: SourceKey,\r\n        }, {\r\n            action: 'name/cos:PutObject',\r\n            bucket: params.Bucket,\r\n            region: params.Region,\r\n            prefix: params.Key,\r\n        }],\r\n        method: 'PUT',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        Key: params.Key,\r\n        VersionId: params.VersionId,\r\n        headers: params.Headers,\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n        var result = util.clone(data.CopyObjectResult || {});\r\n        util.extend(result, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n        callback(null, result);\r\n    });\r\n}\r\n\r\nfunction uploadPartCopy(params, callback) {\r\n\r\n    var CopySource = params.CopySource || '';\r\n    var m = CopySource.match(/^([^.]+-\\d+)\\.cos(v6)?\\.([^.]+)\\.[^/]+\\/(.+)$/);\r\n    if (!m) {\r\n        callback({error: 'CopySource format error'});\r\n        return;\r\n    }\r\n\r\n    var SourceBucket = m[1];\r\n    var SourceRegion = m[3];\r\n    var SourceKey = decodeURIComponent(m[4]);\r\n\r\n    submitRequest.call(this, {\r\n        Interface: 'UploadPartCopy',\r\n        Scope: [{\r\n            action: 'name/cos:GetObject',\r\n            bucket: SourceBucket,\r\n            region: SourceRegion,\r\n            prefix: SourceKey,\r\n        }, {\r\n            action: 'name/cos:PutObject',\r\n            bucket: params.Bucket,\r\n            region: params.Region,\r\n            prefix: params.Key,\r\n        }],\r\n        method: 'PUT',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        Key: params.Key,\r\n        VersionId: params.VersionId,\r\n        qs: {\r\n            partNumber: params['PartNumber'],\r\n            uploadId: params['UploadId'],\r\n        },\r\n        headers: params.Headers,\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n        var result = util.clone(data.CopyPartResult || {});\r\n        util.extend(result, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n        callback(null, result);\r\n    });\r\n}\r\n\r\nfunction deleteMultipleObject(params, callback) {\r\n    var Objects = params.Objects || [];\r\n    var Quiet = params.Quiet;\r\n    Objects = util.isArray(Objects) ? Objects : [Objects];\r\n\r\n    var xml = util.json2xml({Delete: {Object: Objects, Quiet: Quiet || false}});\r\n\r\n    var headers = params.Headers;\r\n    headers['Content-Type'] = 'application/xml';\r\n    headers['Content-MD5'] = util.binaryBase64(util.md5(xml));\r\n\r\n    var Scope = util.map(Objects, function (v) {\r\n        return {\r\n            action: 'name/cos:DeleteObject',\r\n            bucket: params.Bucket,\r\n            region: params.Region,\r\n            prefix: v.Key,\r\n        };\r\n    });\r\n\r\n    submitRequest.call(this, {\r\n        Interface: 'DeleteMultipleObjects',\r\n        Scope: Scope,\r\n        method: 'POST',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        body: xml,\r\n        action: 'delete',\r\n        headers: headers,\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n        var DeleteResult = data.DeleteResult || {};\r\n        var Deleted = DeleteResult.Deleted || [];\r\n        var Errors = DeleteResult.Error || [];\r\n\r\n        Deleted = util.isArray(Deleted) ? Deleted : [Deleted];\r\n        Errors = util.isArray(Errors) ? Errors : [Errors];\r\n\r\n        var result = util.clone(DeleteResult);\r\n        util.extend(result, {\r\n            Error: Errors,\r\n            Deleted: Deleted,\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n        callback(null, result);\r\n    });\r\n}\r\n\r\nfunction restoreObject(params, callback) {\r\n    var headers = params.Headers;\r\n    if (!params['RestoreRequest']) {\r\n        callback({error: 'missing param RestoreRequest'});\r\n        return;\r\n    }\r\n\r\n    var RestoreRequest = params.RestoreRequest || {};\r\n    var xml = util.json2xml({RestoreRequest: RestoreRequest});\r\n\r\n    headers['Content-Type'] = 'application/xml';\r\n    headers['Content-MD5'] = util.binaryBase64(util.md5(xml));\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:RestoreObject',\r\n        method: 'POST',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        Key: params.Key,\r\n        VersionId: params.VersionId,\r\n        body: xml,\r\n        action: 'restore',\r\n        headers: headers,\r\n    }, function (err, data) {\r\n        callback(err, data);\r\n    });\r\n}\r\n\r\n/**\r\n *  Object \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Bucket  Object\r\n *     @param  {String}  params.Region  \r\n *     @param  {Array}   params.TagSet  \r\n * @param  {Function}  callback         \r\n * @return  {Object}  err               https://cloud.tencent.com/document/product/436/42998\r\n * @return  {Object}  data              \r\n */\r\nfunction putObjectTagging(params, callback) {\r\n\r\n    var Tagging = params['Tagging'] || {};\r\n    var Tags = Tagging.TagSet || Tagging.Tags || params['Tags'] || [];\r\n    Tags = util.clone(util.isArray(Tags) ? Tags : [Tags]);\r\n    var xml = util.json2xml({Tagging: {TagSet: {Tag: Tags}}});\r\n\r\n    var headers = params.Headers;\r\n    headers['Content-Type'] = 'application/xml';\r\n    headers['Content-MD5'] = util.binaryBase64(util.md5(xml));\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:PutObjectTagging',\r\n        method: 'PUT',\r\n        Bucket: params.Bucket,\r\n        Key: params.Key,\r\n        Region: params.Region,\r\n        body: xml,\r\n        action: 'tagging',\r\n        headers: headers,\r\n        VersionId: params.VersionId,\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Object \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Bucket  Bucket\r\n *     @param  {String}  params.Region  \r\n * @param  {Function}  callback         \r\n * @return  {Object}  err               https://cloud.tencent.com/document/product/436/42998\r\n * @return  {Object}  data              \r\n */\r\nfunction getObjectTagging(params, callback) {\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:GetObjectTagging',\r\n        method: 'GET',\r\n        Key: params.Key,\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        action: 'tagging',\r\n        VersionId: params.VersionId,\r\n    }, function (err, data) {\r\n        if (err) {\r\n            if (err.statusCode === 404 && err.error && (err.error === \"Not Found\" || err.error.Code === 'NoSuchTagSet')) {\r\n                var result = {\r\n                    Tags: [],\r\n                    statusCode: err.statusCode,\r\n                };\r\n                err.headers && (result.headers = err.headers);\r\n                callback(null, result);\r\n            } else {\r\n                callback(err);\r\n            }\r\n            return;\r\n        }\r\n        var Tags = [];\r\n        try {\r\n            Tags = data.Tagging.TagSet.Tag || [];\r\n        } catch (e) {\r\n        }\r\n        Tags = util.clone(util.isArray(Tags) ? Tags : [Tags]);\r\n        callback(null, {\r\n            Tags: Tags,\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  Object  \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Bucket  Object\r\n *     @param  {String}  params.Region  \r\n * @param  {Function}  callback         \r\n * @return  {Object}  err               https://cloud.tencent.com/document/product/436/42998\r\n * @return  {Object}  data              \r\n */\r\nfunction deleteObjectTagging(params, callback) {\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:DeleteObjectTagging',\r\n        method: 'DELETE',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        Key: params.Key,\r\n        headers: params.Headers,\r\n        action: 'tagging',\r\n        VersionId: params.VersionId,\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *  SQL CSV  JSON \r\n * @param  {Object}  params                   \r\n *     @param  {String}  params.Bucket        Object\r\n *     @param  {String}  params.Region        \r\n *     @param  {Object}  params.SelectRequest \r\n * @param  {Function}  callback               \r\n * @return  {Object}  err                     https://cloud.tencent.com/document/product/436/42998\r\n * @return  {Object}  data                    \r\n */\r\nfunction selectObjectContent(params, callback) {\r\n    var SelectType = params['SelectType'];\r\n    if (!SelectType) return callback({error: 'missing param SelectType'});\r\n\r\n    var SelectRequest = params['SelectRequest'] || {};\r\n    var xml = util.json2xml({SelectRequest: SelectRequest});\r\n\r\n    var headers = params.Headers;\r\n    headers['Content-Type'] = 'application/xml';\r\n    headers['Content-MD5'] = util.binaryBase64(util.md5(xml));\r\n\r\n    submitRequest.call(this, {\r\n        Interface: 'SelectObjectContent',\r\n        Action: 'name/cos:GetObject',\r\n        method: 'POST',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        Key: params.Key,\r\n        headers: params.Headers,\r\n        action: 'select',\r\n        qs: {\r\n            'select-type': params['SelectType'],\r\n        },\r\n        VersionId: params.VersionId,\r\n        body: xml,\r\n        rawBody: true,\r\n    }, function (err, data) {\r\n        if (err && err.statusCode === 204) {\r\n            return callback(null, {statusCode: err.statusCode});\r\n        } else if (err) {\r\n            return callback(err);\r\n        }\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n            Body: data.body,\r\n        });\r\n    });\r\n}\r\n\r\n\r\n// \r\n\r\n\r\n/**\r\n * \r\n * @param  {Object}  params                                     \r\n *     @param  {String}  params.Bucket                          Bucket\r\n *     @param  {String}  params.Region                          \r\n *     @param  {String}  params.Key                             object\r\n *     @param  {String}  params.UploadId                        object\r\n *     @param  {String}  params.CacheControl                    RFC 2616  Object \r\n *     @param  {String}  params.ContentDisposition              RFC 2616  Object     \r\n *     @param  {String}  params.ContentEncoding                 RFC 2616  Object \r\n *     @param  {String}  params.ContentType                     RFC 2616 MIME Object \r\n *     @param  {String}  params.Expires                         RFC 2616  Object \r\n *     @param  {String}  params.ACL                             \r\n *     @param  {String}  params.GrantRead                        \r\n *     @param  {String}  params.GrantWrite                       \r\n *     @param  {String}  params.GrantFullControl                 \r\n *     @param  {String}  params.StorageClass                    ObjectStandardStandard_IAArchive\r\n *     @param  {String}  params.ServerSideEncryption            x-cos-server-side-encryption: \"AES256\"\r\n * @param  {Function}  callback                                 \r\n * @return  {Object}  err                                       https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                                      \r\n */\r\nfunction multipartInit(params, callback) {\r\n\r\n    var self = this;\r\n    var headers = params.Headers;\r\n\r\n    //  Cache-ControlContent-Type\r\n    if (!headers['Cache-Control'] && !headers['cache-control']) headers['Cache-Control'] = '';\r\n    if (!headers['Content-Type'] && !headers['content-type']) headers['Content-Type'] = params.Body && params.Body.type || '';\r\n\r\n    util.getBodyMd5(params.Body && (params.UploadAddMetaMd5 || self.options.UploadAddMetaMd5), params.Body, function (md5) {\r\n        if (md5) params.Headers['x-cos-meta-md5'] = md5;\r\n        submitRequest.call(self, {\r\n            Action: 'name/cos:InitiateMultipartUpload',\r\n            method: 'POST',\r\n            Bucket: params.Bucket,\r\n            Region: params.Region,\r\n            Key: params.Key,\r\n            action: 'uploads',\r\n            headers: params.Headers,\r\n            qs: params.Query,\r\n        }, function (err, data) {\r\n            if (err) {\r\n                return callback(err);\r\n            }\r\n            data = util.clone(data || {});\r\n            if (data && data.InitiateMultipartUploadResult) {\r\n                return callback(null, util.extend(data.InitiateMultipartUploadResult, {\r\n                    statusCode: data.statusCode,\r\n                    headers: data.headers,\r\n                }));\r\n            }\r\n            callback(null, data);\r\n        });\r\n    }, params.onHashProgress);\r\n}\r\n\r\n/**\r\n * \r\n * @param  {Object}  params                                 \r\n *     @param  {String}  params.Bucket                      Bucket\r\n *     @param  {String}  params.Region                      \r\n *     @param  {String}  params.Key                         object\r\n *     @param  {File || Blob || String}  params.Body        \r\n *     @param  {String} params.ContentLength                RFC 2616  HTTP \r\n *     @param  {String} params.Expect                        Expect: 100-continue \r\n *     @param  {String} params.ServerSideEncryption          x-cos-server-side-encryption: \"AES256\"\r\n *     @param  {String} params.ContentSha1                  RFC 3174  160-bit  SHA-1 \r\n * @param  {Function}  callback                             \r\n *     @return  {Object}  err                               https://cloud.tencent.com/document/product/436/7730\r\n *     @return  {Object}  data                              \r\n *     @return  {Object}  data.ETag                          sha1 \r\n */\r\nfunction multipartUpload(params, callback) {\r\n\r\n    var self = this;\r\n    util.getFileSize('multipartUpload', params, function () {\r\n        util.getBodyMd5(self.options.UploadCheckContentMd5, params.Body, function (md5) {\r\n            if (md5) params.Headers['Content-MD5'] = util.binaryBase64(md5);\r\n            submitRequest.call(self, {\r\n                Action: 'name/cos:UploadPart',\r\n                TaskId: params.TaskId,\r\n                method: 'PUT',\r\n                Bucket: params.Bucket,\r\n                Region: params.Region,\r\n                Key: params.Key,\r\n                qs: {\r\n                    partNumber: params['PartNumber'],\r\n                    uploadId: params['UploadId'],\r\n                },\r\n                headers: params.Headers,\r\n                onProgress: params.onProgress,\r\n                body: params.Body || null\r\n            }, function (err, data) {\r\n                if (err) return callback(err);\r\n                callback(null, {\r\n                    ETag: util.attr(data.headers, 'etag', ''),\r\n                    statusCode: data.statusCode,\r\n                    headers: data.headers,\r\n                });\r\n            });\r\n        });\r\n    });\r\n\r\n}\r\n\r\n/**\r\n * \r\n * @param  {Object}  params                             \r\n *     @param  {String}  params.Bucket                  Bucket\r\n *     @param  {String}  params.Region                  \r\n *     @param  {String}  params.Key                     object\r\n *     @param  {Array}   params.Parts                   \r\n *     @param  {String}  params.Parts[i].PartNumber     \r\n *     @param  {String}  params.Parts[i].ETag            sha1 \r\n * @param  {Function}  callback                         \r\n * @return  {Object}  err                               https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                              \r\n *     @return  {Object}  data.CompleteMultipartUpload  Location, Bucket, Key  ETag\r\n */\r\nfunction multipartComplete(params, callback) {\r\n    var self = this;\r\n\r\n    var UploadId = params.UploadId;\r\n\r\n    var Parts = params['Parts'];\r\n\r\n    for (var i = 0, len = Parts.length; i < len; i++) {\r\n        if (Parts[i]['ETag'].indexOf('\"') === 0) {\r\n            continue;\r\n        }\r\n        Parts[i]['ETag'] = '\"' + Parts[i]['ETag'] + '\"';\r\n    }\r\n\r\n    var xml = util.json2xml({CompleteMultipartUpload: {Part: Parts}});\r\n\r\n    var headers = params.Headers;\r\n    headers['Content-Type'] = 'application/xml';\r\n    headers['Content-MD5'] = util.binaryBase64(util.md5(xml));\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:CompleteMultipartUpload',\r\n        method: 'POST',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        Key: params.Key,\r\n        qs: {\r\n            uploadId: UploadId\r\n        },\r\n        body: xml,\r\n        headers: headers,\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n        var url = getUrl({\r\n            ForcePathStyle: self.options.ForcePathStyle,\r\n            protocol: self.options.Protocol,\r\n            domain: self.options.Domain,\r\n            bucket: params.Bucket,\r\n            region: params.Region,\r\n            object: params.Key,\r\n            isLocation: true,\r\n        });\r\n        var res = data.CompleteMultipartUploadResult || {};\r\n        if (res.ProcessResults) {\r\n            if (res && res.ProcessResults) {\r\n                res.UploadResult = {\r\n                    OriginalInfo: {\r\n                        Key: res.Key,\r\n                        Location: url,\r\n                        ETag: res.ETag,\r\n                        ImageInfo: res.ImageInfo,\r\n                    },\r\n                    ProcessResults: res.ProcessResults,\r\n                };\r\n                delete res.ImageInfo;\r\n                delete res.ProcessResults;\r\n            }\r\n        }\r\n        var result = util.extend(res, {\r\n            Location: url,\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n        callback(null, result);\r\n    });\r\n}\r\n\r\n/**\r\n * \r\n * @param  {Object}  params                                 \r\n *     @param  {String}  params.Bucket                      Bucket\r\n *     @param  {String}  params.Region                      \r\n *     @param  {String}  params.Delimiter                   PrefixPrefixdelimiterCommon PrefixCommon PrefixPrefix\r\n *     @param  {String}  params.EncodingType                \r\n *     @param  {String}  params.Prefix                      \r\n *     @param  {String}  params.MaxUploads                  1000\r\n *     @param  {String}  params.KeyMarker                   upload-id-marker </Br>upload-id-markerObjectNamekey-marker </Br>upload-id-markerObjectNamekey-markerObjectNamekey-markerUploadIdupload-id-marker\r\n *     @param  {String}  params.UploadIdMarker              key-marker </Br>key-markerupload-id-marker </Br>key-markerObjectNamekey-markerObjectNamekey-markerUploadIdupload-id-marker\r\n * @param  {Function}  callback                             \r\n * @return  {Object}  err                                   https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                                  \r\n *     @return  {Object}  data.ListMultipartUploadsResult   \r\n */\r\nfunction multipartList(params, callback) {\r\n    var reqParams = {};\r\n\r\n    reqParams['delimiter'] = params['Delimiter'];\r\n    reqParams['encoding-type'] = params['EncodingType'];\r\n    reqParams['prefix'] = params['Prefix'] || '';\r\n\r\n    reqParams['max-uploads'] = params['MaxUploads'];\r\n\r\n    reqParams['key-marker'] = params['KeyMarker'];\r\n    reqParams['upload-id-marker'] = params['UploadIdMarker'];\r\n\r\n    reqParams = util.clearKey(reqParams);\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:ListMultipartUploads',\r\n        ResourceKey: reqParams['prefix'],\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        headers: params.Headers,\r\n        qs: reqParams,\r\n        action: 'uploads',\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n\r\n        if (data && data.ListMultipartUploadsResult) {\r\n            var Upload = data.ListMultipartUploadsResult.Upload || [];\r\n\r\n            var CommonPrefixes = data.ListMultipartUploadsResult.CommonPrefixes || [];\r\n\r\n            CommonPrefixes = util.isArray(CommonPrefixes) ? CommonPrefixes : [CommonPrefixes];\r\n            Upload = util.isArray(Upload) ? Upload : [Upload];\r\n\r\n            data.ListMultipartUploadsResult.Upload = Upload;\r\n            data.ListMultipartUploadsResult.CommonPrefixes = CommonPrefixes;\r\n        }\r\n        var result = util.clone(data.ListMultipartUploadsResult || {});\r\n        util.extend(result, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n        callback(null, result);\r\n    });\r\n}\r\n\r\n/**\r\n * \r\n * @param  {Object}  params                                 \r\n *     @param  {String}  params.Bucket                      Bucket\r\n *     @param  {String}  params.Region                      \r\n *     @param  {String}  params.Key                         object\r\n *     @param  {String}  params.UploadId                    ID\r\n *     @param  {String}  params.EncodingType                \r\n *     @param  {String}  params.MaxParts                    1000\r\n *     @param  {String}  params.PartNumberMarker            UTF-8marker\r\n * @param  {Function}  callback                             \r\n * @return  {Object}  err                                   https://cloud.tencent.com/document/product/436/7730\r\n * @return  {Object}  data                                  \r\n *     @return  {Object}  data.ListMultipartUploadsResult   \r\n */\r\nfunction multipartListPart(params, callback) {\r\n    var reqParams = {};\r\n\r\n    reqParams['uploadId'] = params['UploadId'];\r\n    reqParams['encoding-type'] = params['EncodingType'];\r\n    reqParams['max-parts'] = params['MaxParts'];\r\n    reqParams['part-number-marker'] = params['PartNumberMarker'];\r\n\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:ListParts',\r\n        method: 'GET',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        Key: params.Key,\r\n        headers: params.Headers,\r\n        qs: reqParams,\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n        var ListPartsResult = data.ListPartsResult || {};\r\n        var Part = ListPartsResult.Part || [];\r\n        Part = util.isArray(Part) ? Part : [Part];\r\n\r\n        ListPartsResult.Part = Part;\r\n        var result = util.clone(ListPartsResult);\r\n        util.extend(result, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n        callback(null, result);\r\n    });\r\n}\r\n\r\n/**\r\n * \r\n * @param  {Object}  params                 \r\n *     @param  {String}  params.Bucket      Bucket\r\n *     @param  {String}  params.Region      \r\n *     @param  {String}  params.Key         object\r\n *     @param  {String}  params.UploadId    ID\r\n * @param  {Function}  callback             \r\n *     @return  {Object}    err             https://cloud.tencent.com/document/product/436/7730\r\n *     @return  {Object}    data            \r\n */\r\nfunction multipartAbort(params, callback) {\r\n    var reqParams = {};\r\n\r\n    reqParams['uploadId'] = params['UploadId'];\r\n    submitRequest.call(this, {\r\n        Action: 'name/cos:AbortMultipartUpload',\r\n        method: 'DELETE',\r\n        Bucket: params.Bucket,\r\n        Region: params.Region,\r\n        Key: params.Key,\r\n        headers: params.Headers,\r\n        qs: reqParams,\r\n    }, function (err, data) {\r\n        if (err) return callback(err);\r\n        callback(null, {\r\n            statusCode: data.statusCode,\r\n            headers: data.headers,\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n * \r\n * @param  {Object}  params             \r\n *     @param  {String}  params.Method  \r\n *     @param  {String}  params.Key     object\r\n *     @param  {String}  params.Expires \r\n * @return  {String}  data              \r\n */\r\nfunction getAuth(params) {\r\n    var self = this;\r\n    return util.getAuth({\r\n        SecretId: params.SecretId || this.options.SecretId || '',\r\n        SecretKey: params.SecretKey || this.options.SecretKey || '',\r\n        Method: params.Method,\r\n        Key: params.Key,\r\n        Query: params.Query,\r\n        Headers: params.Headers,\r\n        Expires: params.Expires,\r\n        UseRawKey: self.options.UseRawKey,\r\n        SystemClockOffset: self.options.SystemClockOffset,\r\n    });\r\n}\r\n\r\n/**\r\n * \r\n * @param  {Object}  params                 \r\n *     @param  {String}  params.Bucket      Bucket\r\n *     @param  {String}  params.Region      \r\n *     @param  {String}  params.Key         object\r\n *     @param  {String}  params.Method      \r\n *     @param  {String}  params.Expires     \r\n * @param  {Function}  callback             \r\n *     @return  {Object}    err             https://cloud.tencent.com/document/product/436/7730\r\n *     @return  {Object}    data            \r\n */\r\nfunction getObjectUrl(params, callback) {\r\n    var self = this;\r\n    var url = getUrl({\r\n        ForcePathStyle: self.options.ForcePathStyle,\r\n        protocol: params.Protocol || self.options.Protocol,\r\n        domain: params.Domain || self.options.Domain,\r\n        bucket: params.Bucket,\r\n        region: params.Region,\r\n        object: params.Key,\r\n    });\r\n    if (params.Sign !== undefined && !params.Sign) {\r\n        callback(null, {Url: url});\r\n        return url;\r\n    }\r\n    var AuthData = getAuthorizationAsync.call(this, {\r\n        Action: ((params.Method || '').toUpperCase() === 'PUT' ? 'name/cos:PutObject' : 'name/cos:GetObject'),\r\n        Bucket: params.Bucket || '',\r\n        Region: params.Region || '',\r\n        Method: params.Method || 'get',\r\n        Key: params.Key,\r\n        Expires: params.Expires,\r\n    }, function (err, AuthData) {\r\n        if (!callback) return;\r\n        if (err) {\r\n            callback(err);\r\n            return;\r\n        }\r\n        var signUrl = url;\r\n        signUrl += '?' + (AuthData.Authorization.indexOf('q-signature') > -1 ?\r\n            AuthData.Authorization : 'sign=' + encodeURIComponent(AuthData.Authorization));\r\n        AuthData.XCosSecurityToken && (signUrl += '&x-cos-security-token=' + AuthData.XCosSecurityToken);\r\n        AuthData.ClientIP && (signUrl += '&clientIP=' + AuthData.ClientIP);\r\n        AuthData.ClientUA && (signUrl += '&clientUA=' + AuthData.ClientUA);\r\n        AuthData.Token && (signUrl += '&token=' + AuthData.Token);\r\n        setTimeout(function () {\r\n            callback(null, {Url: signUrl});\r\n        });\r\n    });\r\n    if (AuthData) {\r\n        return url + '?' + AuthData.Authorization +\r\n            (AuthData.XCosSecurityToken ? '&x-cos-security-token=' + AuthData.XCosSecurityToken : '');\r\n    } else {\r\n        return url;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * \r\n */\r\nfunction decodeAcl(AccessControlPolicy) {\r\n    var result = {\r\n        GrantFullControl: [],\r\n        GrantWrite: [],\r\n        GrantRead: [],\r\n        GrantReadAcp: [],\r\n        GrantWriteAcp: [],\r\n        ACL: '',\r\n    };\r\n    var GrantMap = {\r\n        'FULL_CONTROL': 'GrantFullControl',\r\n        'WRITE': 'GrantWrite',\r\n        'READ': 'GrantRead',\r\n        'READ_ACP': 'GrantReadAcp',\r\n        'WRITE_ACP': 'GrantWriteAcp',\r\n    };\r\n    var AccessControlList = AccessControlPolicy && AccessControlPolicy.AccessControlList || {};\r\n    var Grant = AccessControlList.Grant;\r\n    if (Grant) {\r\n        Grant = util.isArray(Grant) ? Grant : [Grant];\r\n    }\r\n    var PublicAcl = {READ: 0, WRITE: 0, FULL_CONTROL: 0};\r\n    Grant && Grant.length && util.each(Grant, function (item) {\r\n        if (item.Grantee.ID === 'qcs::cam::anyone:anyone' || item.Grantee.URI === 'http://cam.qcloud.com/groups/global/AllUsers') {\r\n            PublicAcl[item.Permission] = 1;\r\n        } else if (item.Grantee.ID !== AccessControlPolicy.Owner.ID) {\r\n            result[GrantMap[item.Permission]].push('id=\"' + item.Grantee.ID + '\"');\r\n        }\r\n    });\r\n    if (PublicAcl.FULL_CONTROL || (PublicAcl.WRITE && PublicAcl.READ)) {\r\n        result.ACL = 'public-read-write';\r\n    } else if (PublicAcl.READ) {\r\n        result.ACL = 'public-read';\r\n    } else {\r\n        result.ACL = 'private';\r\n    }\r\n    util.each(GrantMap, function (item) {\r\n        result[item] = uniqGrant(result[item].join(','));\r\n    });\r\n    return result;\r\n}\r\n\r\n// Grant \r\nfunction uniqGrant(str) {\r\n    var arr = str.split(',');\r\n    var exist = {};\r\n    var i, item;\r\n    for (i = 0; i < arr.length; ) {\r\n        item = arr[i].trim();\r\n        if (exist[item]) {\r\n            arr.splice(i, 1);\r\n        } else {\r\n            exist[item] = true;\r\n            arr[i] = item;\r\n            i++;\r\n        }\r\n    }\r\n    return arr.join(',');\r\n}\r\n\r\n//  url\r\nfunction getUrl(params) {\r\n    var longBucket = params.bucket;\r\n    var shortBucket = longBucket.substr(0, longBucket.lastIndexOf('-'));\r\n    var appId = longBucket.substr(longBucket.lastIndexOf('-') + 1);\r\n    var domain = params.domain;\r\n    var region = params.region;\r\n    var object = params.object;\r\n    var protocol = params.protocol || (util.isBrowser && location.protocol === 'http:' ? 'http:' : 'https:');\r\n    if (!domain) {\r\n        if (['cn-south', 'cn-south-2', 'cn-north', 'cn-east', 'cn-southwest', 'sg'].indexOf(region) > -1) {\r\n            domain = '{Region}.myqcloud.com';\r\n        } else {\r\n            domain = 'cos.{Region}.myqcloud.com';\r\n        }\r\n        if (!params.ForcePathStyle) {\r\n            domain = '{Bucket}.' + domain;\r\n        }\r\n    }\r\n    domain = domain.replace(/\\{\\{AppId\\}\\}/ig, appId)\r\n        .replace(/\\{\\{Bucket\\}\\}/ig, shortBucket)\r\n        .replace(/\\{\\{Region\\}\\}/ig, region)\r\n        .replace(/\\{\\{.*?\\}\\}/ig, '');\r\n    domain = domain.replace(/\\{AppId\\}/ig, appId)\r\n        .replace(/\\{BucketName\\}/ig, shortBucket)\r\n        .replace(/\\{Bucket\\}/ig, longBucket)\r\n        .replace(/\\{Region\\}/ig, region)\r\n        .replace(/\\{.*?\\}/ig, '');\r\n    if (!/^[a-zA-Z]+:\\/\\//.test(domain)) {\r\n        domain = protocol + '//' + domain;\r\n    }\r\n\r\n    // \r\n    if (domain.slice(-1) === '/') {\r\n        domain = domain.slice(0, -1);\r\n    }\r\n    var url = domain;\r\n\r\n    if (params.ForcePathStyle) {\r\n        url += '/' + longBucket;\r\n    }\r\n    url += '/';\r\n    if (object) {\r\n        url += util.camSafeUrlEncode(object).replace(/%2F/g, '/');\r\n    }\r\n\r\n    if (params.isLocation) {\r\n        url = url.replace(/^https?:\\/\\//, '');\r\n    }\r\n    return url;\r\n}\r\n\r\n// \r\nfunction getAuthorizationAsync(params, callback) {\r\n\r\n    var headers = util.clone(params.Headers);\r\n    delete headers['Content-Type'];\r\n    delete headers['Cache-Control'];\r\n    util.each(headers, function (v, k) {\r\n        v === '' && delete headers[k];\r\n    });\r\n\r\n    var cb = function (AuthData) {\r\n\r\n        // \r\n        var formatAllow = false;\r\n        var auth = AuthData.Authorization;\r\n        if (auth) {\r\n            if (auth.indexOf(' ') > -1) {\r\n                formatAllow = false;\r\n            } else if (auth.indexOf('q-sign-algorithm=') > -1 &&\r\n                auth.indexOf('q-ak=') > -1 &&\r\n                auth.indexOf('q-sign-time=') > -1 &&\r\n                auth.indexOf('q-key-time=') > -1 &&\r\n                auth.indexOf('q-url-param-list=') > -1) {\r\n                formatAllow = true;\r\n            } else {\r\n                try {\r\n                    auth = atob(auth);\r\n                    if (auth.indexOf('a=') > -1 &&\r\n                        auth.indexOf('k=') > -1 &&\r\n                        auth.indexOf('t=') > -1 &&\r\n                        auth.indexOf('r=') > -1 &&\r\n                        auth.indexOf('b=') > -1) {\r\n                        formatAllow = true;\r\n                    }\r\n                } catch (e) {}\r\n            }\r\n        }\r\n        if (formatAllow) {\r\n            callback && callback(null, AuthData);\r\n        } else {\r\n            callback && callback('authorization error');\r\n        }\r\n    };\r\n\r\n    var self = this;\r\n    var Bucket = params.Bucket || '';\r\n    var Region = params.Region || '';\r\n\r\n    // PathName\r\n    var KeyName = params.Key || '';\r\n    if (self.options.ForcePathStyle && Bucket) {\r\n        KeyName = Bucket + '/' + KeyName;\r\n    }\r\n    var Pathname = '/' + KeyName;\r\n\r\n    // ActionResourceKey\r\n    var StsData = {};\r\n    var Scope = params.Scope;\r\n    if (!Scope) {\r\n        var Action = params.Action || '';\r\n        var ResourceKey = params.ResourceKey || params.Key || '';\r\n        Scope = params.Scope || [{\r\n            action: Action,\r\n            bucket: Bucket,\r\n            region: Region,\r\n            prefix: ResourceKey,\r\n        }];\r\n    }\r\n    var ScopeKey  = util.md5(JSON.stringify(Scope));\r\n\r\n    // STS\r\n    self._StsCache = self._StsCache ||[];\r\n    (function () {\r\n        var i, AuthData;\r\n        for (i = self._StsCache.length - 1; i >= 0; i--) {\r\n            AuthData = self._StsCache[i];\r\n            var compareTime = Math.round(util.getSkewTime(self.options.SystemClockOffset) / 1000) + 30;\r\n            if (AuthData.StartTime && compareTime < AuthData.StartTime || compareTime >= AuthData.ExpiredTime) {\r\n                self._StsCache.splice(i, 1);\r\n                continue;\r\n            }\r\n            if (!AuthData.ScopeLimit || AuthData.ScopeLimit && AuthData.ScopeKey === ScopeKey) {\r\n                StsData = AuthData;\r\n                break;\r\n            }\r\n        }\r\n    })();\r\n\r\n    var calcAuthByTmpKey = function () {\r\n        var KeyTime = StsData.StartTime && StsData.ExpiredTime ? StsData.StartTime + ';' + StsData.ExpiredTime : '';\r\n        var Authorization = util.getAuth({\r\n            SecretId: StsData.TmpSecretId,\r\n            SecretKey: StsData.TmpSecretKey,\r\n            Method: params.Method,\r\n            Pathname: Pathname,\r\n            Query: params.Query,\r\n            Headers: headers,\r\n            Expires: params.Expires,\r\n            UseRawKey: self.options.UseRawKey,\r\n            SystemClockOffset: self.options.SystemClockOffset,\r\n            KeyTime: KeyTime\r\n        });\r\n        var AuthData = {\r\n            Authorization: Authorization,\r\n            XCosSecurityToken: StsData.XCosSecurityToken || '',\r\n            Token: StsData.Token || '',\r\n            ClientIP: StsData.ClientIP || '',\r\n            ClientUA: StsData.ClientUA || '',\r\n        };\r\n        cb(AuthData);\r\n    };\r\n\r\n    // \r\n    if (StsData.ExpiredTime && StsData.ExpiredTime - (util.getSkewTime(self.options.SystemClockOffset) / 1000) > 60) { // 60\r\n        calcAuthByTmpKey();\r\n    } else if (self.options.getAuthorization) { // \r\n        self.options.getAuthorization.call(self, {\r\n            Bucket: Bucket,\r\n            Region: Region,\r\n            Method: params.Method,\r\n            Key: KeyName,\r\n            Pathname: Pathname,\r\n            Query: params.Query,\r\n            Headers: headers,\r\n            Scope: Scope,\r\n            SystemClockOffset: self.options.SystemClockOffset,\r\n        }, function (AuthData) {\r\n            if (typeof AuthData === 'string') {\r\n                AuthData = {Authorization: AuthData};\r\n            }\r\n            if (AuthData.TmpSecretId &&\r\n                AuthData.TmpSecretKey &&\r\n                AuthData.XCosSecurityToken &&\r\n                AuthData.ExpiredTime) {\r\n                StsData = AuthData || {};\r\n                StsData.Scope = Scope;\r\n                StsData.ScopeKey = ScopeKey;\r\n                self._StsCache.push(StsData);\r\n                calcAuthByTmpKey();\r\n            } else {\r\n                cb(AuthData);\r\n            }\r\n        });\r\n    } else if (self.options.getSTS) { // \r\n        self.options.getSTS.call(self, {\r\n            Bucket: Bucket,\r\n            Region: Region,\r\n        }, function (data) {\r\n            StsData = data || {};\r\n            StsData.Scope = Scope;\r\n            StsData.ScopeKey = ScopeKey;\r\n            StsData.TmpSecretId = StsData.SecretId;\r\n            StsData.TmpSecretKey = StsData.SecretKey;\r\n            self._StsCache.push(StsData);\r\n            calcAuthByTmpKey();\r\n        });\r\n    } else { // \r\n        return (function () {\r\n            var Authorization = util.getAuth({\r\n                SecretId: params.SecretId || self.options.SecretId,\r\n                SecretKey: params.SecretKey || self.options.SecretKey,\r\n                Method: params.Method,\r\n                Pathname: Pathname,\r\n                Query: params.Query,\r\n                Headers: headers,\r\n                Expires: params.Expires,\r\n                UseRawKey: self.options.UseRawKey,\r\n                SystemClockOffset: self.options.SystemClockOffset,\r\n            });\r\n            var AuthData = {\r\n                Authorization: Authorization,\r\n                XCosSecurityToken: self.options.XCosSecurityToken,\r\n            };\r\n            cb(AuthData);\r\n            return AuthData;\r\n        })();\r\n    }\r\n    return '';\r\n}\r\n\r\n// \r\nfunction allowRetry(err) {\r\n    var allowRetry = false;\r\n    var isTimeError = false;\r\n    var serverDate = (err.headers && (err.headers.date || err.headers.Date)) || (err.error && err.error.ServerTime);\r\n    try {\r\n        var errorCode = err.error.Code;\r\n        var errorMessage = err.error.Message;\r\n        if (errorCode === 'RequestTimeTooSkewed' ||\r\n            (errorCode === 'AccessDenied' && errorMessage === 'Request has expired')) {\r\n            isTimeError = true;\r\n        }\r\n    } catch (e) {\r\n    }\r\n    if (err) {\r\n        if (isTimeError && serverDate) {\r\n            var serverTime = Date.parse(serverDate);\r\n            if (this.options.CorrectClockSkew && Math.abs(util.getSkewTime(this.options.SystemClockOffset) - serverTime) >= 30000) {\r\n                console.error('error: Local time is too skewed.');\r\n                this.options.SystemClockOffset = serverTime - Date.now();\r\n                allowRetry = true;\r\n            }\r\n        } else if (Math.floor(err.statusCode / 100) === 5) {\r\n            allowRetry = true;\r\n        }\r\n    }\r\n    return allowRetry;\r\n}\r\n\r\n// \r\nfunction submitRequest(params, callback) {\r\n    var self = this;\r\n\r\n    //  headers\r\n    !params.headers && (params.headers = {});\r\n\r\n    //  query\r\n    !params.qs && (params.qs = {});\r\n    params.VersionId && (params.qs.versionId = params.VersionId);\r\n    params.qs = util.clearKey(params.qs);\r\n\r\n    //  undefined  null \r\n    params.headers && (params.headers = util.clearKey(params.headers));\r\n    params.qs && (params.qs = util.clearKey(params.qs));\r\n\r\n    var Query = util.clone(params.qs);\r\n    params.action && (Query[params.action] = '');\r\n\r\n    var next = function (tryTimes) {\r\n        var oldClockOffset = self.options.SystemClockOffset;\r\n        getAuthorizationAsync.call(self, {\r\n            Bucket: params.Bucket || '',\r\n            Region: params.Region || '',\r\n            Method: params.method,\r\n            Key: params.Key,\r\n            Query: Query,\r\n            Headers: params.headers,\r\n            Action: params.Action,\r\n            ResourceKey: params.ResourceKey,\r\n            Scope: params.Scope,\r\n        }, function (err, AuthData) {\r\n            if (err) {\r\n                callback(err);\r\n                return;\r\n            }\r\n            params.AuthData = AuthData;\r\n            _submitRequest.call(self, params, function (err, data) {\r\n                if (err && tryTimes < 2 && (oldClockOffset !== self.options.SystemClockOffset || allowRetry.call(self, err))) {\r\n                    if (params.headers) {\r\n                        delete params.headers.Authorization;\r\n                        delete params.headers['token'];\r\n                        delete params.headers['clientIP'];\r\n                        delete params.headers['clientUA'];\r\n                        delete params.headers['x-cos-security-token'];\r\n                    }\r\n                    next(tryTimes + 1);\r\n                } else {\r\n                    callback(err, data);\r\n                }\r\n            });\r\n        });\r\n    };\r\n    next(1);\r\n\r\n}\r\n\r\n// \r\nfunction _submitRequest(params, callback) {\r\n    var self = this;\r\n    var TaskId = params.TaskId;\r\n    if (TaskId && !self._isRunningTask(TaskId)) return;\r\n\r\n    var bucket = params.Bucket;\r\n    var region = params.Region;\r\n    var object = params.Key;\r\n    var method = params.method || 'GET';\r\n    var url = params.url;\r\n    var body = params.body;\r\n    var rawBody = params.rawBody;\r\n\r\n    // url\r\n    url = url || getUrl({\r\n        ForcePathStyle: self.options.ForcePathStyle,\r\n        protocol: self.options.Protocol,\r\n        domain: self.options.Domain,\r\n        bucket: bucket,\r\n        region: region,\r\n        object: object,\r\n    });\r\n    if (params.action) {\r\n        url = url + '?' + params.action;\r\n    }\r\n\r\n    var opt = {\r\n        method: method,\r\n        url: url,\r\n        headers: params.headers,\r\n        qs: params.qs,\r\n        body: body,\r\n    };\r\n\r\n    // \r\n    opt.headers.Authorization = params.AuthData.Authorization;\r\n    params.AuthData.Token && (opt.headers['token'] = params.AuthData.Token);\r\n    params.AuthData.ClientIP && (opt.headers['clientIP'] = params.AuthData.ClientIP);\r\n    params.AuthData.ClientUA && (opt.headers['clientUA'] = params.AuthData.ClientUA);\r\n    params.AuthData.XCosSecurityToken && (opt.headers['x-cos-security-token'] = params.AuthData.XCosSecurityToken);\r\n\r\n    //  undefined  null \r\n    opt.headers && (opt.headers = util.clearKey(opt.headers));\r\n    opt = util.clearKey(opt);\r\n\r\n    // progress\r\n    if (params.onProgress && typeof params.onProgress === 'function') {\r\n        var contentLength = body && (body.size || body.length) || 0;\r\n        opt.onProgress = function (e) {\r\n            if (TaskId && !self._isRunningTask(TaskId)) return;\r\n            var loaded = e ? e.loaded : 0;\r\n            params.onProgress({loaded: loaded, total: contentLength});\r\n        };\r\n    }\r\n    if (params.DataType) {\r\n        opt.dataType = params.DataType;\r\n    }\r\n    if (this.options.Timeout) {\r\n        opt.timeout = this.options.Timeout;\r\n    }\r\n\r\n    //  cosInterface  before-send \r\n    if (params.Interface) {\r\n        opt.cosInterface = params.Interface;\r\n    } else if (params.Action) {\r\n        opt.cosInterface = params.Action.replace(/^name\\/cos:/, '');\r\n    }\r\n\r\n    self.options.ForcePathStyle && (opt.pathStyle = self.options.ForcePathStyle);\r\n    self.emit('before-send', opt);\r\n    var sender = (self.options.Request || REQUEST)(opt, function (r) {\r\n        if (r.error === 'abort') return;\r\n\r\n        //  errorstatusCodestatusMessagebody\r\n        self.emit('after-receive', r);\r\n        var response = {statusCode: r.statusCode, statusMessage: r.statusMessage, headers: r.headers};\r\n        var err = r.error;\r\n        var body = r.body;\r\n\r\n        //    headers\r\n        var hasReturned;\r\n        var cb = function (err, data) {\r\n            TaskId && self.off('inner-kill-task', killTask);\r\n            if (hasReturned) return;\r\n            hasReturned = true;\r\n            var attrs = {};\r\n            response && response.statusCode && (attrs.statusCode = response.statusCode);\r\n            response && response.headers && (attrs.headers = response.headers);\r\n\r\n            if (err) {\r\n                err = util.extend(err || {}, attrs)\r\n                callback(err, null);\r\n            } else {\r\n                data = util.extend(data || {}, attrs);\r\n                callback(null, data);\r\n            }\r\n            sender = null;\r\n        };\r\n\r\n        // \r\n        if (err) {\r\n            cb({error: err});\r\n            return;\r\n        }\r\n\r\n        //  body body \r\n        var jsonRes;\r\n        if (rawBody) {\r\n            jsonRes = {};\r\n            jsonRes.body = body;\r\n        } else {\r\n            try {\r\n                jsonRes = body && body.indexOf('<') > -1 && body.indexOf('>') > -1 && util.xml2json(body) || {};\r\n            } catch (e) {\r\n                jsonRes = body || {};\r\n            }\r\n        }\r\n\r\n        //  200\r\n        var statusCode = response.statusCode;\r\n        var statusSuccess = Math.floor(statusCode / 100) === 2; // 200 202 204 206\r\n        if (!statusSuccess) {\r\n            cb({error: jsonRes.Error || jsonRes});\r\n            return;\r\n        }\r\n\r\n        if (jsonRes.Error) {\r\n            cb({error: jsonRes.Error});\r\n            return;\r\n        }\r\n        cb(null, jsonRes);\r\n    });\r\n\r\n    // kill task\r\n    var killTask = function (data) {\r\n        if (data.TaskId === TaskId) {\r\n            sender && sender.abort && sender.abort();\r\n            self.off('inner-kill-task', killTask);\r\n        }\r\n    };\r\n    TaskId && self.on('inner-kill-task', killTask);\r\n\r\n}\r\n\r\n\r\nvar API_MAP = {\r\n    // Bucket \r\n    getService: getService,                      // Bucket\r\n    putBucket: putBucket,\r\n    headBucket: headBucket,                      // Bucket\r\n    getBucket: getBucket,\r\n    deleteBucket: deleteBucket,\r\n    putBucketAcl: putBucketAcl,                  // BucketACL\r\n    getBucketAcl: getBucketAcl,\r\n    putBucketCors: putBucketCors,                // BucketCors\r\n    getBucketCors: getBucketCors,\r\n    deleteBucketCors: deleteBucketCors,\r\n    getBucketLocation: getBucketLocation,        // BucketLocation\r\n    getBucketPolicy: getBucketPolicy,            // BucketPolicy\r\n    putBucketPolicy: putBucketPolicy,\r\n    deleteBucketPolicy: deleteBucketPolicy,\r\n    putBucketTagging: putBucketTagging,          // BucketTagging\r\n    getBucketTagging: getBucketTagging,\r\n    deleteBucketTagging: deleteBucketTagging,\r\n    putBucketLifecycle: putBucketLifecycle,      // BucketLifecycle\r\n    getBucketLifecycle: getBucketLifecycle,\r\n    deleteBucketLifecycle: deleteBucketLifecycle,\r\n    putBucketVersioning: putBucketVersioning,    // BucketVersioning\r\n    getBucketVersioning: getBucketVersioning,\r\n    putBucketReplication: putBucketReplication,  // BucketReplication\r\n    getBucketReplication: getBucketReplication,\r\n    deleteBucketReplication: deleteBucketReplication,\r\n    putBucketWebsite: putBucketWebsite,          // BucketWebsite\r\n    getBucketWebsite: getBucketWebsite,\r\n    deleteBucketWebsite: deleteBucketWebsite,\r\n    putBucketReferer: putBucketReferer,          // BucketReferer\r\n    getBucketReferer: getBucketReferer,\r\n    putBucketDomain: putBucketDomain,            // BucketDomain\r\n    getBucketDomain: getBucketDomain,\r\n    deleteBucketDomain: deleteBucketDomain,\r\n    putBucketOrigin: putBucketOrigin,            // BucketOrigin\r\n    getBucketOrigin: getBucketOrigin,\r\n    deleteBucketOrigin: deleteBucketOrigin,\r\n    putBucketLogging: putBucketLogging,             // BucketLogging\r\n    getBucketLogging: getBucketLogging,\r\n    putBucketInventory: putBucketInventory,         // BucketInventory\r\n    getBucketInventory: getBucketInventory,\r\n    listBucketInventory: listBucketInventory,\r\n    deleteBucketInventory: deleteBucketInventory,\r\n    putBucketAccelerate: putBucketAccelerate,\r\n    getBucketAccelerate: getBucketAccelerate,\r\n\r\n    // Object \r\n    getObject: getObject,\r\n    headObject: headObject,\r\n    listObjectVersions: listObjectVersions,\r\n    putObject: putObject,\r\n    deleteObject: deleteObject,\r\n    getObjectAcl: getObjectAcl,\r\n    putObjectAcl: putObjectAcl,\r\n    optionsObject: optionsObject,\r\n    putObjectCopy: putObjectCopy,\r\n    deleteMultipleObject: deleteMultipleObject,\r\n    restoreObject: restoreObject,\r\n    putObjectTagging: putObjectTagging,\r\n    getObjectTagging: getObjectTagging,\r\n    deleteObjectTagging: deleteObjectTagging,\r\n    selectObjectContent: selectObjectContent,\r\n\r\n    // \r\n    uploadPartCopy: uploadPartCopy,\r\n    multipartInit: multipartInit,\r\n    multipartUpload: multipartUpload,\r\n    multipartComplete: multipartComplete,\r\n    multipartList: multipartList,\r\n    multipartListPart: multipartListPart,\r\n    multipartAbort: multipartAbort,\r\n\r\n    // \r\n    getObjectUrl: getObjectUrl,\r\n    getAuth: getAuth,\r\n};\r\n\r\nfunction warnOldApi(apiName, fn, proto) {\r\n    util.each(['Cors', 'Acl'], function (suffix) {\r\n        if (apiName.slice(-suffix.length) === suffix) {\r\n            var oldName = apiName.slice(0, -suffix.length) + suffix.toUpperCase();\r\n            var apiFn = util.apiWrapper(apiName, fn);\r\n            var warned = false;\r\n            proto[oldName] = function () {\r\n                !warned && console.warn('warning: cos.' + oldName + ' has been deprecated. Please Use cos.' + apiName + ' instead.');\r\n                warned = true;\r\n                apiFn.apply(this, arguments);\r\n            };\r\n        }\r\n    });\r\n}\r\n\r\nmodule.exports.init = function (COS, task) {\r\n    task.transferToTaskMethod(API_MAP, 'putObject');\r\n    util.each(API_MAP, function (fn, apiName) {\r\n        COS.prototype[apiName] = util.apiWrapper(apiName, fn);\r\n        warnOldApi(apiName, fn, COS.prototype);\r\n    });\r\n};\r\n","//copyright Ryan Day 2010 <http://ryanday.org>, Joscha Feth 2013 <http://www.feth.com> [MIT Licensed]\r\n\r\nvar element_start_char =\r\n    \"a-zA-Z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u00FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FFF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\";\r\nvar element_non_start_char = \"\\-.0-9\\u00B7\\u0300-\\u036F\\u203F\\u2040\";\r\nvar element_replace = new RegExp(\"^([^\" + element_start_char + \"])|^((x|X)(m|M)(l|L))|([^\" + element_start_char + element_non_start_char + \"])\", \"g\");\r\nvar not_safe_in_xml = /[^\\x09\\x0A\\x0D\\x20-\\xFF\\x85\\xA0-\\uD7FF\\uE000-\\uFDCF\\uFDE0-\\uFFFD]/gm;\r\n\r\nvar objKeys = function (obj) {\r\n    var l = [];\r\n    if (obj instanceof Object) {\r\n        for (var k in obj) {\r\n            if (obj.hasOwnProperty(k)) {\r\n                l.push(k);\r\n            }\r\n        }\r\n    }\r\n    return l;\r\n};\r\nvar process_to_xml = function (node_data, options) {\r\n\r\n    var makeNode = function (name, content, attributes, level, hasSubNodes) {\r\n        var indent_value = options.indent !== undefined ? options.indent : \"\\t\";\r\n        var indent = options.prettyPrint ? '\\n' + new Array(level).join(indent_value) : '';\r\n        if (options.removeIllegalNameCharacters) {\r\n            name = name.replace(element_replace, '_');\r\n        }\r\n\r\n        var node = [indent, '<', name, (attributes || '')];\r\n        if (content && content.length > 0) {\r\n            node.push('>')\r\n            node.push(content);\r\n            hasSubNodes && node.push(indent);\r\n            node.push('</');\r\n            node.push(name);\r\n            node.push('>');\r\n        } else {\r\n            node.push('/>');\r\n        }\r\n        return node.join('');\r\n    };\r\n\r\n    return (function fn(node_data, node_descriptor, level) {\r\n        var type = typeof node_data;\r\n        if ((Array.isArray) ? Array.isArray(node_data) : node_data instanceof Array) {\r\n            type = 'array';\r\n        } else if (node_data instanceof Date) {\r\n            type = 'date';\r\n        }\r\n\r\n        switch (type) {\r\n            //if value is an array create child nodes from values\r\n            case 'array':\r\n                var ret = [];\r\n                node_data.map(function (v) {\r\n                    ret.push(fn(v, 1, level + 1));\r\n                    //entries that are values of an array are the only ones that can be special node descriptors\r\n                });\r\n                options.prettyPrint && ret.push('\\n');\r\n                return ret.join('');\r\n                break;\r\n\r\n            case 'date':\r\n                // cast dates to ISO 8601 date (soap likes it)\r\n                return node_data.toJSON ? node_data.toJSON() : node_data + '';\r\n                break;\r\n\r\n            case 'object':\r\n                var nodes = [];\r\n                for (var name in node_data) {\r\n                    if (node_data.hasOwnProperty(name)) {\r\n                        if (node_data[name] instanceof Array) {\r\n                            for (var j = 0; j < node_data[name].length; j++) {\r\n                                if (node_data[name].hasOwnProperty(j)) {\r\n                                    nodes.push(makeNode(name, fn(node_data[name][j], 0, level + 1), null, level + 1, objKeys(node_data[name][j]).length));\r\n                                }\r\n                            }\r\n                        } else {\r\n                            nodes.push(makeNode(name, fn(node_data[name], 0, level + 1), null, level + 1));\r\n                        }\r\n                    }\r\n                }\r\n                options.prettyPrint && nodes.length > 0 && nodes.push('\\n');\r\n                return nodes.join('');\r\n                break;\r\n\r\n            case 'function':\r\n                return node_data();\r\n                break;\r\n\r\n            default:\r\n                return options.escape ? esc(node_data) : '' + node_data;\r\n        }\r\n\r\n    }(node_data, 0, 0))\r\n};\r\n\r\n\r\nvar xml_header = function (standalone) {\r\n    var ret = ['<?xml version=\"1.0\" encoding=\"UTF-8\"'];\r\n\r\n    if (standalone) {\r\n        ret.push(' standalone=\"yes\"');\r\n    }\r\n    ret.push('?>');\r\n\r\n    return ret.join('');\r\n};\r\n\r\nfunction esc(str) {\r\n    return ('' + str).replace(/&/g, '&amp;')\r\n        .replace(/</g, '&lt;')\r\n        .replace(/>/g, '&gt;')\r\n        .replace(/'/g, '&apos;')\r\n        .replace(/\"/g, '&quot;')\r\n        .replace(not_safe_in_xml, '');\r\n}\r\n\r\nmodule.exports = function (obj, options) {\r\n    if (!options) {\r\n        options = {\r\n            xmlHeader: {\r\n                standalone: true\r\n            },\r\n            prettyPrint: true,\r\n            indent: \"  \",\r\n            escape: true,\r\n        };\r\n    }\r\n\r\n    if (typeof obj == 'string') {\r\n        try {\r\n            obj = JSON.parse(obj.toString());\r\n        } catch (e) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    var xmlheader = '';\r\n    var docType = '';\r\n    if (options) {\r\n        if (typeof options == 'object') {\r\n            // our config is an object\r\n\r\n            if (options.xmlHeader) {\r\n                // the user wants an xml header\r\n                xmlheader = xml_header(!!options.xmlHeader.standalone);\r\n            }\r\n\r\n            if (typeof options.docType != 'undefined') {\r\n                docType = '<!DOCTYPE ' + options.docType + '>'\r\n            }\r\n        } else {\r\n            // our config is a boolean value, so just add xml header\r\n            xmlheader = xml_header();\r\n        }\r\n    }\r\n    options = options || {}\r\n\r\n    var ret = [\r\n        xmlheader,\r\n        (options.prettyPrint && docType ? '\\n' : ''),\r\n        docType,\r\n        process_to_xml(obj, options)\r\n    ];\r\n    return ret.join('').replace(/\\n{2,}/g, '\\n').replace(/\\s+$/g, '');\r\n};","var eachLimit = function (arr, limit, iterator, callback) {\r\n    callback = callback || function () {};\r\n    if (!arr.length || limit <= 0) {\r\n        return callback();\r\n    }\r\n\r\n    var completed = 0;\r\n    var started = 0;\r\n    var running = 0;\r\n\r\n    (function replenish () {\r\n        if (completed >= arr.length) {\r\n            return callback();\r\n        }\r\n\r\n        while (running < limit && started < arr.length) {\r\n            started += 1;\r\n            running += 1;\r\n            iterator(arr[started - 1], function (err) {\r\n\r\n                if (err) {\r\n                    callback(err);\r\n                    callback = function () {};\r\n                } else {\r\n                    completed += 1;\r\n                    running -= 1;\r\n                    if (completed >= arr.length) {\r\n                        callback();\r\n                    } else {\r\n                        replenish();\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    })();\r\n};\r\n\r\nvar retry = function (times, iterator, callback) {\r\n    var next = function (index) {\r\n        iterator(function (err, data) {\r\n            if (err && index < times) {\r\n                next(index + 1);\r\n            } else {\r\n                callback(err, data);\r\n            }\r\n        });\r\n    };\r\n    if (times < 1) {\r\n        callback();\r\n    } else {\r\n        next(1);\r\n    }\r\n};\r\n\r\nvar async = {\r\n    eachLimit: eachLimit,\r\n    retry: retry\r\n};\r\n\r\nmodule.exports = async;","var stringifyPrimitive = function(v) {\r\n    switch (typeof v) {\r\n        case 'string':\r\n            return v;\r\n        case 'boolean':\r\n            return v ? 'true' : 'false';\r\n        case 'number':\r\n            return isFinite(v) ? v : '';\r\n        default:\r\n            return '';\r\n    }\r\n};\r\n\r\nvar queryStringify = function(obj, sep, eq, name) {\r\n    sep = sep || '&';\r\n    eq = eq || '=';\r\n    if (obj === null) {\r\n        obj = undefined;\r\n    }\r\n    if (typeof obj === 'object') {\r\n        return Object.keys(obj).map(function(k) {\r\n            var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;\r\n            if (Array.isArray(obj[k])) {\r\n                return obj[k].map(function(v) {\r\n                    return ks + encodeURIComponent(stringifyPrimitive(v));\r\n                }).join(sep);\r\n            } else {\r\n                return ks + encodeURIComponent(stringifyPrimitive(obj[k]));\r\n            }\r\n        }).filter(Boolean).join(sep);\r\n\r\n    }\r\n    if (!name) return '';\r\n    return encodeURIComponent(stringifyPrimitive(name)) + eq +\r\n        encodeURIComponent(stringifyPrimitive(obj));\r\n};\r\n\r\nvar xhrRes = function (err, xhr, body) {\r\n    var headers = {};\r\n    xhr.getAllResponseHeaders().trim().split('\\n').forEach(function (item) {\r\n        if (item) {\r\n            var index = item.indexOf(':');\r\n            var key = item.substr(0, index).trim().toLowerCase();\r\n            var val = item.substr(index + 1).trim();\r\n            headers[key] = val;\r\n        }\r\n    });\r\n    return {\r\n        error: err,\r\n        statusCode: xhr.status,\r\n        statusMessage: xhr.statusText,\r\n        headers: headers,\r\n        body: body,\r\n    };\r\n};\r\n\r\nvar xhrBody = function (xhr, dataType) {\r\n    return !dataType && dataType === 'text' ? xhr.responseText : xhr.response;\r\n};\r\n\r\nvar request = function (opt, callback) {\r\n\r\n    // method\r\n    var method = (opt.method || 'GET').toUpperCase();\r\n\r\n    // urlqs\r\n    var url = opt.url;\r\n    if (opt.qs) {\r\n        var qsStr = queryStringify(opt.qs);\r\n        if (qsStr) {\r\n            url += (url.indexOf('?') === -1 ? '?' : '&') + qsStr;\r\n        }\r\n    }\r\n\r\n    //  ajax \r\n    var xhr = new XMLHttpRequest();\r\n    xhr.open(method, url, true);\r\n    xhr.responseType = opt.dataType || 'text';\r\n\r\n    //  headers\r\n    var headers = opt.headers;\r\n    if (headers) {\r\n        for (var key in headers) {\r\n            if (headers.hasOwnProperty(key) &&\r\n                key.toLowerCase() !== 'content-length' &&\r\n                key.toLowerCase() !== 'user-agent' &&\r\n                key.toLowerCase() !== 'origin' &&\r\n                key.toLowerCase() !== 'host') {\r\n                xhr.setRequestHeader(key, headers[key]);\r\n            }\r\n        }\r\n    }\r\n\r\n    // onprogress\r\n    if (opt.onProgress && xhr.upload) xhr.upload.onprogress = opt.onProgress;\r\n\r\n    // success 2xx/3xx/4xx\r\n    xhr.onload = function () {\r\n        callback(xhrRes(null, xhr, xhrBody(xhr, opt.dataType)));\r\n    };\r\n\r\n    // error 5xx/0 (Https connect-src  statusCode  0)\r\n    xhr.onerror = function (err) {\r\n        var body = xhrBody(xhr, opt.dataType);\r\n        if (body) { // 5xx\r\n            callback(xhrRes(null, xhr, body));\r\n        } else { // 0\r\n            var error = xhr.statusText;\r\n            if (!error && xhr.status === 0) error = 'CORS blocked or network error';\r\n            callback(xhrRes(error, xhr, body));\r\n        }\r\n    };\r\n\r\n    // send\r\n    xhr.send(opt.body || '');\r\n\r\n    //  ajax  xhr.abort\r\n    return xhr;\r\n};\r\n\r\nmodule.exports = request;\r\n","//[4]   \tNameStartChar\t   ::=   \t\":\" | [A-Z] | \"_\" | [a-z] | [#xC0-#xD6] | [#xD8-#xF6] | [#xF8-#x2FF] | [#x370-#x37D] | [#x37F-#x1FFF] | [#x200C-#x200D] | [#x2070-#x218F] | [#x2C00-#x2FEF] | [#x3001-#xD7FF] | [#xF900-#xFDCF] | [#xFDF0-#xFFFD] | [#x10000-#xEFFFF]\r\n//[4a]   \tNameChar\t   ::=   \tNameStartChar | \"-\" | \".\" | [0-9] | #xB7 | [#x0300-#x036F] | [#x203F-#x2040]\r\n//[5]   \tName\t   ::=   \tNameStartChar (NameChar)*\r\nvar nameStartChar = /[A-Z_a-z\\xC0-\\xD6\\xD8-\\xF6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD]///\\u10000-\\uEFFFF\r\nvar nameChar = new RegExp(\"[\\\\-\\\\.0-9\"+nameStartChar.source.slice(1,-1)+\"\\\\u00B7\\\\u0300-\\\\u036F\\\\u203F-\\\\u2040]\");\r\nvar tagNamePattern = new RegExp('^'+nameStartChar.source+nameChar.source+'*(?:\\:'+nameStartChar.source+nameChar.source+'*)?$');\r\n//var tagNamePattern = /^[a-zA-Z_][\\w\\-\\.]*(?:\\:[a-zA-Z_][\\w\\-\\.]*)?$/\r\n//var handlers = 'resolveEntity,getExternalSubset,characters,endDocument,endElement,endPrefixMapping,ignorableWhitespace,processingInstruction,setDocumentLocator,skippedEntity,startDocument,startElement,startPrefixMapping,notationDecl,unparsedEntityDecl,error,fatalError,warning,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,comment,endCDATA,endDTD,endEntity,startCDATA,startDTD,startEntity'.split(',')\r\n\r\n//S_TAG,\tS_ATTR,\tS_EQ,\tS_ATTR_NOQUOT_VALUE\r\n//S_ATTR_SPACE,\tS_ATTR_END,\tS_TAG_SPACE, S_TAG_CLOSE\r\nvar S_TAG = 0;//tag name offerring\r\nvar S_ATTR = 1;//attr name offerring \r\nvar S_ATTR_SPACE=2;//attr name end and space offer\r\nvar S_EQ = 3;//=space?\r\nvar S_ATTR_NOQUOT_VALUE = 4;//attr value(no quot value only)\r\nvar S_ATTR_END = 5;//attr value end and no space(quot end)\r\nvar S_TAG_SPACE = 6;//(attr value end || tag end ) && (space offer)\r\nvar S_TAG_CLOSE = 7;//closed el<el />\r\n\r\nfunction XMLReader(){\r\n\t\r\n}\r\n\r\nXMLReader.prototype = {\r\n\tparse:function(source,defaultNSMap,entityMap){\r\n\t\tvar domBuilder = this.domBuilder;\r\n\t\tdomBuilder.startDocument();\r\n\t\t_copy(defaultNSMap ,defaultNSMap = {})\r\n\t\tparse(source,defaultNSMap,entityMap,\r\n\t\t\t\tdomBuilder,this.errorHandler);\r\n\t\tdomBuilder.endDocument();\r\n\t}\r\n}\r\nfunction parse(source,defaultNSMapCopy,entityMap,domBuilder,errorHandler){\r\n\tfunction fixedFromCharCode(code) {\r\n\t\t// String.prototype.fromCharCode does not supports\r\n\t\t// > 2 bytes unicode chars directly\r\n\t\tif (code > 0xffff) {\r\n\t\t\tcode -= 0x10000;\r\n\t\t\tvar surrogate1 = 0xd800 + (code >> 10)\r\n\t\t\t\t, surrogate2 = 0xdc00 + (code & 0x3ff);\r\n\r\n\t\t\treturn String.fromCharCode(surrogate1, surrogate2);\r\n\t\t} else {\r\n\t\t\treturn String.fromCharCode(code);\r\n\t\t}\r\n\t}\r\n\tfunction entityReplacer(a){\r\n\t\tvar k = a.slice(1,-1);\r\n\t\tif(k in entityMap){\r\n\t\t\treturn entityMap[k]; \r\n\t\t}else if(k.charAt(0) === '#'){\r\n\t\t\treturn fixedFromCharCode(parseInt(k.substr(1).replace('x','0x')))\r\n\t\t}else{\r\n\t\t\terrorHandler.error('entity not found:'+a);\r\n\t\t\treturn a;\r\n\t\t}\r\n\t}\r\n\tfunction appendText(end){//has some bugs\r\n\t\tif(end>start){\r\n\t\t\tvar xt = source.substring(start,end).replace(/&#?\\w+;/g,entityReplacer);\r\n\t\t\tlocator&&position(start);\r\n\t\t\tdomBuilder.characters(xt,0,end-start);\r\n\t\t\tstart = end\r\n\t\t}\r\n\t}\r\n\tfunction position(p,m){\r\n\t\twhile(p>=lineEnd && (m = linePattern.exec(source))){\r\n\t\t\tlineStart = m.index;\r\n\t\t\tlineEnd = lineStart + m[0].length;\r\n\t\t\tlocator.lineNumber++;\r\n\t\t\t//console.log('line++:',locator,startPos,endPos)\r\n\t\t}\r\n\t\tlocator.columnNumber = p-lineStart+1;\r\n\t}\r\n\tvar lineStart = 0;\r\n\tvar lineEnd = 0;\r\n\tvar linePattern = /.*(?:\\r\\n?|\\n)|.*$/g\r\n\tvar locator = domBuilder.locator;\r\n\t\r\n\tvar parseStack = [{currentNSMap:defaultNSMapCopy}]\r\n\tvar closeMap = {};\r\n\tvar start = 0;\r\n\twhile(true){\r\n\t\ttry{\r\n\t\t\tvar tagStart = source.indexOf('<',start);\r\n\t\t\tif(tagStart<0){\r\n\t\t\t\tif(!source.substr(start).match(/^\\s*$/)){\r\n\t\t\t\t\tvar doc = domBuilder.doc;\r\n\t    \t\t\tvar text = doc.createTextNode(source.substr(start));\r\n\t    \t\t\tdoc.appendChild(text);\r\n\t    \t\t\tdomBuilder.currentElement = text;\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif(tagStart>start){\r\n\t\t\t\tappendText(tagStart);\r\n\t\t\t}\r\n\t\t\tswitch(source.charAt(tagStart+1)){\r\n\t\t\tcase '/':\r\n\t\t\t\tvar end = source.indexOf('>',tagStart+3);\r\n\t\t\t\tvar tagName = source.substring(tagStart+2,end);\r\n\t\t\t\tvar config = parseStack.pop();\r\n\t\t\t\tif(end<0){\r\n\t\t\t\t\t\r\n\t        \t\ttagName = source.substring(tagStart+2).replace(/[\\s<].*/,'');\r\n\t        \t\t//console.error('#@@@@@@'+tagName)\r\n\t        \t\terrorHandler.error(\"end tag name: \"+tagName+' is not complete:'+config.tagName);\r\n\t        \t\tend = tagStart+1+tagName.length;\r\n\t        \t}else if(tagName.match(/\\s</)){\r\n\t        \t\ttagName = tagName.replace(/[\\s<].*/,'');\r\n\t        \t\terrorHandler.error(\"end tag name: \"+tagName+' maybe not complete');\r\n\t        \t\tend = tagStart+1+tagName.length;\r\n\t\t\t\t}\r\n\t\t\t\t//console.error(parseStack.length,parseStack)\r\n\t\t\t\t//console.error(config);\r\n\t\t\t\tvar localNSMap = config.localNSMap;\r\n\t\t\t\tvar endMatch = config.tagName == tagName;\r\n\t\t\t\tvar endIgnoreCaseMach = endMatch || config.tagName&&config.tagName.toLowerCase() == tagName.toLowerCase()\r\n\t\t        if(endIgnoreCaseMach){\r\n\t\t        \tdomBuilder.endElement(config.uri,config.localName,tagName);\r\n\t\t\t\t\tif(localNSMap){\r\n\t\t\t\t\t\tfor(var prefix in localNSMap){\r\n\t\t\t\t\t\t\tdomBuilder.endPrefixMapping(prefix) ;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!endMatch){\r\n\t\t            \terrorHandler.fatalError(\"end tag name: \"+tagName+' is not match the current start tagName:'+config.tagName );\r\n\t\t\t\t\t}\r\n\t\t        }else{\r\n\t\t        \tparseStack.push(config)\r\n\t\t        }\r\n\t\t\t\t\r\n\t\t\t\tend++;\r\n\t\t\t\tbreak;\r\n\t\t\t\t// end elment\r\n\t\t\tcase '?':// <?...?>\r\n\t\t\t\tlocator&&position(tagStart);\r\n\t\t\t\tend = parseInstruction(source,tagStart,domBuilder);\r\n\t\t\t\tbreak;\r\n\t\t\tcase '!':// <!doctype,<![CDATA,<!--\r\n\t\t\t\tlocator&&position(tagStart);\r\n\t\t\t\tend = parseDCC(source,tagStart,domBuilder,errorHandler);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tlocator&&position(tagStart);\r\n\t\t\t\tvar el = new ElementAttributes();\r\n\t\t\t\tvar currentNSMap = parseStack[parseStack.length-1].currentNSMap;\r\n\t\t\t\t//elStartEnd\r\n\t\t\t\tvar end = parseElementStartPart(source,tagStart,el,currentNSMap,entityReplacer,errorHandler);\r\n\t\t\t\tvar len = el.length;\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tif(!el.closed && fixSelfClosed(source,end,el.tagName,closeMap)){\r\n\t\t\t\t\tel.closed = true;\r\n\t\t\t\t\tif(!entityMap.nbsp){\r\n\t\t\t\t\t\terrorHandler.warning('unclosed xml attribute');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(locator && len){\r\n\t\t\t\t\tvar locator2 = copyLocator(locator,{});\r\n\t\t\t\t\t//try{//attribute position fixed\r\n\t\t\t\t\tfor(var i = 0;i<len;i++){\r\n\t\t\t\t\t\tvar a = el[i];\r\n\t\t\t\t\t\tposition(a.offset);\r\n\t\t\t\t\t\ta.locator = copyLocator(locator,{});\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//}catch(e){console.error('@@@@@'+e)}\r\n\t\t\t\t\tdomBuilder.locator = locator2\r\n\t\t\t\t\tif(appendElement(el,domBuilder,currentNSMap)){\r\n\t\t\t\t\t\tparseStack.push(el)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdomBuilder.locator = locator;\r\n\t\t\t\t}else{\r\n\t\t\t\t\tif(appendElement(el,domBuilder,currentNSMap)){\r\n\t\t\t\t\t\tparseStack.push(el)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tif(el.uri === 'http://www.w3.org/1999/xhtml' && !el.closed){\r\n\t\t\t\t\tend = parseHtmlSpecialContent(source,end,el.tagName,entityReplacer,domBuilder)\r\n\t\t\t\t}else{\r\n\t\t\t\t\tend++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}catch(e){\r\n\t\t\terrorHandler.error('element parse error: '+e)\r\n\t\t\t//errorHandler.error('element parse error: '+e);\r\n\t\t\tend = -1;\r\n\t\t\t//throw e;\r\n\t\t}\r\n\t\tif(end>start){\r\n\t\t\tstart = end;\r\n\t\t}else{\r\n\t\t\t//TODO: sax\r\n\t\t\tappendText(Math.max(tagStart,start)+1);\r\n\t\t}\r\n\t}\r\n}\r\nfunction copyLocator(f,t){\r\n\tt.lineNumber = f.lineNumber;\r\n\tt.columnNumber = f.columnNumber;\r\n\treturn t;\r\n}\r\n\r\n/**\r\n * @see #appendElement(source,elStartEnd,el,selfClosed,entityReplacer,domBuilder,parseStack);\r\n * @return end of the elementStartPart(end of elementEndPart for selfClosed el)\r\n */\r\nfunction parseElementStartPart(source,start,el,currentNSMap,entityReplacer,errorHandler){\r\n\tvar attrName;\r\n\tvar value;\r\n\tvar p = ++start;\r\n\tvar s = S_TAG;//status\r\n\twhile(true){\r\n\t\tvar c = source.charAt(p);\r\n\t\tswitch(c){\r\n\t\tcase '=':\r\n\t\t\tif(s === S_ATTR){//attrName\r\n\t\t\t\tattrName = source.slice(start,p);\r\n\t\t\t\ts = S_EQ;\r\n\t\t\t}else if(s === S_ATTR_SPACE){\r\n\t\t\t\ts = S_EQ;\r\n\t\t\t}else{\r\n\t\t\t\t//fatalError: equal must after attrName or space after attrName\r\n\t\t\t\tthrow new Error('attribute equal must after attrName');\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase '\\'':\r\n\t\tcase '\"':\r\n\t\t\tif(s === S_EQ || s === S_ATTR //|| s == S_ATTR_SPACE\r\n\t\t\t\t){//equal\r\n\t\t\t\tif(s === S_ATTR){\r\n\t\t\t\t\terrorHandler.warning('attribute value must after \"=\"')\r\n\t\t\t\t\tattrName = source.slice(start,p)\r\n\t\t\t\t}\r\n\t\t\t\tstart = p+1;\r\n\t\t\t\tp = source.indexOf(c,start)\r\n\t\t\t\tif(p>0){\r\n\t\t\t\t\tvalue = source.slice(start,p).replace(/&#?\\w+;/g,entityReplacer);\r\n\t\t\t\t\tel.add(attrName,value,start-1);\r\n\t\t\t\t\ts = S_ATTR_END;\r\n\t\t\t\t}else{\r\n\t\t\t\t\t//fatalError: no end quot match\r\n\t\t\t\t\tthrow new Error('attribute value no end \\''+c+'\\' match');\r\n\t\t\t\t}\r\n\t\t\t}else if(s == S_ATTR_NOQUOT_VALUE){\r\n\t\t\t\tvalue = source.slice(start,p).replace(/&#?\\w+;/g,entityReplacer);\r\n\t\t\t\t//console.log(attrName,value,start,p)\r\n\t\t\t\tel.add(attrName,value,start);\r\n\t\t\t\t//console.dir(el)\r\n\t\t\t\terrorHandler.warning('attribute \"'+attrName+'\" missed start quot('+c+')!!');\r\n\t\t\t\tstart = p+1;\r\n\t\t\t\ts = S_ATTR_END\r\n\t\t\t}else{\r\n\t\t\t\t//fatalError: no equal before\r\n\t\t\t\tthrow new Error('attribute value must after \"=\"');\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase '/':\r\n\t\t\tswitch(s){\r\n\t\t\tcase S_TAG:\r\n\t\t\t\tel.setTagName(source.slice(start,p));\r\n\t\t\tcase S_ATTR_END:\r\n\t\t\tcase S_TAG_SPACE:\r\n\t\t\tcase S_TAG_CLOSE:\r\n\t\t\t\ts =S_TAG_CLOSE;\r\n\t\t\t\tel.closed = true;\r\n\t\t\tcase S_ATTR_NOQUOT_VALUE:\r\n\t\t\tcase S_ATTR:\r\n\t\t\tcase S_ATTR_SPACE:\r\n\t\t\t\tbreak;\r\n\t\t\t//case S_EQ:\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error(\"attribute invalid close char('/')\")\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase ''://end document\r\n\t\t\t//throw new Error('unexpected end of input')\r\n\t\t\terrorHandler.error('unexpected end of input');\r\n\t\t\tif(s == S_TAG){\r\n\t\t\t\tel.setTagName(source.slice(start,p));\r\n\t\t\t}\r\n\t\t\treturn p;\r\n\t\tcase '>':\r\n\t\t\tswitch(s){\r\n\t\t\tcase S_TAG:\r\n\t\t\t\tel.setTagName(source.slice(start,p));\r\n\t\t\tcase S_ATTR_END:\r\n\t\t\tcase S_TAG_SPACE:\r\n\t\t\tcase S_TAG_CLOSE:\r\n\t\t\t\tbreak;//normal\r\n\t\t\tcase S_ATTR_NOQUOT_VALUE://Compatible state\r\n\t\t\tcase S_ATTR:\r\n\t\t\t\tvalue = source.slice(start,p);\r\n\t\t\t\tif(value.slice(-1) === '/'){\r\n\t\t\t\t\tel.closed  = true;\r\n\t\t\t\t\tvalue = value.slice(0,-1)\r\n\t\t\t\t}\r\n\t\t\tcase S_ATTR_SPACE:\r\n\t\t\t\tif(s === S_ATTR_SPACE){\r\n\t\t\t\t\tvalue = attrName;\r\n\t\t\t\t}\r\n\t\t\t\tif(s == S_ATTR_NOQUOT_VALUE){\r\n\t\t\t\t\terrorHandler.warning('attribute \"'+value+'\" missed quot(\")!!');\r\n\t\t\t\t\tel.add(attrName,value.replace(/&#?\\w+;/g,entityReplacer),start)\r\n\t\t\t\t}else{\r\n\t\t\t\t\tif(currentNSMap[''] !== 'http://www.w3.org/1999/xhtml' || !value.match(/^(?:disabled|checked|selected)$/i)){\r\n\t\t\t\t\t\terrorHandler.warning('attribute \"'+value+'\" missed value!! \"'+value+'\" instead!!')\r\n\t\t\t\t\t}\r\n\t\t\t\t\tel.add(value,value,start)\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase S_EQ:\r\n\t\t\t\tthrow new Error('attribute value missed!!');\r\n\t\t\t}\r\n//\t\t\tconsole.log(tagName,tagNamePattern,tagNamePattern.test(tagName))\r\n\t\t\treturn p;\r\n\t\t/*xml space '\\x20' | #x9 | #xD | #xA; */\r\n\t\tcase '\\u0080':\r\n\t\t\tc = ' ';\r\n\t\tdefault:\r\n\t\t\tif(c<= ' '){//space\r\n\t\t\t\tswitch(s){\r\n\t\t\t\tcase S_TAG:\r\n\t\t\t\t\tel.setTagName(source.slice(start,p));//tagName\r\n\t\t\t\t\ts = S_TAG_SPACE;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase S_ATTR:\r\n\t\t\t\t\tattrName = source.slice(start,p)\r\n\t\t\t\t\ts = S_ATTR_SPACE;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase S_ATTR_NOQUOT_VALUE:\r\n\t\t\t\t\tvar value = source.slice(start,p).replace(/&#?\\w+;/g,entityReplacer);\r\n\t\t\t\t\terrorHandler.warning('attribute \"'+value+'\" missed quot(\")!!');\r\n\t\t\t\t\tel.add(attrName,value,start)\r\n\t\t\t\tcase S_ATTR_END:\r\n\t\t\t\t\ts = S_TAG_SPACE;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//case S_TAG_SPACE:\r\n\t\t\t\t//case S_EQ:\r\n\t\t\t\t//case S_ATTR_SPACE:\r\n\t\t\t\t//\tvoid();break;\r\n\t\t\t\t//case S_TAG_CLOSE:\r\n\t\t\t\t\t//ignore warning\r\n\t\t\t\t}\r\n\t\t\t}else{//not space\r\n//S_TAG,\tS_ATTR,\tS_EQ,\tS_ATTR_NOQUOT_VALUE\r\n//S_ATTR_SPACE,\tS_ATTR_END,\tS_TAG_SPACE, S_TAG_CLOSE\r\n\t\t\t\tswitch(s){\r\n\t\t\t\t//case S_TAG:void();break;\r\n\t\t\t\t//case S_ATTR:void();break;\r\n\t\t\t\t//case S_ATTR_NOQUOT_VALUE:void();break;\r\n\t\t\t\tcase S_ATTR_SPACE:\r\n\t\t\t\t\tvar tagName =  el.tagName;\r\n\t\t\t\t\tif(currentNSMap[''] !== 'http://www.w3.org/1999/xhtml' || !attrName.match(/^(?:disabled|checked|selected)$/i)){\r\n\t\t\t\t\t\terrorHandler.warning('attribute \"'+attrName+'\" missed value!! \"'+attrName+'\" instead2!!')\r\n\t\t\t\t\t}\r\n\t\t\t\t\tel.add(attrName,attrName,start);\r\n\t\t\t\t\tstart = p;\r\n\t\t\t\t\ts = S_ATTR;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase S_ATTR_END:\r\n\t\t\t\t\terrorHandler.warning('attribute space is required\"'+attrName+'\"!!')\r\n\t\t\t\tcase S_TAG_SPACE:\r\n\t\t\t\t\ts = S_ATTR;\r\n\t\t\t\t\tstart = p;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase S_EQ:\r\n\t\t\t\t\ts = S_ATTR_NOQUOT_VALUE;\r\n\t\t\t\t\tstart = p;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase S_TAG_CLOSE:\r\n\t\t\t\t\tthrow new Error(\"elements closed character '/' and '>' must be connected to\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}//end outer switch\r\n\t\t//console.log('p++',p)\r\n\t\tp++;\r\n\t}\r\n}\r\n/**\r\n * @return true if has new namespace define\r\n */\r\nfunction appendElement(el,domBuilder,currentNSMap){\r\n\tvar tagName = el.tagName;\r\n\tvar localNSMap = null;\r\n\t//var currentNSMap = parseStack[parseStack.length-1].currentNSMap;\r\n\tvar i = el.length;\r\n\twhile(i--){\r\n\t\tvar a = el[i];\r\n\t\tvar qName = a.qName;\r\n\t\tvar value = a.value;\r\n\t\tvar nsp = qName.indexOf(':');\r\n\t\tif(nsp>0){\r\n\t\t\tvar prefix = a.prefix = qName.slice(0,nsp);\r\n\t\t\tvar localName = qName.slice(nsp+1);\r\n\t\t\tvar nsPrefix = prefix === 'xmlns' && localName\r\n\t\t}else{\r\n\t\t\tlocalName = qName;\r\n\t\t\tprefix = null\r\n\t\t\tnsPrefix = qName === 'xmlns' && ''\r\n\t\t}\r\n\t\t//can not set prefix,because prefix !== ''\r\n\t\ta.localName = localName ;\r\n\t\t//prefix == null for no ns prefix attribute \r\n\t\tif(nsPrefix !== false){//hack!!\r\n\t\t\tif(localNSMap == null){\r\n\t\t\t\tlocalNSMap = {}\r\n\t\t\t\t//console.log(currentNSMap,0)\r\n\t\t\t\t_copy(currentNSMap,currentNSMap={})\r\n\t\t\t\t//console.log(currentNSMap,1)\r\n\t\t\t}\r\n\t\t\tcurrentNSMap[nsPrefix] = localNSMap[nsPrefix] = value;\r\n\t\t\ta.uri = 'http://www.w3.org/2000/xmlns/'\r\n\t\t\tdomBuilder.startPrefixMapping(nsPrefix, value) \r\n\t\t}\r\n\t}\r\n\tvar i = el.length;\r\n\twhile(i--){\r\n\t\ta = el[i];\r\n\t\tvar prefix = a.prefix;\r\n\t\tif(prefix){//no prefix attribute has no namespace\r\n\t\t\tif(prefix === 'xml'){\r\n\t\t\t\ta.uri = 'http://www.w3.org/XML/1998/namespace';\r\n\t\t\t}if(prefix !== 'xmlns'){\r\n\t\t\t\ta.uri = currentNSMap[prefix || '']\r\n\t\t\t\t\r\n\t\t\t\t//{console.log('###'+a.qName,domBuilder.locator.systemId+'',currentNSMap,a.uri)}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar nsp = tagName.indexOf(':');\r\n\tif(nsp>0){\r\n\t\tprefix = el.prefix = tagName.slice(0,nsp);\r\n\t\tlocalName = el.localName = tagName.slice(nsp+1);\r\n\t}else{\r\n\t\tprefix = null;//important!!\r\n\t\tlocalName = el.localName = tagName;\r\n\t}\r\n\t//no prefix element has default namespace\r\n\tvar ns = el.uri = currentNSMap[prefix || ''];\r\n\tdomBuilder.startElement(ns,localName,tagName,el);\r\n\t//endPrefixMapping and startPrefixMapping have not any help for dom builder\r\n\t//localNSMap = null\r\n\tif(el.closed){\r\n\t\tdomBuilder.endElement(ns,localName,tagName);\r\n\t\tif(localNSMap){\r\n\t\t\tfor(prefix in localNSMap){\r\n\t\t\t\tdomBuilder.endPrefixMapping(prefix) \r\n\t\t\t}\r\n\t\t}\r\n\t}else{\r\n\t\tel.currentNSMap = currentNSMap;\r\n\t\tel.localNSMap = localNSMap;\r\n\t\t//parseStack.push(el);\r\n\t\treturn true;\r\n\t}\r\n}\r\nfunction parseHtmlSpecialContent(source,elStartEnd,tagName,entityReplacer,domBuilder){\r\n\tif(/^(?:script|textarea)$/i.test(tagName)){\r\n\t\tvar elEndStart =  source.indexOf('</'+tagName+'>',elStartEnd);\r\n\t\tvar text = source.substring(elStartEnd+1,elEndStart);\r\n\t\tif(/[&<]/.test(text)){\r\n\t\t\tif(/^script$/i.test(tagName)){\r\n\t\t\t\t//if(!/\\]\\]>/.test(text)){\r\n\t\t\t\t\t//lexHandler.startCDATA();\r\n\t\t\t\t\tdomBuilder.characters(text,0,text.length);\r\n\t\t\t\t\t//lexHandler.endCDATA();\r\n\t\t\t\t\treturn elEndStart;\r\n\t\t\t\t//}\r\n\t\t\t}//}else{//text area\r\n\t\t\t\ttext = text.replace(/&#?\\w+;/g,entityReplacer);\r\n\t\t\t\tdomBuilder.characters(text,0,text.length);\r\n\t\t\t\treturn elEndStart;\r\n\t\t\t//}\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\treturn elStartEnd+1;\r\n}\r\nfunction fixSelfClosed(source,elStartEnd,tagName,closeMap){\r\n\t//if(tagName in closeMap){\r\n\tvar pos = closeMap[tagName];\r\n\tif(pos == null){\r\n\t\t//console.log(tagName)\r\n\t\tpos =  source.lastIndexOf('</'+tagName+'>')\r\n\t\tif(pos<elStartEnd){//\r\n\t\t\tpos = source.lastIndexOf('</'+tagName)\r\n\t\t}\r\n\t\tcloseMap[tagName] =pos\r\n\t}\r\n\treturn pos<elStartEnd;\r\n\t//} \r\n}\r\nfunction _copy(source,target){\r\n\tfor(var n in source){target[n] = source[n]}\r\n}\r\nfunction parseDCC(source,start,domBuilder,errorHandler){//sure start with '<!'\r\n\tvar next= source.charAt(start+2)\r\n\tswitch(next){\r\n\tcase '-':\r\n\t\tif(source.charAt(start + 3) === '-'){\r\n\t\t\tvar end = source.indexOf('-->',start+4);\r\n\t\t\t//append comment source.substring(4,end)//<!--\r\n\t\t\tif(end>start){\r\n\t\t\t\tdomBuilder.comment(source,start+4,end-start-4);\r\n\t\t\t\treturn end+3;\r\n\t\t\t}else{\r\n\t\t\t\terrorHandler.error(\"Unclosed comment\");\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\t//error\r\n\t\t\treturn -1;\r\n\t\t}\r\n\tdefault:\r\n\t\tif(source.substr(start+3,6) == 'CDATA['){\r\n\t\t\tvar end = source.indexOf(']]>',start+9);\r\n\t\t\tdomBuilder.startCDATA();\r\n\t\t\tdomBuilder.characters(source,start+9,end-start-9);\r\n\t\t\tdomBuilder.endCDATA() \r\n\t\t\treturn end+3;\r\n\t\t}\r\n\t\t//<!DOCTYPE\r\n\t\t//startDTD(java.lang.String name, java.lang.String publicId, java.lang.String systemId) \r\n\t\tvar matchs = split(source,start);\r\n\t\tvar len = matchs.length;\r\n\t\tif(len>1 && /!doctype/i.test(matchs[0][0])){\r\n\t\t\tvar name = matchs[1][0];\r\n\t\t\tvar pubid = len>3 && /^public$/i.test(matchs[2][0]) && matchs[3][0]\r\n\t\t\tvar sysid = len>4 && matchs[4][0];\r\n\t\t\tvar lastMatch = matchs[len-1]\r\n\t\t\tdomBuilder.startDTD(name,pubid && pubid.replace(/^(['\"])(.*?)\\1$/,'$2'),\r\n\t\t\t\t\tsysid && sysid.replace(/^(['\"])(.*?)\\1$/,'$2'));\r\n\t\t\tdomBuilder.endDTD();\r\n\t\t\t\r\n\t\t\treturn lastMatch.index+lastMatch[0].length\r\n\t\t}\r\n\t}\r\n\treturn -1;\r\n}\r\n\r\n\r\n\r\nfunction parseInstruction(source,start,domBuilder){\r\n\tvar end = source.indexOf('?>',start);\r\n\tif(end){\r\n\t\tvar match = source.substring(start,end).match(/^<\\?(\\S*)\\s*([\\s\\S]*?)\\s*$/);\r\n\t\tif(match){\r\n\t\t\tvar len = match[0].length;\r\n\t\t\tdomBuilder.processingInstruction(match[1], match[2]) ;\r\n\t\t\treturn end+2;\r\n\t\t}else{//error\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t}\r\n\treturn -1;\r\n}\r\n\r\n/**\r\n * @param source\r\n */\r\nfunction ElementAttributes(source){\r\n\t\r\n}\r\nElementAttributes.prototype = {\r\n\tsetTagName:function(tagName){\r\n\t\tif(!tagNamePattern.test(tagName)){\r\n\t\t\tthrow new Error('invalid tagName:'+tagName)\r\n\t\t}\r\n\t\tthis.tagName = tagName\r\n\t},\r\n\tadd:function(qName,value,offset){\r\n\t\tif(!tagNamePattern.test(qName)){\r\n\t\t\tthrow new Error('invalid attribute:'+qName)\r\n\t\t}\r\n\t\tthis[this.length++] = {qName:qName,value:value,offset:offset}\r\n\t},\r\n\tlength:0,\r\n\tgetLocalName:function(i){return this[i].localName},\r\n\tgetLocator:function(i){return this[i].locator},\r\n\tgetQName:function(i){return this[i].qName},\r\n\tgetURI:function(i){return this[i].uri},\r\n\tgetValue:function(i){return this[i].value}\r\n//\t,getIndex:function(uri, localName)){\r\n//\t\tif(localName){\r\n//\t\t\t\r\n//\t\t}else{\r\n//\t\t\tvar qName = uri\r\n//\t\t}\r\n//\t},\r\n//\tgetValue:function(){return this.getValue(this.getIndex.apply(this,arguments))},\r\n//\tgetType:function(uri,localName){}\r\n//\tgetType:function(i){},\r\n}\r\n\r\n\r\n\r\n\r\nfunction _set_proto_(thiz,parent){\r\n\tthiz.__proto__ = parent;\r\n\treturn thiz;\r\n}\r\nif(!(_set_proto_({},_set_proto_.prototype) instanceof _set_proto_)){\r\n\t_set_proto_ = function(thiz,parent){\r\n\t\tfunction p(){};\r\n\t\tp.prototype = parent;\r\n\t\tp = new p();\r\n\t\tfor(parent in thiz){\r\n\t\t\tp[parent] = thiz[parent];\r\n\t\t}\r\n\t\treturn p;\r\n\t}\r\n}\r\n\r\nfunction split(source,start){\r\n\tvar match;\r\n\tvar buf = [];\r\n\tvar reg = /'[^']+'|\"[^\"]+\"|[^\\s<>\\/=]+=?|(\\/?\\s*>|<)/g;\r\n\treg.lastIndex = start;\r\n\treg.exec(source);//skip <\r\n\twhile(match = reg.exec(source)){\r\n\t\tbuf.push(match);\r\n\t\tif(match[1])return buf;\r\n\t}\r\n}\r\n\r\nexports.XMLReader = XMLReader;\r\n\r\n","/*\r\n CryptoJS v3.1.2\r\n code.google.com/p/crypto-js\r\n (c) 2009-2013 by Jeff Mott. All rights reserved.\r\n code.google.com/p/crypto-js/wiki/License\r\n */\r\nvar CryptoJS=CryptoJS||function(g,l){var e={},d=e.lib={},m=function(){},k=d.Base={extend:function(a){m.prototype=this;var c=new m;a&&c.mixIn(a);c.hasOwnProperty(\"init\")||(c.init=function(){c.$super.init.apply(this,arguments)});c.init.prototype=c;c.$super=this;return c},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);a.hasOwnProperty(\"toString\")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},\r\n        p=d.WordArray=k.extend({init:function(a,c){a=this.words=a||[];this.sigBytes=c!=l?c:4*a.length},toString:function(a){return(a||n).stringify(this)},concat:function(a){var c=this.words,q=a.words,f=this.sigBytes;a=a.sigBytes;this.clamp();if(f%4)for(var b=0;b<a;b++)c[f+b>>>2]|=(q[b>>>2]>>>24-8*(b%4)&255)<<24-8*((f+b)%4);else if(65535<q.length)for(b=0;b<a;b+=4)c[f+b>>>2]=q[b>>>2];else c.push.apply(c,q);this.sigBytes+=a;return this},clamp:function(){var a=this.words,c=this.sigBytes;a[c>>>2]&=4294967295<<\r\n            32-8*(c%4);a.length=g.ceil(c/4)},clone:function(){var a=k.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var c=[],b=0;b<a;b+=4)c.push(4294967296*g.random()|0);return new p.init(c,a)}}),b=e.enc={},n=b.Hex={stringify:function(a){var c=a.words;a=a.sigBytes;for(var b=[],f=0;f<a;f++){var d=c[f>>>2]>>>24-8*(f%4)&255;b.push((d>>>4).toString(16));b.push((d&15).toString(16))}return b.join(\"\")},parse:function(a){for(var c=a.length,b=[],f=0;f<c;f+=2)b[f>>>3]|=parseInt(a.substr(f,\r\n                2),16)<<24-4*(f%8);return new p.init(b,c/2)}},j=b.Latin1={stringify:function(a){var c=a.words;a=a.sigBytes;for(var b=[],f=0;f<a;f++)b.push(String.fromCharCode(c[f>>>2]>>>24-8*(f%4)&255));return b.join(\"\")},parse:function(a){for(var c=a.length,b=[],f=0;f<c;f++)b[f>>>2]|=(a.charCodeAt(f)&255)<<24-8*(f%4);return new p.init(b,c)}},h=b.Utf8={stringify:function(a){try{return decodeURIComponent(escape(j.stringify(a)))}catch(c){throw Error(\"Malformed UTF-8 data\");}},parse:function(a){return j.parse(unescape(encodeURIComponent(a)))}},\r\n        r=d.BufferedBlockAlgorithm=k.extend({reset:function(){this._data=new p.init;this._nDataBytes=0},_append:function(a){\"string\"==typeof a&&(a=h.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var c=this._data,b=c.words,f=c.sigBytes,d=this.blockSize,e=f/(4*d),e=a?g.ceil(e):g.max((e|0)-this._minBufferSize,0);a=e*d;f=g.min(4*a,f);if(a){for(var k=0;k<a;k+=d)this._doProcessBlock(b,k);k=b.splice(0,a);c.sigBytes-=f}return new p.init(k,f)},clone:function(){var a=k.clone.call(this);\r\n            a._data=this._data.clone();return a},_minBufferSize:0});d.Hasher=r.extend({cfg:k.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){r.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,d){return(new a.init(d)).finalize(b)}},_createHmacHelper:function(a){return function(b,d){return(new s.HMAC.init(a,\r\n        d)).finalize(b)}}});var s=e.algo={};return e}(Math);\r\n(function(){var g=CryptoJS,l=g.lib,e=l.WordArray,d=l.Hasher,m=[],l=g.algo.SHA1=d.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(d,e){for(var b=this._hash.words,n=b[0],j=b[1],h=b[2],g=b[3],l=b[4],a=0;80>a;a++){if(16>a)m[a]=d[e+a]|0;else{var c=m[a-3]^m[a-8]^m[a-14]^m[a-16];m[a]=c<<1|c>>>31}c=(n<<5|n>>>27)+l+m[a];c=20>a?c+((j&h|~j&g)+1518500249):40>a?c+((j^h^g)+1859775393):60>a?c+((j&h|j&g|h&g)-1894007588):c+((j^h^\r\ng)-899497514);l=g;g=h;h=j<<30|j>>>2;j=n;n=c}b[0]=b[0]+n|0;b[1]=b[1]+j|0;b[2]=b[2]+h|0;b[3]=b[3]+g|0;b[4]=b[4]+l|0},_doFinalize:function(){var d=this._data,e=d.words,b=8*this._nDataBytes,g=8*d.sigBytes;e[g>>>5]|=128<<24-g%32;e[(g+64>>>9<<4)+14]=Math.floor(b/4294967296);e[(g+64>>>9<<4)+15]=b;d.sigBytes=4*e.length;this._process();return this._hash},clone:function(){var e=d.clone.call(this);e._hash=this._hash.clone();return e}});g.SHA1=d._createHelper(l);g.HmacSHA1=d._createHmacHelper(l)})();\r\n(function(){var g=CryptoJS,l=g.enc.Utf8;g.algo.HMAC=g.lib.Base.extend({init:function(e,d){e=this._hasher=new e.init;\"string\"==typeof d&&(d=l.parse(d));var g=e.blockSize,k=4*g;d.sigBytes>k&&(d=e.finalize(d));d.clamp();for(var p=this._oKey=d.clone(),b=this._iKey=d.clone(),n=p.words,j=b.words,h=0;h<g;h++)n[h]^=1549556828,j[h]^=909522486;p.sigBytes=b.sigBytes=k;this.reset()},reset:function(){var e=this._hasher;e.reset();e.update(this._iKey)},update:function(e){this._hasher.update(e);return this},finalize:function(e){var d=\r\n    this._hasher;e=d.finalize(e);d.reset();return d.finalize(this._oKey.clone().concat(e))}})})();\r\n\r\n\r\n(function () {\r\n    // Shortcuts\r\n    var C = CryptoJS;\r\n    var C_lib = C.lib;\r\n    var WordArray = C_lib.WordArray;\r\n    var C_enc = C.enc;\r\n\r\n    /**\r\n     * Base64 encoding strategy.\r\n     */\r\n    var Base64 = C_enc.Base64 = {\r\n        /**\r\n         * Converts a word array to a Base64 string.\r\n         *\r\n         * @param {WordArray} wordArray The word array.\r\n         *\r\n         * @return {string} The Base64 string.\r\n         *\r\n         * @static\r\n         *\r\n         * @example\r\n         *\r\n         *     var base64String = CryptoJS.enc.Base64.stringify(wordArray);\r\n         */\r\n        stringify: function (wordArray) {\r\n            // Shortcuts\r\n            var words = wordArray.words;\r\n            var sigBytes = wordArray.sigBytes;\r\n            var map = this._map;\r\n\r\n            // Clamp excess bits\r\n            wordArray.clamp();\r\n\r\n            // Convert\r\n            var base64Chars = [];\r\n            for (var i = 0; i < sigBytes; i += 3) {\r\n                var byte1 = (words[i >>> 2]       >>> (24 - (i % 4) * 8))       & 0xff;\r\n                var byte2 = (words[(i + 1) >>> 2] >>> (24 - ((i + 1) % 4) * 8)) & 0xff;\r\n                var byte3 = (words[(i + 2) >>> 2] >>> (24 - ((i + 2) % 4) * 8)) & 0xff;\r\n\r\n                var triplet = (byte1 << 16) | (byte2 << 8) | byte3;\r\n\r\n                for (var j = 0; (j < 4) && (i + j * 0.75 < sigBytes); j++) {\r\n                    base64Chars.push(map.charAt((triplet >>> (6 * (3 - j))) & 0x3f));\r\n                }\r\n            }\r\n\r\n            // Add padding\r\n            var paddingChar = map.charAt(64);\r\n            if (paddingChar) {\r\n                while (base64Chars.length % 4) {\r\n                    base64Chars.push(paddingChar);\r\n                }\r\n            }\r\n\r\n            return base64Chars.join('');\r\n        },\r\n\r\n        /**\r\n         * Converts a Base64 string to a word array.\r\n         *\r\n         * @param {string} base64Str The Base64 string.\r\n         *\r\n         * @return {WordArray} The word array.\r\n         *\r\n         * @static\r\n         *\r\n         * @example\r\n         *\r\n         *     var wordArray = CryptoJS.enc.Base64.parse(base64String);\r\n         */\r\n        parse: function (base64Str) {\r\n            // Shortcuts\r\n            var base64StrLength = base64Str.length;\r\n            var map = this._map;\r\n\r\n            // Ignore padding\r\n            var paddingChar = map.charAt(64);\r\n            if (paddingChar) {\r\n                var paddingIndex = base64Str.indexOf(paddingChar);\r\n                if (paddingIndex != -1) {\r\n                    base64StrLength = paddingIndex;\r\n                }\r\n            }\r\n\r\n            // Convert\r\n            var words = [];\r\n            var nBytes = 0;\r\n            for (var i = 0; i < base64StrLength; i++) {\r\n                if (i % 4) {\r\n                    var bits1 = map.indexOf(base64Str.charAt(i - 1)) << ((i % 4) * 2);\r\n                    var bits2 = map.indexOf(base64Str.charAt(i)) >>> (6 - (i % 4) * 2);\r\n                    words[nBytes >>> 2] |= (bits1 | bits2) << (24 - (nBytes % 4) * 8);\r\n                    nBytes++;\r\n                }\r\n            }\r\n\r\n            return WordArray.create(words, nBytes);\r\n        },\r\n\r\n        _map: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='\r\n    };\r\n}());\r\n\r\nif(typeof module === 'object'){\r\n    module.exports = CryptoJS;\r\n}else{\r\n    window.CryptoJS = CryptoJS;\r\n}\r\n","// .dirname, .basename, and .extname methods are extracted from Node.js v8.11.1,\n// backported and transplited with Babel, with backwards-compat fixes\n\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// resolves . and .. elements in a path array with directory names there\n// must be no slashes, empty elements, or device names (c:\\) in the array\n// (so also no leading and trailing slashes - it does not distinguish\n// relative and absolute paths)\nfunction normalizeArray(parts, allowAboveRoot) {\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = parts.length - 1; i >= 0; i--) {\n    var last = parts[i];\n    if (last === '.') {\n      parts.splice(i, 1);\n    } else if (last === '..') {\n      parts.splice(i, 1);\n      up++;\n    } else if (up) {\n      parts.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (allowAboveRoot) {\n    for (; up--; up) {\n      parts.unshift('..');\n    }\n  }\n\n  return parts;\n}\n\n// path.resolve([from ...], to)\n// posix version\nexports.resolve = function() {\n  var resolvedPath = '',\n      resolvedAbsolute = false;\n\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    var path = (i >= 0) ? arguments[i] : process.cwd();\n\n    // Skip empty and invalid entries\n    if (typeof path !== 'string') {\n      throw new TypeError('Arguments to path.resolve must be strings');\n    } else if (!path) {\n      continue;\n    }\n\n    resolvedPath = path + '/' + resolvedPath;\n    resolvedAbsolute = path.charAt(0) === '/';\n  }\n\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n\n  // Normalize the path\n  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {\n    return !!p;\n  }), !resolvedAbsolute).join('/');\n\n  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';\n};\n\n// path.normalize(path)\n// posix version\nexports.normalize = function(path) {\n  var isAbsolute = exports.isAbsolute(path),\n      trailingSlash = substr(path, -1) === '/';\n\n  // Normalize the path\n  path = normalizeArray(filter(path.split('/'), function(p) {\n    return !!p;\n  }), !isAbsolute).join('/');\n\n  if (!path && !isAbsolute) {\n    path = '.';\n  }\n  if (path && trailingSlash) {\n    path += '/';\n  }\n\n  return (isAbsolute ? '/' : '') + path;\n};\n\n// posix version\nexports.isAbsolute = function(path) {\n  return path.charAt(0) === '/';\n};\n\n// posix version\nexports.join = function() {\n  var paths = Array.prototype.slice.call(arguments, 0);\n  return exports.normalize(filter(paths, function(p, index) {\n    if (typeof p !== 'string') {\n      throw new TypeError('Arguments to path.join must be strings');\n    }\n    return p;\n  }).join('/'));\n};\n\n\n// path.relative(from, to)\n// posix version\nexports.relative = function(from, to) {\n  from = exports.resolve(from).substr(1);\n  to = exports.resolve(to).substr(1);\n\n  function trim(arr) {\n    var start = 0;\n    for (; start < arr.length; start++) {\n      if (arr[start] !== '') break;\n    }\n\n    var end = arr.length - 1;\n    for (; end >= 0; end--) {\n      if (arr[end] !== '') break;\n    }\n\n    if (start > end) return [];\n    return arr.slice(start, end - start + 1);\n  }\n\n  var fromParts = trim(from.split('/'));\n  var toParts = trim(to.split('/'));\n\n  var length = Math.min(fromParts.length, toParts.length);\n  var samePartsLength = length;\n  for (var i = 0; i < length; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      samePartsLength = i;\n      break;\n    }\n  }\n\n  var outputParts = [];\n  for (var i = samePartsLength; i < fromParts.length; i++) {\n    outputParts.push('..');\n  }\n\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\n\n  return outputParts.join('/');\n};\n\nexports.sep = '/';\nexports.delimiter = ':';\n\nexports.dirname = function (path) {\n  if (typeof path !== 'string') path = path + '';\n  if (path.length === 0) return '.';\n  var code = path.charCodeAt(0);\n  var hasRoot = code === 47 /*/*/;\n  var end = -1;\n  var matchedSlash = true;\n  for (var i = path.length - 1; i >= 1; --i) {\n    code = path.charCodeAt(i);\n    if (code === 47 /*/*/) {\n        if (!matchedSlash) {\n          end = i;\n          break;\n        }\n      } else {\n      // We saw the first non-path separator\n      matchedSlash = false;\n    }\n  }\n\n  if (end === -1) return hasRoot ? '/' : '.';\n  if (hasRoot && end === 1) {\n    // return '//';\n    // Backwards-compat fix:\n    return '/';\n  }\n  return path.slice(0, end);\n};\n\nfunction basename(path) {\n  if (typeof path !== 'string') path = path + '';\n\n  var start = 0;\n  var end = -1;\n  var matchedSlash = true;\n  var i;\n\n  for (i = path.length - 1; i >= 0; --i) {\n    if (path.charCodeAt(i) === 47 /*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          start = i + 1;\n          break;\n        }\n      } else if (end === -1) {\n      // We saw the first non-path separator, mark this as the end of our\n      // path component\n      matchedSlash = false;\n      end = i + 1;\n    }\n  }\n\n  if (end === -1) return '';\n  return path.slice(start, end);\n}\n\n// Uses a mixed approach for backwards-compatibility, as ext behavior changed\n// in new Node.js versions, so only basename() above is backported here\nexports.basename = function (path, ext) {\n  var f = basename(path);\n  if (ext && f.substr(-1 * ext.length) === ext) {\n    f = f.substr(0, f.length - ext.length);\n  }\n  return f;\n};\n\nexports.extname = function (path) {\n  if (typeof path !== 'string') path = path + '';\n  var startDot = -1;\n  var startPart = 0;\n  var end = -1;\n  var matchedSlash = true;\n  // Track the state of characters (if any) we see before our first dot and\n  // after any path separator we find\n  var preDotState = 0;\n  for (var i = path.length - 1; i >= 0; --i) {\n    var code = path.charCodeAt(i);\n    if (code === 47 /*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n    if (end === -1) {\n      // We saw the first non-path separator, mark this as the end of our\n      // extension\n      matchedSlash = false;\n      end = i + 1;\n    }\n    if (code === 46 /*.*/) {\n        // If this is our first dot, mark it as the start of our extension\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n    } else if (startDot !== -1) {\n      // We saw a non-dot and non-path separator before our dot, so we should\n      // have a good chance at having a non-empty extension\n      preDotState = -1;\n    }\n  }\n\n  if (startDot === -1 || end === -1 ||\n      // We saw a non-dot character immediately before the dot\n      preDotState === 0 ||\n      // The (right-most) trimmed path component is exactly '..'\n      preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {\n    return '';\n  }\n  return path.slice(startDot, end);\n};\n\nfunction filter (xs, f) {\n    if (xs.filter) return xs.filter(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        if (f(xs[i], i, xs)) res.push(xs[i]);\n    }\n    return res;\n}\n\n// String.prototype.substr - negative index don't work in IE8\nvar substr = 'ab'.substr(-1) === 'b'\n    ? function (str, start, len) { return str.substr(start, len) }\n    : function (str, start, len) {\n        if (start < 0) start = str.length + start;\n        return str.substr(start, len);\n    }\n;\n","var session = require('./session');\r\nvar util = require('./util');\r\n\r\nvar originApiMap = {};\r\nvar transferToTaskMethod = function (apiMap, apiName) {\r\n    originApiMap[apiName] = apiMap[apiName];\r\n    apiMap[apiName] = function (params, callback) {\r\n        if (params.SkipTask) {\r\n            originApiMap[apiName].call(this, params, callback);\r\n        } else {\r\n            this._addTask(apiName, params, callback);\r\n        }\r\n    };\r\n};\r\n\r\nvar initTask = function (cos) {\r\n\r\n    var queue = [];\r\n    var tasks = {};\r\n    var uploadingFileCount = 0;\r\n    var nextUploadIndex = 0;\r\n\r\n    // \r\n    var formatTask = function (task) {\r\n        var t = {\r\n            id: task.id,\r\n            Bucket: task.Bucket,\r\n            Region: task.Region,\r\n            Key: task.Key,\r\n            FilePath: task.FilePath,\r\n            state: task.state,\r\n            loaded: task.loaded,\r\n            size: task.size,\r\n            speed: task.speed,\r\n            percent: task.percent,\r\n            hashPercent: task.hashPercent,\r\n            error: task.error,\r\n        };\r\n        if (task.FilePath) t.FilePath = task.FilePath;\r\n        if (task._custom) t._custom = task._custom; // \r\n        return t;\r\n    };\r\n\r\n    var emitListUpdate = (function () {\r\n        var timer;\r\n        var emit = function () {\r\n            timer = 0;\r\n            cos.emit('task-list-update', {list: util.map(queue, formatTask)});\r\n            cos.emit('list-update', {list: util.map(queue, formatTask)});\r\n        };\r\n        return function () {\r\n            if (!timer) timer = setTimeout(emit);\r\n        }\r\n    })();\r\n\r\n    var clearQueue = function () {\r\n        if (queue.length <= cos.options.UploadQueueSize) return;\r\n        for (var i = 0;\r\n             i < nextUploadIndex && //  index \r\n             i < queue.length && // \r\n             queue.length > cos.options.UploadQueueSize // \r\n            ;) {\r\n            var isActive = queue[i].state === 'waiting' || queue[i].state === 'checking' || queue[i].state === 'uploading';\r\n            if (!queue[i] || !isActive) {\r\n                tasks[queue[i].id] && (delete tasks[queue[i].id]);\r\n                queue.splice(i, 1);\r\n                nextUploadIndex--;\r\n            } else {\r\n                i++;\r\n            }\r\n        }\r\n        emitListUpdate();\r\n    };\r\n\r\n    var startNextTask = function () {\r\n        // \r\n        if (uploadingFileCount >= cos.options.FileParallelLimit) return;\r\n        // \r\n        while (queue[nextUploadIndex] && queue[nextUploadIndex].state !== 'waiting') nextUploadIndex++;\r\n        // \r\n        if (nextUploadIndex >= queue.length) return;\r\n        // \r\n        var task = queue[nextUploadIndex];\r\n        nextUploadIndex++;\r\n        uploadingFileCount++;\r\n        task.state = 'checking';\r\n        task.params.onTaskStart && task.params.onTaskStart(formatTask(task));\r\n        !task.params.UploadData && (task.params.UploadData = {});\r\n        var apiParams = util.formatParams(task.api, task.params);\r\n        originApiMap[task.api].call(cos, apiParams, function (err, data) {\r\n            if (!cos._isRunningTask(task.id)) return;\r\n            if (task.state === 'checking' || task.state === 'uploading') {\r\n                task.state = err ? 'error' : 'success';\r\n                err && (task.error = err);\r\n                uploadingFileCount--;\r\n                emitListUpdate();\r\n                startNextTask();\r\n                task.callback && task.callback(err, data);\r\n                if (task.state === 'success') {\r\n                    if (task.params) {\r\n                        delete task.params.UploadData;\r\n                        delete task.params.Body;\r\n                        delete task.params;\r\n                    }\r\n                    delete task.callback;\r\n                }\r\n            }\r\n            clearQueue();\r\n        });\r\n        emitListUpdate();\r\n        // \r\n        setTimeout(startNextTask);\r\n    };\r\n\r\n    var killTask = function (id, switchToState) {\r\n        var task = tasks[id];\r\n        if (!task) return;\r\n        var waiting = task && task.state === 'waiting';\r\n        var running = task && (task.state === 'checking' || task.state === 'uploading');\r\n        if (switchToState === 'canceled' && task.state !== 'canceled' ||\r\n            switchToState === 'paused' && waiting ||\r\n            switchToState === 'paused' && running) {\r\n            if (switchToState === 'paused' && task.params.Body && typeof task.params.Body.pipe === 'function') {\r\n                console.error('stream not support pause');\r\n                return;\r\n            }\r\n            task.state = switchToState;\r\n            cos.emit('inner-kill-task', {TaskId: id, toState: switchToState});\r\n            try {\r\n                var UploadId = task && task.params && task.params.UploadData.UploadId\r\n            } catch(e) {}\r\n            if (switchToState === 'canceled' && UploadId) session.removeUsing(UploadId)\r\n            emitListUpdate();\r\n            if (running) {\r\n                uploadingFileCount--;\r\n                startNextTask();\r\n            }\r\n            if (switchToState === 'canceled') {\r\n                if (task.params) {\r\n                    delete task.params.UploadData;\r\n                    delete task.params.Body;\r\n                    delete task.params;\r\n                }\r\n                delete task.callback;\r\n            }\r\n        }\r\n        clearQueue();\r\n    };\r\n\r\n    cos._addTasks = function (taskList) {\r\n        util.each(taskList, function (task) {\r\n            cos._addTask(task.api, task.params, task.callback, true);\r\n        });\r\n        emitListUpdate();\r\n    };\r\n\r\n    var isTaskReadyWarning = true;\r\n    cos._addTask = function (api, params, callback, ignoreAddEvent) {\r\n\r\n        // \r\n        params = util.formatParams(api, params);\r\n\r\n        //  id\r\n        var id = util.uuid();\r\n        params.TaskId = id;\r\n        params.onTaskReady && params.onTaskReady(id);\r\n        if (params.TaskReady) {\r\n            params.TaskReady(id);\r\n            isTaskReadyWarning && console.warn('warning: Param \"TaskReady\" has been deprecated. Please use \"onTaskReady\" instead.');\r\n            isTaskReadyWarning = false;\r\n        }\r\n\r\n        var task = {\r\n            // env\r\n            params: params,\r\n            callback: callback,\r\n            api: api,\r\n            index: queue.length,\r\n            // task\r\n            id: id,\r\n            Bucket: params.Bucket,\r\n            Region: params.Region,\r\n            Key: params.Key,\r\n            FilePath: params.FilePath || '',\r\n            state: 'waiting',\r\n            loaded: 0,\r\n            size: 0,\r\n            speed: 0,\r\n            percent: 0,\r\n            hashPercent: 0,\r\n            error: null,\r\n            _custom: params._custom,\r\n        };\r\n        var onHashProgress = params.onHashProgress;\r\n        params.onHashProgress = function (info) {\r\n            if (!cos._isRunningTask(task.id)) return;\r\n            task.hashPercent = info.percent;\r\n            onHashProgress && onHashProgress(info);\r\n            emitListUpdate();\r\n        };\r\n        var onProgress = params.onProgress;\r\n        params.onProgress = function (info) {\r\n            if (!cos._isRunningTask(task.id)) return;\r\n            task.state === 'checking' && (task.state = 'uploading');\r\n            task.loaded = info.loaded;\r\n            task.speed = info.speed;\r\n            task.percent = info.percent;\r\n            onProgress && onProgress(info);\r\n            emitListUpdate();\r\n        };\r\n\r\n        //  filesize\r\n        util.getFileSize(api, params, function (err, size) {\r\n            // \r\n            if (err) { // \r\n                callback(err);\r\n                return;\r\n            }\r\n            // \r\n            tasks[id] = task;\r\n            queue.push(task);\r\n            task.size = size;\r\n            !ignoreAddEvent && emitListUpdate();\r\n            startNextTask();\r\n            clearQueue();\r\n        });\r\n        return id;\r\n    };\r\n    cos._isRunningTask = function (id) {\r\n        var task = tasks[id];\r\n        return !!(task && (task.state === 'checking' || task.state === 'uploading'));\r\n    };\r\n    cos.getTaskList = function () {\r\n        return util.map(queue, formatTask);\r\n    };\r\n    cos.cancelTask = function (id) {\r\n        killTask(id, 'canceled');\r\n    };\r\n    cos.pauseTask = function (id) {\r\n        killTask(id, 'paused');\r\n    };\r\n    cos.restartTask = function (id) {\r\n        var task = tasks[id];\r\n        if (task && (task.state === 'paused' || task.state === 'error')) {\r\n            task.state = 'waiting';\r\n            emitListUpdate();\r\n            nextUploadIndex = Math.min(nextUploadIndex, task.index);\r\n            startNextTask();\r\n        }\r\n    };\r\n    cos.isUploadRunning = function () {\r\n        return uploadingFileCount || nextUploadIndex < queue.length;\r\n    };\r\n\r\n};\r\n\r\nmodule.exports.transferToTaskMethod = transferToTaskMethod;\r\nmodule.exports.init = initTask;\r\n"],"sourceRoot":""}